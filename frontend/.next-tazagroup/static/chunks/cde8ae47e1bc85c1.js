(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65659,e=>{"use strict";var t=e.i(44990),a=e.i(403055),s=e.i(123959),r=e.i(130775),l=e.i(606443),i=e.i(850384),n=e.i(116633),n=n,o=e.i(885205),c=e.i(696134),d=e.i(135369),u=e.i(702470);function m({totalTasks:e,onCreateTask:a,onSearch:s,searchQuery:r,onFilterChange:m}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Tasks"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage and organize your tasks efficiently"})]}),(0,t.jsxs)(o.Button,{onClick:a,size:"default",className:"gap-2",children:[(0,t.jsx)(l.Plus,{className:"h-4 w-4"}),"Create Task"]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(c.Input,{type:"search",placeholder:"Search tasks...",value:r,onChange:e=>s(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(d.DropdownMenu,{children:[(0,t.jsx)(d.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(o.Button,{variant:"outline",className:"gap-2",children:[(0,t.jsx)(n.default,{className:"h-4 w-4"}),"Filters"]})}),(0,t.jsxs)(d.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(d.DropdownMenuLabel,{children:"Filter by"}),(0,t.jsx)(d.DropdownMenuSeparator,{}),(0,t.jsx)(d.DropdownMenuItem,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsx)("span",{children:"Status"}),(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-2",children:"All"})]})}),(0,t.jsx)(d.DropdownMenuItem,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsx)("span",{children:"Priority"}),(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-2",children:"All"})]})}),(0,t.jsx)(d.DropdownMenuItem,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsx)("span",{children:"Category"}),(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-2",children:"All"})]})}),(0,t.jsx)(d.DropdownMenuSeparator,{}),(0,t.jsx)(d.DropdownMenuItem,{className:"text-destructive",children:"Clear all filters"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-muted rounded-md",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:e}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:1===e?"task":"tasks"})]})]})]})}var h=e.i(112641),x=e.i(477219),g=e.i(415588),p=e.i(198513),y=e.i(759727),f=e.i(837149),j=e.i(775680),k=e.i(541428);function v({stats:e}){let a=[{title:"Total Tasks",value:e.total,icon:f.Target,description:"All tasks",color:"text-blue-600",bgColor:"bg-blue-50"},{title:"Pending",value:e.pending,icon:x.Circle,description:"Not started yet",color:"text-gray-600",bgColor:"bg-gray-50"},{title:"In Progress",value:e.inProgress,icon:g.Clock,description:"Currently working on",color:"text-amber-600",bgColor:"bg-amber-50"},{title:"Completed",value:e.completed,icon:h.CheckCircle2,description:"Successfully done",color:"text-green-600",bgColor:"bg-green-50"},{title:"High Priority",value:e.highPriority,icon:p.AlertCircle,description:"Urgent tasks",color:"text-red-600",bgColor:"bg-red-50"},{title:"Completion Rate",value:e.total>0?`${Math.round(e.completed/e.total*100)}%`:"0%",icon:y.TrendingUp,description:"Overall progress",color:"text-purple-600",bgColor:"bg-purple-50"}];return(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:a.map((e,a)=>(0,t.jsxs)(j.Card,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[(0,t.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(j.CardTitle,{className:"text-sm font-medium",children:e.title}),(0,t.jsx)("div",{className:(0,k.cn)("p-2 rounded-lg",e.bgColor),children:(0,t.jsx)(e.icon,{className:(0,k.cn)("h-4 w-4",e.color)})})]}),(0,t.jsxs)(j.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.value}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.description})]})]},a))})}var N=e.i(173416),T=e.i(888540),w=e.i(183194),b=e.i(67087),C=e.i(343698);function D({filters:e,onFiltersChange:a,myTasksCount:s,sharedTasksCount:r,allTasksCount:l}){let i="all"!==e.status||"all"!==e.priority||"all"!==e.category;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)(o.Button,{variant:"all"===e.tab?"default":"outline",size:"sm",onClick:()=>a({...e,tab:"all"}),className:"gap-2",children:["All Tasks",(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-1",children:l})]}),(0,t.jsxs)(o.Button,{variant:"my"===e.tab?"default":"outline",size:"sm",onClick:()=>a({...e,tab:"my"}),className:"gap-2",children:["My Tasks",(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-1",children:s})]}),(0,t.jsxs)(o.Button,{variant:"shared"===e.tab?"default":"outline",size:"sm",onClick:()=>a({...e,tab:"shared"}),className:"gap-2",children:["Shared",(0,t.jsx)(u.Badge,{variant:"secondary",className:"ml-1",children:r})]})]}),(0,t.jsx)(b.Separator,{}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,t.jsx)(N.Filter,{className:"h-4 w-4"}),"Filters:"]}),(0,t.jsxs)(w.Select,{value:e.status||"all",onValueChange:t=>a({...e,status:t}),children:[(0,t.jsx)(w.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(w.SelectValue,{placeholder:"Status"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:"all",children:"All Status"}),(0,t.jsx)(w.SelectItem,{value:C.TaskStatus.PENDING,children:"Pending"}),(0,t.jsx)(w.SelectItem,{value:C.TaskStatus.IN_PROGRESS,children:"In Progress"}),(0,t.jsx)(w.SelectItem,{value:C.TaskStatus.COMPLETED,children:"Completed"}),(0,t.jsx)(w.SelectItem,{value:C.TaskStatus.CANCELLED,children:"Cancelled"})]})]}),(0,t.jsxs)(w.Select,{value:e.priority||"all",onValueChange:t=>a({...e,priority:t}),children:[(0,t.jsx)(w.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(w.SelectValue,{placeholder:"Priority"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:"all",children:"All Priority"}),(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.LOW,children:"Low"}),(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.MEDIUM,children:"Medium"}),(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.HIGH,children:"High"})]})]}),(0,t.jsxs)(w.Select,{value:e.category||"all",onValueChange:t=>a({...e,category:t}),children:[(0,t.jsx)(w.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(w.SelectValue,{placeholder:"Category"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:"all",children:"All Categories"}),(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.PERSONAL,children:"Personal"}),(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.WORK,children:"Work"}),(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.STUDY,children:"Study"})]})]}),i&&(0,t.jsxs)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{a({...e,status:"all",priority:"all",category:"all"})},className:"gap-2",children:[(0,t.jsx)(T.X,{className:"h-4 w-4"}),"Clear filters"]})]})]})}var S=e.i(495043),E=e.i(31968),M=e.i(138227),I=e.i(435635),A=e.i(731462),A=A,L=e.i(41714),P=e.i(982087);let R={[C.TaskPriority.HIGH]:{label:"High",className:"bg-red-100 text-red-800 border-red-200",icon:p.AlertCircle},[C.TaskPriority.MEDIUM]:{label:"Medium",className:"bg-amber-100 text-amber-800 border-amber-200",icon:g.Clock},[C.TaskPriority.LOW]:{label:"Low",className:"bg-blue-100 text-blue-800 border-blue-200",icon:x.Circle}},G={[C.TaskStatus.PENDING]:{label:"Pending",className:"bg-gray-100 text-gray-800",icon:x.Circle},[C.TaskStatus.IN_PROGRESS]:{label:"In Progress",className:"bg-blue-100 text-blue-800",icon:g.Clock},[C.TaskStatus.COMPLETED]:{label:"Completed",className:"bg-green-100 text-green-800",icon:h.CheckCircle2},[C.TaskStatus.CANCELLED]:{label:"Cancelled",className:"bg-red-100 text-red-800",icon:p.AlertCircle}},O={[C.TaskCategory.WORK]:{label:"Work",className:"bg-purple-100 text-purple-800"},[C.TaskCategory.PERSONAL]:{label:"Personal",className:"bg-green-100 text-green-800"},[C.TaskCategory.STUDY]:{label:"Study",className:"bg-indigo-100 text-indigo-800"}};function B({task:e,onEdit:a,onDelete:s,onStatusChange:r}){let l=G[e.status]?.icon||x.Circle,i=R[e.priority]?.icon||x.Circle,n=O[e.category&&e.category in C.TaskCategory?e.category:C.TaskCategory.PERSONAL],c=e.dueDate&&new Date(e.dueDate)<new Date&&e.status!==C.TaskStatus.COMPLETED;return(0,t.jsxs)(j.Card,{className:(0,k.cn)("group hover:shadow-lg transition-all duration-200",c&&"border-red-300"),children:[(0,t.jsx)(j.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg leading-none tracking-tight",children:e.title}),e.isShared&&(0,t.jsxs)(u.Badge,{variant:"outline",className:"gap-1",children:[(0,t.jsx)(A.default,{className:"h-3 w-3"}),"Shared"]})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description})]}),(0,t.jsxs)(d.DropdownMenu,{children:[(0,t.jsx)(d.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(o.Button,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(S.MoreVertical,{className:"h-4 w-4"})})}),(0,t.jsxs)(d.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(d.DropdownMenuItem,{onClick:()=>a?.(e),children:[(0,t.jsx)(E.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,t.jsx)(d.DropdownMenuSeparator,{}),(0,t.jsxs)(d.DropdownMenuItem,{onClick:()=>r?.(e.id,C.TaskStatus.PENDING),disabled:e.status===C.TaskStatus.PENDING,children:[(0,t.jsx)(x.Circle,{className:"mr-2 h-4 w-4"}),"Mark as Pending"]}),(0,t.jsxs)(d.DropdownMenuItem,{onClick:()=>r?.(e.id,C.TaskStatus.IN_PROGRESS),disabled:e.status===C.TaskStatus.IN_PROGRESS,children:[(0,t.jsx)(g.Clock,{className:"mr-2 h-4 w-4"}),"Mark as In Progress"]}),(0,t.jsxs)(d.DropdownMenuItem,{onClick:()=>r?.(e.id,C.TaskStatus.COMPLETED),disabled:e.status===C.TaskStatus.COMPLETED,children:[(0,t.jsx)(h.CheckCircle2,{className:"mr-2 h-4 w-4"}),"Mark as Completed"]}),(0,t.jsx)(d.DropdownMenuSeparator,{}),(0,t.jsxs)(d.DropdownMenuItem,{onClick:()=>s?.(e.id),className:"text-destructive",children:[(0,t.jsx)(M.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),(0,t.jsx)(j.CardContent,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)(u.Badge,{variant:"outline",className:(0,k.cn)("gap-1",G[e.status]?.className||"bg-gray-100 text-gray-800"),children:[(0,t.jsx)(l,{className:"h-3 w-3"}),G[e.status]?.label||"Unknown"]}),(0,t.jsxs)(u.Badge,{variant:"outline",className:(0,k.cn)("gap-1",R[e.priority]?.className||"bg-gray-100 text-gray-800"),children:[(0,t.jsx)(i,{className:"h-3 w-3"}),R[e.priority]?.label||"Unknown"]}),(0,t.jsx)(u.Badge,{variant:"outline",className:n.className,children:n.label})]})}),(0,t.jsxs)(j.CardFooter,{className:"flex items-center justify-between text-sm text-muted-foreground pt-3 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[e.dueDate&&(0,t.jsxs)("div",{className:(0,k.cn)("flex items-center gap-1",c&&"text-red-600 font-medium"),children:[(0,t.jsx)(I.Calendar,{className:"h-4 w-4"}),(0,P.format)(new Date(e.dueDate),"MMM dd, yyyy"),c&&(0,t.jsx)("span",{className:"text-xs",children:"(Overdue)"})]}),e.isShared&&e.sharedBy&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(L.Avatar,{className:"h-5 w-5",children:[(0,t.jsx)(L.AvatarImage,{src:e.sharedBy.avatar}),(0,t.jsx)(L.AvatarFallback,{className:"text-xs",children:e.sharedBy.username[0].toUpperCase()})]}),(0,t.jsx)("span",{className:"text-xs",children:e.sharedBy.username})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,t.jsx)(g.Clock,{className:"h-3 w-3"}),(0,P.format)(new Date(e.createdAt),"MMM dd")]})]})]})}var U=e.i(169989),$=e.i(615688),$=$;function _({tasks:e,loading:a,onEdit:s,onDelete:r,onStatusChange:l,emptyMessage:i="No tasks found"}){return a?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(U.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading tasks..."})]})}):0===e.length?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 text-center",children:[(0,t.jsx)($.default,{className:"h-12 w-12 text-muted-foreground/50"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-muted-foreground",children:i}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground/70",children:"Create a new task to get started"})]})]})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,t.jsx)(B,{task:e,onEdit:s,onDelete:r,onStatusChange:l},e.id))})}var Q=e.i(665691);let F=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}),K=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"}))}),H=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))});var V=e.i(199382);let z=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))}),W=a.forwardRef(function({title:e,titleId:t,...s},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},s),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))});var q=e.i(835819);let Z=["image/jpeg","image/png","image/gif","image/webp"],Y=["video/mp4","video/webm","video/ogg"],X=["application/pdf","text/plain","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],J=({onMediaAdd:e,onMediaRemove:s,existingMedia:r=[],maxFiles:l=10,maxFileSize:i=50,acceptedTypes:n=[...Z,...Y,...X],disabled:o=!1})=>{let[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),h=(0,a.useRef)(null),x=e=>Z.includes(e)?C.MediaType.IMAGE:Y.includes(e)?C.MediaType.VIDEO:C.MediaType.DOCUMENT,g=async e=>{if(e.type.startsWith("image/"))return new Promise(t=>{let a=new FileReader;a.onload=e=>t(e.target?.result),a.readAsDataURL(e)})},p=async t=>{let a=Array.from(t);if(r.length+a.length>l)return void q.toast.error(`Chá»‰ c\xf3 thá»ƒ upload tá»‘i Ä‘a ${l} file`);d(!0);let s=[];for(let e of a){if(!n.includes(e.type)){q.toast.error(`File ${e.name} kh\xf4ng Ä‘Æ°á»£c há»— trá»£`);continue}if(e.size>1024*i*1024){q.toast.error(`File ${e.name} qu\xe1 lá»›n (tá»‘i Ä‘a ${i}MB)`);continue}try{let t=await g(e),a={id:`temp-${Date.now()}-${Math.random()}`,file:e,url:URL.createObjectURL(e),type:x(e.type),size:e.size,mimeType:e.type,preview:t};s.push(a)}catch(t){q.toast.error(`Lá»—i xá»­ l\xfd file ${e.name}`)}}s.length>0&&(e(s),q.toast.success(`Ä\xe3 th\xeam ${s.length} file`)),d(!1)},y=(0,a.useCallback)(e=>{if(e.preventDefault(),m(!1),o)return;let t=e.dataTransfer.files;t.length>0&&p(t)},[o,p]),f=(0,a.useCallback)(e=>{e.preventDefault(),o||m(!0)},[o]),j=(0,a.useCallback)(e=>{e.preventDefault(),m(!1)},[]),k=(0,a.useCallback)(async e=>{if(o)return;let t=e.clipboardData.items,a=[];for(let e of Array.from(t))if("file"===e.kind){let t=e.getAsFile();t&&a.push(t)}a.length>0&&await p(a)},[o,p]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${u?"border-blue-500 bg-blue-50":o?"border-gray-200 bg-gray-50":"border-gray-300 hover:border-gray-400"}`,onDrop:y,onDragOver:f,onDragLeave:j,onPaste:k,tabIndex:0,children:[(0,t.jsx)("input",{ref:h,type:"file",multiple:!0,accept:n.join(","),onChange:e=>{let t=e.target.files;t&&t.length>0&&p(t),h.current&&(h.current.value="")},className:"hidden",disabled:o}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(W,{className:"h-12 w-12 text-gray-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-lg font-medium text-gray-900",children:["KÃ©o tháº£ file vÃ o Ä‘Ã¢y hoáº·c"," ",(0,t.jsx)("button",{type:"button",onClick:()=>h.current?.click(),disabled:o,className:"text-blue-600 hover:text-blue-500 font-medium disabled:text-gray-400",children:"chá»n file"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Há»— trá»£ hÃ¬nh áº£nh, video vÃ  tÃ i liá»‡u. Tá»‘i Ä‘a ",i,"MB má»—i file."]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Paste (Ctrl+V)"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(W,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Drag & Drop"})]})]})]}),c&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Äang xá»­ lÃ½..."})]})]}),r.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["File Ä‘Ã£ chá»n (",r.length,"/",l,")"]}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:r.map(e=>(0,t.jsxs)("div",{className:"relative bg-white border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:e.type===C.MediaType.IMAGE&&e.preview?(0,t.jsx)("img",{src:e.preview,alt:e.file.name,className:"h-12 w-12 object-cover rounded"}):(e=>{switch(e){case C.MediaType.IMAGE:return(0,t.jsx)(F,{className:"h-8 w-8 text-blue-500"});case C.MediaType.VIDEO:return(0,t.jsx)(K,{className:"h-8 w-8 text-purple-500"});case C.MediaType.DOCUMENT:default:return(0,t.jsx)(H,{className:"h-8 w-8 text-gray-500"})}})(e.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.file.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(e.size)}),(0,t.jsx)("p",{className:"text-xs text-gray-400 capitalize",children:e.type.toLowerCase()})]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>s(e.id),className:"absolute top-1 right-1 p-1 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors",children:(0,t.jsx)(V.XMarkIcon,{className:"h-4 w-4"})})]},e.id))})]})]})};var ee=e.i(950988),et=e.i(984804);et.gql`
  mutation CreateTaskComment($input: CreateTaskCommentInput!) {
    createTaskComment(input: $input) {
      id
      content
      taskId
      userId
      parentId
      user {
        id
        username
        firstName
        lastName
        avatar
      }
      createdAt
      updatedAt
    }
  }
`,et.gql`
  mutation UpdateTaskComment($id: String!, $input: UpdateTaskCommentInput!) {
    updateTaskComment(id: $id, input: $input) {
      id
      content
      taskId
      userId
      parentId
      user {
        id
        username
        firstName
        lastName
        avatar
      }
      createdAt
      updatedAt
    }
  }
`,et.gql`
  mutation DeleteTaskComment($id: String!) {
    deleteTaskComment(id: $id)
  }
`;let ea=et.gql`
  mutation UploadTaskMedia($input: UploadTaskMediaInput!) {
    uploadTaskMedia(input: $input) {
      id
      filename
      url
      type
      size
      mimeType
      caption
      taskId
      uploadedBy
      uploader {
        id
        username
        firstName
        lastName
        avatar
      }
      createdAt
      updatedAt
    }
  }
`;et.gql`
  mutation DeleteTaskMedia($mediaId: String!) {
    deleteTaskMedia(mediaId: $mediaId)
  }
`,et.gql`
  query ($id: String!) {
    getTask(id: $id) {
      id
      title
      description
      status
      priority
      dueDate
      category
      userId
      author {
        id
        username
        firstName
        lastName
        avatar
      }
      comments {
        id
        content
        taskId
        userId
        parentId
        user {
          id
          username
          firstName
          lastName
          avatar
        }
        replies {
          id
          content
          taskId
          userId
          parentId
          user {
            id
            username
            firstName
            lastName
            avatar
          }
          createdAt
          updatedAt
        }
        createdAt
        updatedAt
      }
      media {
        id
        filename
        url
        size
        mimeType
        taskId
        uploadedBy
        uploader {
          id
          username
          firstName
          lastName
          avatar
        }
        createdAt
      }
      shares {
        id
        taskId
        permission
        sharedBy
        sharedWith
        sharedByUser {
          id
          username
          firstName
          lastName
          avatar
        }
        sharedWithUser {
          id
          username
          firstName
          lastName
          avatar
        }
        createdAt
      }
      createdAt
      updatedAt
    }
  }
`;var es=e.i(137651),er=e.i(165429),el=e.i(600547);let ei=({isOpen:e,onClose:s,onTaskCreated:r})=>{let[l,i]=(0,a.useState)({title:"",description:"",category:C.TaskCategory.PERSONAL,priority:C.TaskPriority.MEDIUM,dueDate:""}),{createTask:n,loading:d}=(0,Q.useTaskMutations)(),{mediaFiles:u,uploading:m,uploadProgress:h,addMediaFiles:x,removeMediaFile:g,clearMediaFiles:p,uploadMedia:y}=((e={})=>{let{maxFiles:t=10,maxFileSize:s=50,onUploadProgress:r,onUploadComplete:l,onUploadError:i}=e,[n,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(0),[h]=(0,ee.useMutation)(ea),x=(0,a.useCallback)(e=>{o(a=>{let s=[...a,...e];return s.length>t?(q.toast.error(`Chá»‰ c\xf3 thá»ƒ upload tá»‘i Ä‘a ${t} file`),a.slice(0,t)):s})},[t]),g=(0,a.useCallback)(e=>{o(t=>{let a=t.find(t=>t.id===e);return a&&(URL.revokeObjectURL(a.url),a.preview&&URL.revokeObjectURL(a.preview)),t.filter(t=>t.id!==e)})},[]),p=(0,a.useCallback)(()=>{o(e=>(e.forEach(e=>{URL.revokeObjectURL(e.url),e.preview&&URL.revokeObjectURL(e.preview)}),[]))},[]),y=(0,a.useCallback)(async e=>{if(0===n.length)return[];d(!0),m(0);try{let t=[],a=n.length;for(let s=0;s<n.length;s++){let l=n[s];try{let i=(s+1)/a*100;m(i),r?.(i);let n=`temp://media/${Date.now()}-${l.file.name}`,o=await h({variables:{input:{taskId:e,filename:l.file.name,mimeType:l.mimeType,size:l.size,type:l.type,url:n}}});o.data?.uploadTaskMedia&&t.push(o.data.uploadTaskMedia)}catch(t){let e=`Lá»—i upload file ${l.file.name}: ${t}`;q.toast.error(e),i?.(e),console.error("Upload error:",t)}}return p(),l?.(t),t.length>0&&q.toast.success(`Ä\xe3 upload th\xe0nh c\xf4ng ${t.length} file`),t}catch(t){let e=`Lá»—i upload media: ${t}`;throw q.toast.error(e),i?.(e),t}finally{d(!1),m(0)}},[n,r,l,i,p]);return{mediaFiles:n,uploading:c,uploadProgress:u,addMediaFiles:x,removeMediaFile:g,clearMediaFiles:p,uploadMedia:y}})({maxFiles:5,maxFileSize:10}),f=()=>{i({title:"",description:"",category:C.TaskCategory.PERSONAL,priority:C.TaskPriority.MEDIUM,dueDate:""}),p()},j=async e=>{if(e.preventDefault(),!l.title.trim())return void q.toast.error("Vui lÃ²ng nháº­p tiÃªu Ä‘á» task");try{let e={title:l.title.trim(),description:l.description?.trim()||void 0,category:l.category,priority:l.priority,dueDate:l.dueDate||void 0},t=await n(e);if(u.length>0&&t?.id)try{await y(t.id),q.toast.success(`Táº¡o task th\xe0nh c\xf4ng vá»›i ${u.length} file Ä‘\xednh k\xe8m!`)}catch(e){q.toast.success("Táº¡o task thÃ nh cÃ´ng nhÆ°ng cÃ³ lá»—i khi upload file"),console.error("Media upload error:",e)}else q.toast.success("Táº¡o task thÃ nh cÃ´ng!");f(),s(),r?.()}catch(e){console.error("Create task error:",e),q.toast.error(e.message||"Lá»—i khi táº¡o task")}},k=(e,t)=>{i(a=>({...a,[e]:t}))};return(0,t.jsx)(es.Dialog,{open:e,onOpenChange:e=>{e||f(),s()},children:(0,t.jsxs)(es.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsx)(es.DialogHeader,{children:(0,t.jsx)(es.DialogTitle,{children:"Táº¡o Task Má»›i"})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,t.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{htmlFor:"title",children:"TiÃªu Ä‘á» *"}),(0,t.jsx)(c.Input,{id:"title",value:l.title,onChange:e=>k("title",e.target.value),placeholder:"Nháº­p tiÃªu Ä‘á» task...",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{htmlFor:"description",children:"MÃ´ táº£"}),(0,t.jsx)(el.Textarea,{id:"description",value:l.description,onChange:e=>k("description",e.target.value),placeholder:"Nháº­p mÃ´ táº£ chi tiáº¿t...",rows:3})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{htmlFor:"category",children:"Danh má»¥c"}),(0,t.jsxs)(w.Select,{value:l.category,onValueChange:e=>k("category",e),children:[(0,t.jsx)(w.SelectTrigger,{children:(0,t.jsx)(w.SelectValue,{placeholder:"Chá»n danh má»¥c"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.WORK,children:"CÃ´ng viá»‡c"}),(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.PERSONAL,children:"CÃ¡ nhÃ¢n"}),(0,t.jsx)(w.SelectItem,{value:C.TaskCategory.STUDY,children:"Há»c táº­p"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{htmlFor:"priority",children:"Äá»™ Æ°u tiÃªn"}),(0,t.jsxs)(w.Select,{value:l.priority,onValueChange:e=>k("priority",e),children:[(0,t.jsx)(w.SelectTrigger,{children:(0,t.jsx)(w.SelectValue,{placeholder:"Chá»n Ä‘á»™ Æ°u tiÃªn"})}),(0,t.jsxs)(w.SelectContent,{children:[(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.LOW,children:"Tháº¥p"}),(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.MEDIUM,children:"Trung bÃ¬nh"}),(0,t.jsx)(w.SelectItem,{value:C.TaskPriority.HIGH,children:"Cao"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{htmlFor:"dueDate",children:"Háº¡n chÃ³t"}),(0,t.jsx)(c.Input,{type:"datetime-local",id:"dueDate",value:l.dueDate,onChange:e=>k("dueDate",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(er.Label,{children:"File Ä‘Ã­nh kÃ¨m"}),(0,t.jsx)(J,{onMediaAdd:x,onMediaRemove:g,existingMedia:u,maxFiles:5,maxFileSize:10,disabled:d.creating||m}),m&&(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${h}%`}})}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Äang upload... ",Math.round(h),"%"]})]})]})]})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t bg-white",children:[(0,t.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>{f(),s()},disabled:d.creating,children:"Há»§y"}),(0,t.jsx)(o.Button,{type:"submit",onClick:j,disabled:d.creating||!l.title.trim(),children:d.creating?"Äang táº¡o...":"Táº¡o Task"})]})]})})};var en=e.i(125284);function eo(){let{isAuthenticated:e,loading:l,user:i}=(0,s.useAuth)(),n=(0,r.useRouter)(),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(""),[h,x]=(0,a.useState)({status:"all",priority:"all",category:"all",view:"all"}),{tasks:g,loading:p,createTask:y,updateTask:f,deleteTask:j,refetch:k}=function(){let[e,t]=(0,a.useState)(!1),s=(0,en.useCRUD)("Task"),{data:r,loading:l,error:i,refetch:n}=(0,en.useDynamicQuery)("GET_ALL","Task",{fetchPolicy:"cache-and-network",errorPolicy:"all"});(0,a.useEffect)(()=>{},[r]),(0,a.useEffect)(()=>{i&&console.error("âŒ Dynamic tasks error:",i)},[i]);let{data:o,loading:c,refetch:d}=(0,en.useDynamicQuery)("GET_PAGINATED","Task",{variables:{page:1,limit:10},fetchPolicy:"cache-and-network"}),[u,{loading:m}]=(0,en.useDynamicMutation)("CREATE","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED"],awaitRefetchQueries:!0,errorPolicy:"all"}),[h,{loading:x}]=(0,en.useDynamicMutation)("UPDATE","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED","GET_TASK_BY_ID"],awaitRefetchQueries:!0}),[g,{loading:p}]=(0,en.useDynamicMutation)("DELETE","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED"],awaitRefetchQueries:!0}),[y,{loading:f}]=(0,en.useDynamicMutation)("CREATE_BULK","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED"],awaitRefetchQueries:!0}),[j,{loading:k}]=(0,en.useDynamicMutation)("UPDATE_BULK","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED"],awaitRefetchQueries:!0}),[v,{loading:N}]=(0,en.useDynamicMutation)("DELETE_BULK","Task",{refetchQueries:["GET_TASKs","GET_TASKs_PAGINATED"],awaitRefetchQueries:!0}),T=(0,a.useCallback)(async(e,a={})=>{let{showToast:s=!0,onCreate:r,onError:l}=a;try{if(t(!0),!e.title?.trim())throw Error("TiÃªu Ä‘á» task khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng");let a={title:e.title.trim(),description:e.description?.trim()||void 0,category:e.category,priority:e.priority,dueDate:e.dueDate||void 0},l=(await u({variables:{data:a}})).data||null;if(!l)throw Error("KhÃ´ng thá»ƒ táº¡o task - response rá»—ng");s&&q.toast.success("âœ… Táº¡o task thÃ nh cÃ´ng!"),r?.(l);try{await n()}catch(e){console.warn("âš ï¸ Refetch warning:",e)}return l}catch(t){console.error("âŒ Error creating task:",t);let e=(0,en.isDynamicGraphQLError)(t)?(0,en.formatDynamicGraphQLError)(t):t.message||"Lá»—i khi táº¡o task";throw s&&q.toast.error(`âŒ ${e}`),l?.(t),t}finally{t(!1)}},[u,n]),w=(0,a.useCallback)(async(e,a={})=>{let{showToast:s=!0,showProgress:r=!0,onProgress:l,onCompleted:i,onError:o}=a;try{t(!0);let a=e.map((e,t)=>{if(!e.title?.trim())throw Error(`Task ${t+1}: Ti\xeau Ä‘á» kh\xf4ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng`);return{title:e.title.trim(),description:e.description?.trim()||void 0,category:e.category,priority:e.priority,dueDate:e.dueDate||void 0}});r&&q.toast.loading(`Äang táº¡o ${e.length} tasks...`,{id:"bulk-create"});let o=(await y({variables:{data:a}})).data;return r&&q.toast.dismiss("bulk-create"),s&&(o.errors&&o.errors.length>0?(q.toast.success(`âœ… Táº¡o th\xe0nh c\xf4ng ${o.count}/${e.length} tasks`),q.toast.error(`âŒ Lá»—i: ${o.errors.length} tasks`)):q.toast.success(`âœ… Táº¡o th\xe0nh c\xf4ng ${o.count} tasks!`)),l?.({completed:o.count,total:e.length}),i?.(o),await n(),o}catch(t){console.error("Error creating tasks bulk:",t),r&&q.toast.dismiss("bulk-create");let e=(0,en.isDynamicGraphQLError)(t)?(0,en.formatDynamicGraphQLError)(t):t.message||"Lá»—i khi táº¡o tasks";throw s&&q.toast.error(`âŒ ${e}`),o?.(t),t}finally{t(!1)}},[y,n]),b=(0,a.useCallback)(async(e,a,s={})=>{let{showToast:r=!0,onUpdate:l,onError:i}=s;try{t(!0);let s=Object.entries(a).reduce((e,[t,a])=>(null!=a&&("string"==typeof a?e[t]=a.trim()||void 0:e[t]=a),e),{}),i=(await h({variables:{id:e,data:s}})).data;if(!i)throw Error("KhÃ´ng thá»ƒ cáº­p nháº­t task");return r&&q.toast.success("âœ… Cáº­p nháº­t task thÃ nh cÃ´ng!"),l?.(i),await n(),i}catch(t){console.error("âŒ Error updating task:",t);let e=(0,en.isDynamicGraphQLError)(t)?(0,en.formatDynamicGraphQLError)(t):t.message||"Lá»—i khi cáº­p nháº­t task";throw r&&q.toast.error(`âŒ ${e}`),i?.(t),t}finally{t(!1)}},[h,n]),D=(0,a.useCallback)(async(e,a={})=>{let{showToast:s=!0,onDelete:r,onError:l}=a;try{t(!0);let a=(await g({variables:{id:e}})).data;return s&&a&&q.toast.success("âœ… XÃ³a task thÃ nh cÃ´ng!"),r?.(),await n(),a}catch(t){console.error("âŒ Error deleting task:",t);let e=(0,en.isDynamicGraphQLError)(t)?(0,en.formatDynamicGraphQLError)(t):t.message||"Lá»—i khi xÃ³a task";throw s&&q.toast.error(`âŒ ${e}`),l?.(t),t}finally{t(!1)}},[g,n]),S=(0,a.useMemo)(()=>{if(!Array.isArray(r))return{total:0,completed:0,pending:0,overdue:0};let e=r.filter(e=>e.status===C.TaskStatus.COMPLETED).length,t=r.filter(e=>e.status!==C.TaskStatus.COMPLETED).length,a=r.filter(e=>e.dueDate&&new Date(e.dueDate)<new Date&&e.status!==C.TaskStatus.COMPLETED).length;return{total:r.length,completed:e,pending:t,overdue:a}},[r]),E=(0,a.useMemo)(()=>({markAsCompleted:e=>b(e,{status:C.TaskStatus.COMPLETED}),markAsPending:e=>b(e,{status:C.TaskStatus.PENDING}),markAsInProgress:e=>b(e,{status:C.TaskStatus.IN_PROGRESS}),setPriority:(e,t)=>b(e,{priority:t}),setDueDate:(e,t)=>b(e,{dueDate:t.toISOString()})}),[b]);return{tasks:Array.isArray(r)?r:[],tasksPaginated:o,statistics:S,loading:l||c||e,creating:m,updating:x,deleting:p,bulkCreating:f,bulkUpdating:k,bulkDeleting:N,error:i,createTask:T,createTasksBulk:w,updateTask:b,deleteTask:D,refetch:n,refetchPaginated:d,quickActions:E,crud:s}}(),{tasks:N,loading:T,refetch:w}=(0,Q.useTasks)(),{sharedTasks:b,loading:S,refetch:E}=(0,Q.useSharedTasks)(),M=(0,a.useMemo)(()=>(g?.length>0?g:N||[]).map(e=>({...e,isShared:!1})),[g,N]),I=(0,a.useMemo)(()=>(b||[]).map(e=>({...e,isShared:!0,sharedBy:e.author,sharePermission:"VIEW"})),[b]),A=(0,a.useMemo)(()=>[...M,...I],[M,I]),L=(0,a.useMemo)(()=>{let e=A;switch(h.view){case"my":e=M;break;case"shared":e=I;break;default:e=A}if("all"!==h.status&&(e=e.filter(e=>e.status===h.status)),"all"!==h.priority&&(e=e.filter(e=>e.priority===h.priority)),"all"!==h.category&&(e=e.filter(e=>e.category===h.category)),d.trim()){let t=d.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}return e},[A,M,I,h,d]),P=(0,a.useMemo)(()=>{let e=L.length,t=L.filter(e=>e.status===C.TaskStatus.PENDING).length,a=L.filter(e=>e.status===C.TaskStatus.IN_PROGRESS).length,s=L.filter(e=>e.status===C.TaskStatus.COMPLETED).length,r=L.filter(e=>e.status===C.TaskStatus.CANCELLED).length,l=L.filter(e=>e.priority===C.TaskPriority.HIGH).length,i=new Date;return{total:e,pending:t,inProgress:a,completed:s,cancelled:r,highPriority:l,overdue:L.filter(e=>e.dueDate&&new Date(e.dueDate)<i&&e.status!==C.TaskStatus.COMPLETED).length}},[L]);(0,a.useEffect)(()=>{l||e||n.push("/login")},[e,l,n]);let R=(0,a.useCallback)(async()=>{await Promise.all([k(),w(),E()])},[k,w,E]),G=(0,a.useCallback)(async e=>{try{if(e&&e.title){let t={title:e.title,description:e.description||"",category:e.category||C.TaskCategory.PERSONAL,priority:e.priority||C.TaskPriority.MEDIUM,dueDate:e.dueDate};await y(t,{showToast:!0,onCreate:e=>{console.log("âœ… Task created via Dynamic GraphQL:",e),q.toast.success(`ðŸŽ‰ Created: "${e.title}"`)}})}else c(!0)}catch(e){console.error("âŒ Task creation error:",e),q.toast.error(`âŒ Error creating task: ${e instanceof Error?e.message:"Unknown error"}`)}},[y]),O=(0,a.useCallback)(async(e,t)=>{try{let a={};void 0!==t.title&&(a.title=t.title),void 0!==t.description&&(a.description=t.description),void 0!==t.status&&(a.status=t.status),void 0!==t.priority&&(a.priority=t.priority),void 0!==t.category&&(a.category=t.category),void 0!==t.dueDate&&(a.dueDate=t.dueDate),await f(e,a,{showToast:!0,onUpdate:e=>{console.log("âœ… Task updated via Dynamic GraphQL:",e)}})}catch(e){console.error("âŒ Update error:",e),q.toast.error("âŒ Error updating task")}},[f]),B=(0,a.useCallback)(async e=>{try{if(!confirm("Are you sure you want to delete this task?"))return;await j(e,{showToast:!0,onDelete:()=>{console.log("âœ… Task deleted via Dynamic GraphQL")}})}catch(e){console.error("âŒ Delete error:",e),q.toast.error("âŒ Error deleting task")}},[j]),$=(0,a.useCallback)(async(e,t)=>{try{await O(e,{status:t})}catch(e){console.error("âŒ Status change error:",e)}},[O]),F=(0,a.useCallback)(e=>{x(t=>({...t,...e}))},[]),K=(0,a.useCallback)(()=>{x({status:"all",priority:"all",category:"all",view:h.view}),u("")},[h.view]);return l?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(U.Loader2,{className:"h-12 w-12 animate-spin text-blue-600"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):e?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)(m,{totalTasks:P.total,onCreateTask:()=>G(),onSearch:u,searchQuery:d,onFilterChange:K}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(v,{stats:P})}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(D,{filters:h,onFiltersChange:F,myTasksCount:M.length,sharedTasksCount:I.length,allTasksCount:A.length})}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(_,{tasks:L,loading:p||T||S,onEdit:e=>{console.log("Edit task:",e),q.toast.success("Edit functionality coming soon!")},onDelete:B,onStatusChange:$,emptyMessage:d||"all"!==h.status||"all"!==h.priority||"all"!==h.category?"No tasks match your filters":"No tasks found. Create your first task to get started!"})})]}),(0,t.jsx)(ei,{isOpen:o,onClose:()=>c(!1),onTaskCreated:()=>{R()}})]}):null}e.s(["default",()=>eo],65659)}]);