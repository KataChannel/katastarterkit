(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,457439,533046,37750,248689,25366,e=>{"use strict";var s=e.i(44990),a=e.i(403055),t=e.i(775680),i=e.i(702470),n=e.i(885205),l=e.i(996517),c=e.i(645030),r=e.i(415733),d=e.i(649248),o=e.i(236929),m=e.i(759727),h=e.i(771564),x=e.i(495047),u=e.i(738543),j=e.i(606443),g=e.i(578078),N=e.i(435635),v=e.i(837149),p=e.i(245421);function f({className:e=""}){let[f,C]=(0,a.useState)("30d"),{data:T,loading:b,error:y}=(0,p.useFindUnique)("affiliateUser",{where:{userId:"CURRENT_USER_ID"}}),{data:w=[],loading:S}=(0,p.useFindMany)("affiliateLink",{where:{userId:"CURRENT_USER_ID"},take:10,orderBy:{createdAt:"desc"},include:{campaign:!0}}),{data:A=[],loading:D}=(0,p.useFindMany)("affiliateCampaign",{where:{status:"ACTIVE"},take:10,orderBy:{createdAt:"desc"}});if(!b&&!T)return(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsxs)(t.Card,{className:"max-w-2xl mx-auto",children:[(0,s.jsxs)(t.CardHeader,{className:"text-center",children:[(0,s.jsx)(t.CardTitle,{className:"text-2xl",children:"Chào mừng đến Chương Trình Affiliate"}),(0,s.jsx)(t.CardDescription,{children:"Tham gia chương trình affiliate và bắt đầu kiếm hoa hồng bằng cách quảng bá sản phẩm của chúng tôi."})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsx)(d.DollarSign,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),(0,s.jsx)("h3",{className:"font-semibold",children:"Kiếm Hoa Hồng"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Lên đến 30% mỗi đơn hàng"})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsx)(u.BarChart3,{className:"h-8 w-8 mx-auto mb-2 text-blue-500"}),(0,s.jsx)("h3",{className:"font-semibold",children:"Phân Tích Thời Gian Thực"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Theo dõi hiệu suất của bạn"})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsx)(v.Target,{className:"h-8 w-8 mx-auto mb-2 text-purple-500"}),(0,s.jsx)("h3",{className:"font-semibold",children:"Nhiều Chiến Dịch"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chọn những gì quảng bá"})]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)(n.Button,{size:"lg",className:"w-full max-w-xs",children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tham Gia Chương Trình Affiliate"]})})]})]})});if(b)return(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),(0,s.jsx)("div",{className:"h-8 bg-muted rounded w-3/4"})]})})},a))})});if(y)return(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsx)(r.Alert,{children:(0,s.jsx)(r.AlertDescription,{children:"Không thể tải dữ liệu affiliate. Vui lòng thử lại."})})});let E={totalEarnings:T?.totalEarnings||0,totalClicks:T?.totalClicks||0,totalConversions:T?.totalConversions||0,conversionRate:T?.conversionRate||0,activeLinks:w.filter(e=>e.isActive).length,activeCampaigns:A.length,averageOrderValue:T?.averageOrderValue||0,pendingCommissions:w.reduce((e,s)=>e+(s.commission||0),0)};return(0,s.jsxs)("div",{className:`p-6 ${e}`,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Bảng Điều Khiển Affiliate"}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:[T?.businessName||"Chào mừng trở lại"," • ",T?.role]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.Badge,{variant:T?.status==="ACTIVE"?"default":"secondary",children:T?.status}),T?.isVerified&&(0,s.jsx)(i.Badge,{variant:"outline",className:"text-green-600 border-green-600",children:"Đã xác minh"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Thu Nhập"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:["$",E.totalEarnings.toFixed(2)]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"+12% so với tháng trước"})]}),(0,s.jsx)(d.DollarSign,{className:"h-8 w-8 text-green-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Lượt Click"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.totalClicks.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"+8% so với tháng trước"})]}),(0,s.jsx)(o.MousePointer,{className:"h-8 w-8 text-blue-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Chuyển Đổi"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.totalConversions}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Tỷ lệ ",E.conversionRate.toFixed(1),"%"]})]}),(0,s.jsx)(m.TrendingUp,{className:"h-8 w-8 text-purple-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Links Hoạt Động"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.activeLinks}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[E.activeCampaigns," chiến dịch"]})]}),(0,s.jsx)(x.Link2,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,s.jsxs)(l.Tabs,{defaultValue:"overview",className:"space-y-6",children:[(0,s.jsxs)(l.TabsList,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(l.TabsTrigger,{value:"overview",children:"Tổng Quan"}),(0,s.jsx)(l.TabsTrigger,{value:"links",children:"Links Của Tôi"}),(0,s.jsx)(l.TabsTrigger,{value:"campaigns",children:"Chiến Dịch"}),(0,s.jsx)(l.TabsTrigger,{value:"performance",children:"Hiệu Suất"})]}),(0,s.jsx)(l.TabsContent,{value:"overview",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Hiệu Suất Gần Đây"}),(0,s.jsx)(t.CardDescription,{children:"Hiệu suất của bạn trong 30 ngày qua"})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm",children:"Tỷ Lệ Chuyển Đổi"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:[E.conversionRate.toFixed(1),"%"]})]}),(0,s.jsx)(c.Progress,{value:E.conversionRate,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm",children:"Giá Trị Đơn Hàng Trung Bình"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:["$",E.averageOrderValue.toFixed(2)]})]}),(0,s.jsx)(c.Progress,{value:E.averageOrderValue/200*100,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm",children:"Tỷ Lệ Hoa Hồng"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"15-30%"})]}),(0,s.jsx)(c.Progress,{value:75,className:"h-2"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Thao Tác Nhanh"}),(0,s.jsx)(t.CardDescription,{children:"Các tác vụ và phím tắt thông dụng"})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-3",children:[(0,s.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,s.jsx)(x.Link2,{className:"h-4 w-4 mr-2"}),"Tạo Link Mới"]}),(0,s.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,s.jsx)(u.BarChart3,{className:"h-4 w-4 mr-2"}),"Xem Phân Tích"]}),(0,s.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,s.jsx)(d.DollarSign,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán"]}),(0,s.jsxs)(n.Button,{className:"w-full justify-start",variant:"outline",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4 mr-2"}),"Duyệt Chiến Dịch"]})]})]})]})}),(0,s.jsxs)(l.TabsContent,{value:"links",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Links Affiliate Của Tôi"}),(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:0===w.length?(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center py-10",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(x.Link2,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Chưa tạo link nào"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Tạo link affiliate đầu tiên của bạn để bắt đầu kiếm hoa hồng."}),(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link Đầu Tiên"]})]})})}):w.map(e=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h4",{className:"font-semibold truncate",children:e.title||e.campaign?.name}),(0,s.jsx)(i.Badge,{variant:e.isActive?"default":"secondary",children:e.isActive?"Đang hoạt động":"Không hoạt động"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,s.jsxs)("span",{children:[e.totalClicks||0," lượt click"]}),(0,s.jsxs)("span",{children:[e.totalConversions||0," chuyển đổi"]}),(0,s.jsxs)("span",{children:["$",(e.commission||0).toFixed(2)," kiếm được"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:(0,s.jsx)(g.ExternalLink,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:"Sao chép Link"})]})]})})},e.id))})]}),(0,s.jsxs)(l.TabsContent,{value:"campaigns",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Chiến Dịch Có Sẵn"}),(0,s.jsxs)(n.Button,{variant:"outline",children:[(0,s.jsx)(N.Calendar,{className:"h-4 w-4 mr-2"}),"Lọc"]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:A.map(e=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h4",{className:"font-semibold",children:e.name}),(0,s.jsx)(i.Badge,{variant:"ACTIVE"===e.status?"default":"secondary",children:e.status}),(0,s.jsx)(i.Badge,{variant:"outline",children:"PERCENTAGE"===e.commissionType?`${e.commissionRate}%`:`$${e.fixedAmount}`})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,s.jsxs)("span",{children:[e.totalClicks.toLocaleString()," lượt click"]}),(0,s.jsxs)("span",{children:[e.totalConversions," chuyển đổi"]}),(0,s.jsxs)("span",{children:["Tỷ lệ ",e.conversionRate.toFixed(1),"%"]}),(0,s.jsxs)("span",{children:["$",e.totalRevenue.toFixed(2)," doanh thu"]})]})]}),(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(x.Link2,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})]})})},e.id))})]}),(0,s.jsx)(l.TabsContent,{value:"performance",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Xu Hướng Thu Nhập"}),(0,s.jsx)(t.CardDescription,{children:"Thu nhập của bạn theo thời gian"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(u.BarChart3,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{children:"Biểu đồ sẽ được triển khai"})]})})})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Hiệu Suất Click"}),(0,s.jsx)(t.CardDescription,{children:"Lượt click và chuyển đổi theo nguồn"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(o.MousePointer,{className:"h-12 w-12 mx-auto mb-4"}),(0,s.jsx)("p",{children:"Biểu đồ hiệu suất sẽ được triển khai"})]})})})]})]})})]})]})}e.s(["default",()=>f],533046);var C=e.i(429105),T=e.i(950988),b=e.i(696134),y=e.i(165429),w=e.i(600547),S=e.i(183194),A=e.i(137651),D=e.i(965120),E=e.i(404210),L=e.i(173416),I=e.i(850384),k=e.i(129376);function P({className:e="",userRole:c="AFFILIATE"}){let[r,o]=(0,a.useState)("active"),[x,g]=(0,a.useState)(!1),[N,p]=(0,a.useState)(null),[f,P]=(0,a.useState)(""),[F,B]=(0,a.useState)({name:"",description:"",type:"PUBLIC",commissionType:"PERCENTAGE",commissionRate:10,cookieDuration:30,minPayoutAmount:50,categories:[],targetCountries:["US"]}),{data:R,loading:O,error:M,refetch:H}=(0,C.useQuery)(k.GET_AFFILIATE_CAMPAIGNS,{variables:{search:{status:"active"===r?"ACTIVE":"draft"===r?"DRAFT":void 0,page:1,size:20}}}),[V,{loading:$}]=(0,T.useMutation)(k.CREATE_AFFILIATE_CAMPAIGN,{onCompleted:()=>{g(!1),B({name:"",description:"",type:"PUBLIC",commissionType:"PERCENTAGE",commissionRate:10,cookieDuration:30,minPayoutAmount:50,categories:[],targetCountries:["US"]}),H()}}),[U,{loading:G}]=(0,T.useMutation)(k.UPDATE_AFFILIATE_CAMPAIGN,{onCompleted:()=>{p(null),H()}}),_=(R?.affiliateCampaigns||[]).filter(e=>e.name.toLowerCase().includes(f.toLowerCase())||e.description.toLowerCase().includes(f.toLowerCase())),K=async()=>{try{await V({variables:{input:F}})}catch(e){console.error("Error creating campaign:",e)}},Y=async()=>{if(N)try{await U({variables:{id:N.id,input:F}})}catch(e){console.error("Error updating campaign:",e)}},z=({campaign:e})=>(0,s.jsx)(t.Card,{children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,s.jsx)(i.Badge,{variant:"ACTIVE"===e.status?"default":"secondary",children:e.status}),(0,s.jsx)(i.Badge,{variant:"outline",children:e.type})]}),(0,s.jsx)("p",{className:"text-muted-foreground mb-3",children:e.description})]}),"MERCHANT"===c&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/admin/affiliate/campaigns/${e.id}/applications`,title:"View Applications",children:(0,s.jsx)(h.Users,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>{p(e),B({name:e.name,description:e.description,type:e.type,commissionType:e.commissionType,commissionRate:e.commissionRate,fixedAmount:e.fixedAmount,cookieDuration:e.cookieDuration,minPayoutAmount:e.minPayoutAmount,maxPayoutAmount:e.maxPayoutAmount,categories:e.categories,targetCountries:e.targetCountries,terms:e.terms})},children:(0,s.jsx)(D.Edit,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:(0,s.jsx)(E.Eye,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(d.DollarSign,{className:"h-4 w-4 text-green-500"})}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:"PERCENTAGE"===e.commissionType?`${e.commissionRate}%`:`$${e.fixedAmount}`}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Hoa hồng"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(h.Users,{className:"h-4 w-4 text-blue-500"})}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.totalClicks.toLocaleString()}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lượt click"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(m.TrendingUp,{className:"h-4 w-4 text-purple-500"})}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.totalConversions}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Chuyển đổi"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(v.Target,{className:"h-4 w-4 text-orange-500"})}),(0,s.jsxs)("div",{className:"text-sm font-semibold",children:[e.conversionRate.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Tỷ lệ"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{children:["Doanh thu: $",e.totalRevenue.toFixed(2)]}),(0,s.jsxs)("span",{children:["Hoa hồng: $",e.totalCommission.toFixed(2)]}),e.endDate&&(0,s.jsxs)("span",{children:["Kết thúc: ",new Date(e.endDate).toLocaleDateString()]})]}),"AFFILIATE"===c&&(0,s.jsx)(n.Button,{size:"sm",children:"Tạo Link"})]})]})},e.id),q=()=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"name",children:"Tên Chiến Dịch"}),(0,s.jsx)(b.Input,{id:"name",value:F.name||"",onChange:e=>B({...F,name:e.target.value}),placeholder:"Nhập tên chiến dịch"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"type",children:"Loại Chiến Dịch"}),(0,s.jsxs)(S.Select,{value:F.type,onValueChange:e=>B({...F,type:e}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"PUBLIC",children:"Công khai"}),(0,s.jsx)(S.SelectItem,{value:"PRIVATE",children:"Riêng tư"}),(0,s.jsx)(S.SelectItem,{value:"INVITE_ONLY",children:"Chỉ theo mời"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"description",children:"Mô Tả"}),(0,s.jsx)(w.Textarea,{id:"description",value:F.description||"",onChange:e=>B({...F,description:e.target.value}),placeholder:"Mô tả chiến dịch của bạn",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"commissionType",children:"Loại Hoa Hồng"}),(0,s.jsxs)(S.Select,{value:F.commissionType,onValueChange:e=>B({...F,commissionType:e}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"PERCENTAGE",children:"Phần trăm"}),(0,s.jsx)(S.SelectItem,{value:"FIXED",children:"Số tiền cố định"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"commission",children:"PERCENTAGE"===F.commissionType?"Tỷ Lệ Hoa Hồng (%)":"Số Tiền Cố Định ($)"}),(0,s.jsx)(b.Input,{id:"commission",type:"number",value:"PERCENTAGE"===F.commissionType?F.commissionRate:F.fixedAmount,onChange:e=>{let s=parseFloat(e.target.value);"PERCENTAGE"===F.commissionType?B({...F,commissionRate:s}):B({...F,fixedAmount:s})},placeholder:"PERCENTAGE"===F.commissionType?"10":"25.00"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"cookieDuration",children:"Thời Gian Cookie (ngày)"}),(0,s.jsx)(b.Input,{id:"cookieDuration",type:"number",value:F.cookieDuration||30,onChange:e=>B({...F,cookieDuration:parseInt(e.target.value)})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"minPayout",children:"Số Tiền Thanh Toán Tối Thiểu ($)"}),(0,s.jsx)(b.Input,{id:"minPayout",type:"number",value:F.minPayoutAmount||50,onChange:e=>B({...F,minPayoutAmount:parseFloat(e.target.value)})})]})]})]});return O?(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,s.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsx)("div",{className:"h-12 bg-muted rounded"},a))})]})})},a))})}):(0,s.jsxs)("div",{className:`p-6 ${e}`,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"MERCHANT"===c?"Chiến Dịch Của Tôi":"Chiến Dịch Có Sẵn"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"MERCHANT"===c?"Quản lý các chiến dịch tiếp thị affiliate của bạn":"Duyệt và tham gia chiến dịch để bắt đầu kiếm tiền"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["AFFILIATE"===c&&(0,s.jsxs)(n.Button,{onClick:()=>window.location.href="/admin/affiliate/browse",children:[(0,s.jsx)(I.Search,{className:"h-4 w-4 mr-2"}),"Duyệt Tất Cả Chiến Dịch"]}),"MERCHANT"===c&&(0,s.jsxs)(A.Dialog,{open:x,onOpenChange:g,children:[(0,s.jsx)(A.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Chiến Dịch"]})}),(0,s.jsxs)(A.DialogContent,{className:"max-w-2xl",children:[(0,s.jsx)(A.DialogHeader,{children:(0,s.jsx)(A.DialogTitle,{children:"Tạo Chiến Dịch Mới"})}),(0,s.jsx)(q,{}),(0,s.jsxs)(A.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>g(!1),children:"Hủy"}),(0,s.jsx)(n.Button,{onClick:K,disabled:$,children:$?"Đang tạo...":"Tạo Chiến Dịch"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)(l.Tabs,{value:r,onValueChange:o,children:(0,s.jsxs)(l.TabsList,{children:[(0,s.jsx)(l.TabsTrigger,{value:"active",children:"Đang hoạt động"}),(0,s.jsx)(l.TabsTrigger,{value:"draft",children:"Bản nháp"}),(0,s.jsx)(l.TabsTrigger,{value:"ended",children:"Đã kết thúc"}),(0,s.jsx)(l.TabsTrigger,{value:"all",children:"Tất cả"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Input,{placeholder:"Tìm kiếm chiến dịch...",value:f,onChange:e=>P(e.target.value),className:"w-64"}),(0,s.jsx)(n.Button,{variant:"outline",size:"icon",children:(0,s.jsx)(L.Filter,{className:"h-4 w-4"})})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===_.length?(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(u.BarChart3,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Không tìm thấy chiến dịch"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"MERCHANT"===c?"Bạn chưa tạo chiến dịch nào.":"Không có chiến dịch nào phù hợp với tiêu chí tìm kiếm."}),"MERCHANT"===c&&(0,s.jsxs)(n.Button,{onClick:()=>g(!0),children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Chiến Dịch Đầu Tiên"]})]})})}):_.map(e=>(0,s.jsx)(z,{campaign:e},e.id))}),(0,s.jsx)(A.Dialog,{open:!!N,onOpenChange:e=>!e&&p(null),children:(0,s.jsxs)(A.DialogContent,{className:"max-w-2xl",children:[(0,s.jsx)(A.DialogHeader,{children:(0,s.jsx)(A.DialogTitle,{children:"Chỉnh Sửa Chiến Dịch"})}),(0,s.jsx)(q,{}),(0,s.jsxs)(A.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>p(null),children:"Hủy"}),(0,s.jsx)(n.Button,{onClick:Y,disabled:G,children:G?"Đang cập nhật...":"Cập Nhật Chiến Dịch"})]})]})})]})}e.s(["default",()=>P],37750);var F=e.i(985937),B=e.i(12465),B=B;function R({className:e=""}){let[c,r]=(0,a.useState)("active"),[d,h]=(0,a.useState)(!1),[N,v]=(0,a.useState)(""),[p,f]=(0,a.useState)("all"),[E,L]=(0,a.useState)({campaignId:"",originalUrl:"",customAlias:"",title:"",description:""}),{data:I,loading:P,error:R,refetch:O}=(0,C.useQuery)(k.GET_AFFILIATE_LINKS,{variables:{search:{isActive:"active"===c||"inactive"!==c&&void 0,pagination:{page:1,size:20}}}}),{data:M,loading:H}=(0,C.useQuery)(k.GET_AFFILIATE_CAMPAIGNS,{variables:{search:{status:"ACTIVE",page:1,size:100}}}),[V,{loading:$}]=(0,T.useMutation)(k.CREATE_AFFILIATE_LINK,{onCompleted:()=>{h(!1),L({campaignId:"",originalUrl:"",customAlias:"",title:"",description:""}),O()}}),U=I?.affiliateLinks||[],G=M?.affiliateCampaigns||[],_=U.filter(e=>{let s=e.title?.toLowerCase().includes(N.toLowerCase())||e.description?.toLowerCase().includes(N.toLowerCase())||e.campaign.name.toLowerCase().includes(N.toLowerCase()),a="all"===p||e.campaignId===p;return s&&a}),K=async()=>{try{await V({variables:{input:E}})}catch(e){console.error("Error creating link:",e)}},Y=({link:e})=>(0,s.jsx)(t.Card,{children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h3",{className:"font-semibold truncate",children:e.title||e.campaign.name}),(0,s.jsx)(i.Badge,{variant:e.isActive?"default":"secondary",children:e.isActive?"Đang hoạt động":"Không hoạt động"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:e.description||"Chưa có mô tả"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mb-3",children:["Chiến dịch: ",(0,s.jsx)("span",{className:"font-medium",children:e.campaign.name})]})]})}),(0,s.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.Label,{className:"text-xs",children:"URL rút gọn:"}),(0,s.jsx)("code",{className:"flex-1 text-sm bg-muted px-2 py-1 rounded truncate",children:e.shortUrl}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",onClick:()=>{var s;return s=e.shortUrl,void navigator.clipboard.writeText(s)},children:(0,s.jsx)(F.Copy,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",asChild:!0,children:(0,s.jsx)("a",{href:e.shortUrl,target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(g.ExternalLink,{className:"h-4 w-4"})})})]}),e.customAlias&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Alias: ",e.customAlias]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(o.MousePointer,{className:"h-4 w-4 text-blue-500"})}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:(e.totalClicks||0).toLocaleString()}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lượt click"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(m.TrendingUp,{className:"h-4 w-4 text-green-500"})}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:e.totalConversions||0}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Chuyển đổi"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,s.jsx)(u.BarChart3,{className:"h-4 w-4 text-purple-500"})}),(0,s.jsxs)("div",{className:"text-sm font-semibold",children:[(e.conversionRate||0).toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Tỷ lệ"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"text-muted-foreground",children:["Doanh thu: ",(0,s.jsxs)("span",{className:"font-medium text-foreground",children:["$",(e.revenue||0).toFixed(2)]})," • ","Hoa hồng: ",(0,s.jsxs)("span",{className:"font-medium text-green-600",children:["$",(e.commission||0).toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:(0,s.jsx)(B.default,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:(0,s.jsx)(u.BarChart3,{className:"h-4 w-4"})}),(0,s.jsx)(n.Button,{size:"sm",variant:"outline",children:(0,s.jsx)(D.Edit,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:["Tạo lúc: ",new Date(e.createdAt).toLocaleDateString()]})]})});return P||H?(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,s.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,s.jsx)("div",{className:"h-10 bg-muted rounded"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)("div",{className:"h-12 bg-muted rounded"},a))})]})})},a))})}):(0,s.jsxs)("div",{className:`p-6 ${e}`,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Links Affiliate"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Tạo và quản lý các links theo dõi affiliate của bạn"})]}),(0,s.jsxs)(A.Dialog,{open:d,onOpenChange:h,children:[(0,s.jsx)(A.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})}),(0,s.jsxs)(A.DialogContent,{className:"max-w-2xl",children:[(0,s.jsx)(A.DialogHeader,{children:(0,s.jsx)(A.DialogTitle,{children:"Tạo Link Affiliate Mới"})}),(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"campaign",children:"Chiến Dịch"}),(0,s.jsxs)(S.Select,{value:E.campaignId,onValueChange:e=>L({...E,campaignId:e}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{placeholder:"Chọn chiến dịch"})}),(0,s.jsx)(S.SelectContent,{children:G.map(e=>(0,s.jsx)(S.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsx)(i.Badge,{variant:"outline",className:"ml-2",children:"PERCENTAGE"===e.commissionType?`${e.commissionRate}%`:`$${e.fixedAmount}`})]})},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"originalUrl",children:"URL Đích"}),(0,s.jsx)(b.Input,{id:"originalUrl",value:E.originalUrl,onChange:e=>L({...E,originalUrl:e.target.value}),placeholder:"https://example.com/product"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"customAlias",children:"Biệt danh tùy chỉnh (tùy chọn)"}),(0,s.jsx)(b.Input,{id:"customAlias",value:E.customAlias||"",onChange:e=>L({...E,customAlias:e.target.value}),placeholder:"link-đặc-biệt"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"title",children:"Tiêu Đề Link"}),(0,s.jsx)(b.Input,{id:"title",value:E.title||"",onChange:e=>L({...E,title:e.target.value}),placeholder:"Tiêu đề mô tả cho link của bạn"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"description",children:"Mô Tả (tùy chọn)"}),(0,s.jsx)(w.Textarea,{id:"description",value:E.description||"",onChange:e=>L({...E,description:e.target.value}),placeholder:"Ghi chú bổ sung về link này",rows:3})]})]}),{}),(0,s.jsxs)(A.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>h(!1),children:"Hủy"}),(0,s.jsx)(n.Button,{onClick:K,disabled:$||!E.campaignId||!E.originalUrl,children:$?"Đang tạo...":"Tạo Link"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)(l.Tabs,{value:c,onValueChange:r,children:(0,s.jsxs)(l.TabsList,{children:[(0,s.jsx)(l.TabsTrigger,{value:"active",children:"Đang hoạt động"}),(0,s.jsx)(l.TabsTrigger,{value:"inactive",children:"Không hoạt động"}),(0,s.jsx)(l.TabsTrigger,{value:"all",children:"Tất cả"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.Input,{placeholder:"Tìm kiếm links...",value:N,onChange:e=>v(e.target.value),className:"w-64"}),(0,s.jsxs)(S.Select,{value:p,onValueChange:f,children:[(0,s.jsx)(S.SelectTrigger,{className:"w-48",children:(0,s.jsx)(S.SelectValue,{placeholder:"Tất cả chiến dịch"})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"all",children:"Tất cả chiến dịch"}),G.map(e=>(0,s.jsx)(S.SelectItem,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===_.length?(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(x.Link2,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Không tìm thấy links"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:N||p?"Không có links nào phù hợp với tiêu chí tìm kiếm.":"Bạn chưa tạo links affiliate nào."}),(0,s.jsxs)(n.Button,{onClick:()=>h(!0),children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link Đầu Tiên"]})]})})}):(0,s.jsx)("div",{className:"grid gap-4",children:_.map(e=>(0,s.jsx)(Y,{link:e},e.id))})}),_.length>0&&(0,s.jsxs)(t.Card,{className:"mt-6",children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsx)(t.CardTitle,{children:"Thống Kê Tổng Hợp"})}),(0,s.jsx)(t.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:_.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Links"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:_.reduce((e,s)=>e+(s.totalClicks||0),0).toLocaleString()}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Lượt Click"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:_.reduce((e,s)=>e+(s.totalConversions||0),0)}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Chuyển Đổi"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",_.reduce((e,s)=>e+(s.commission||0),0).toFixed(2)]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Kiếm Được"})]})]})})]})]})}e.s(["default",()=>R],248689);var O=e.i(868877),M=e.i(540958),M=M,H=e.i(723477),H=H,V=e.i(822390),$=e.i(415588),U=e.i(257117),G=e.i(198513),_=e.i(897711);function K({className:e=""}){let[c,r]=(0,a.useState)("requests"),[o,m]=(0,a.useState)(!1),[h,x]=(0,a.useState)("30d"),[u,g]=(0,a.useState)({amount:0,paymentMethod:"PAYPAL",accountDetails:"",notes:"",periodStart:new Date(Date.now()-2592e6).toISOString(),periodEnd:new Date().toISOString()}),v=(0,a.useMemo)(()=>{let e=new Date;return{startDate:new Date(Date.now()-2592e6).toISOString(),endDate:e.toISOString()}},[]),{data:p,loading:f,refetch:w}=(0,C.useQuery)(k.GET_AFFILIATE_PAYMENT_REQUESTS,{variables:{search:{page:1,size:20}},fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!1}),{data:D,loading:E}=(0,C.useQuery)(k.GET_AFFILIATE_EARNINGS_REPORT,{variables:v,fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!1,nextFetchPolicy:"cache-first"}),[I,{loading:P}]=(0,T.useMutation)(k.CREATE_PAYMENT_REQUEST,{onCompleted:()=>{m(!1),g({amount:0,paymentMethod:"PAYPAL",accountDetails:"",notes:"",periodStart:new Date(Date.now()-2592e6).toISOString(),periodEnd:new Date().toISOString()}),w()}}),F=p?.affiliatePaymentRequests||[],B=D?.affiliateEarningsReport||{totalEarnings:0,availableForPayout:0,pendingPayments:0,paidThisMonth:0,minimumPayout:50},R=async()=>{try{await I({variables:{input:u}})}catch(e){console.error("Error creating payment request:",e)}},K=({request:e})=>{var a;return(0,s.jsx)(t.Card,{children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch(e){case"PENDING":return(0,s.jsx)($.Clock,{className:"h-4 w-4 text-yellow-500"});case"PROCESSING":return(0,s.jsx)(G.AlertCircle,{className:"h-4 w-4 text-blue-500"});case"COMPLETED":return(0,s.jsx)(V.CheckCircle,{className:"h-4 w-4 text-green-500"});case"CANCELLED":return(0,s.jsx)(U.XCircle,{className:"h-4 w-4 text-red-500"});default:return(0,s.jsx)($.Clock,{className:"h-4 w-4 text-gray-500"})}})(e.status),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsxs)("h3",{className:"font-semibold",children:["$",e.amount.toFixed(2)]}),(a=e.status,(0,s.jsx)(i.Badge,{variant:{PENDING:"secondary",PROCESSING:"default",COMPLETED:"default",CANCELLED:"destructive"}[a]||"secondary",children:{PENDING:"Đang chờ",PROCESSING:"Đang xử lý",COMPLETED:"Hoàn thành",CANCELLED:"Đã hủy"}[a]||a}))]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(e=>{switch(e){case"PAYPAL":return(0,s.jsx)(O.CreditCard,{className:"h-4 w-4"});case"BANK_TRANSFER":return(0,s.jsx)(M.default,{className:"h-4 w-4"});case"CRYPTO":return(0,s.jsx)(H.default,{className:"h-4 w-4"});default:return(0,s.jsx)(d.DollarSign,{className:"h-4 w-4"})}})(e.paymentMethod),(0,s.jsx)("span",{children:e.paymentMethod.replace("_"," ")}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:new Date(e.requestedAt).toLocaleDateString()})]})]})]}),(0,s.jsxs)("div",{className:"text-right text-sm text-muted-foreground",children:["Mã yêu cầu: ",(0,s.jsx)("code",{className:"text-xs",children:e.id.slice(-8)})]})]}),"COMPLETED"===e.status&&e.processedAt&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Đã xử lý:"}),(0,s.jsx)("span",{children:new Date(e.processedAt).toLocaleDateString()})]}),e.transactionId&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Mã giao dịch:"}),(0,s.jsx)("code",{className:"text-xs",children:e.transactionId})]})]}),e.adminNotes&&(0,s.jsxs)("div",{className:"mt-3 p-3 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm font-medium mb-1",children:"Ghi chú quản trị:"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.adminNotes})]})]})})};return f||E?(0,s.jsx)("div",{className:`p-6 ${e}`,children:(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,s.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,s.jsx)("div",{className:"h-8 bg-muted rounded"})]})})},a))})}):(0,s.jsxs)("div",{className:`p-6 ${e}`,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Thanh Toán"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Quản lý thu nhập và yêu cầu thanh toán của bạn"})]}),(0,s.jsxs)(A.Dialog,{open:o,onOpenChange:m,children:[(0,s.jsx)(A.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{disabled:!B.availableForPayout||B.availableForPayout<(B.minimumPayout||50),children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán"]})}),(0,s.jsxs)(A.DialogContent,{className:"max-w-2xl",children:[(0,s.jsx)(A.DialogHeader,{children:(0,s.jsx)(A.DialogTitle,{children:"Yêu Cầu Thanh Toán"})}),(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,s.jsx)("div",{className:"text-sm font-medium mb-2",children:"Số Dư Có Sẵn"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",B.availableForPayout?.toFixed(2)||"0.00"]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Số tiền tối thiểu: $",B.minimumPayout||50]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"amount",children:"Số Tiền"}),(0,s.jsx)(b.Input,{id:"amount",type:"number",step:"0.01",max:B.availableForPayout||0,value:u.amount||"",onChange:e=>g({...u,amount:parseFloat(e.target.value)||0}),placeholder:"0.00"}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Tối đa: $",B.availableForPayout?.toFixed(2)||"0.00"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"method",children:"Phương Thức Thanh Toán"}),(0,s.jsxs)(S.Select,{value:u.paymentMethod,onValueChange:e=>g({...u,paymentMethod:e}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"PAYPAL",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O.CreditCard,{className:"h-4 w-4"}),"PayPal"]})}),(0,s.jsx)(S.SelectItem,{value:"BANK_TRANSFER",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(M.default,{className:"h-4 w-4"}),"Chuyển khoản ngân hàng"]})}),(0,s.jsx)(S.SelectItem,{value:"CRYPTO",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(H.default,{className:"h-4 w-4"}),"Tiền điện tử"]})})]})]})]}),"PAYPAL"===u.paymentMethod&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"paypalEmail",children:"Email PayPal"}),(0,s.jsx)(b.Input,{id:"paypalEmail",type:"email",value:u.accountDetails&&JSON.parse(u.accountDetails).email||"",onChange:e=>g({...u,accountDetails:JSON.stringify({email:e.target.value})}),placeholder:"paypal-cua-ban@email.com"})]}),"BANK_TRANSFER"===u.paymentMethod&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"accountName",children:"Tên Tài Khoản"}),(0,s.jsx)(b.Input,{id:"accountName",value:u.accountDetails&&JSON.parse(u.accountDetails).accountName||"",onChange:e=>{let s=u.accountDetails?JSON.parse(u.accountDetails):{};g({...u,accountDetails:JSON.stringify({...s,accountName:e.target.value})})},placeholder:"Tên chủ tài khoản"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"accountNumber",children:"Số Tài Khoản"}),(0,s.jsx)(b.Input,{id:"accountNumber",value:u.accountDetails&&JSON.parse(u.accountDetails).accountNumber||"",onChange:e=>{let s=u.accountDetails?JSON.parse(u.accountDetails):{};g({...u,accountDetails:JSON.stringify({...s,accountNumber:e.target.value})})},placeholder:"Số tài khoản của bạn"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"routingNumber",children:"Số Định Tuyến"}),(0,s.jsx)(b.Input,{id:"routingNumber",value:u.accountDetails&&JSON.parse(u.accountDetails).routingNumber||"",onChange:e=>{let s=u.accountDetails?JSON.parse(u.accountDetails):{};g({...u,accountDetails:JSON.stringify({...s,routingNumber:e.target.value})})},placeholder:"Số định tuyến ngân hàng"})]})]}),"CRYPTO"===u.paymentMethod&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"cryptoType",children:"Tiền Điện Tử"}),(0,s.jsxs)(S.Select,{value:u.accountDetails&&JSON.parse(u.accountDetails).cryptoType||"BTC",onValueChange:e=>{let s=u.accountDetails?JSON.parse(u.accountDetails):{};g({...u,accountDetails:JSON.stringify({...s,cryptoType:e})})},children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"BTC",children:"Bitcoin (BTC)"}),(0,s.jsx)(S.SelectItem,{value:"ETH",children:"Ethereum (ETH)"}),(0,s.jsx)(S.SelectItem,{value:"USDT",children:"Tether (USDT)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{htmlFor:"walletAddress",children:"Địa Chỉ Ví"}),(0,s.jsx)(b.Input,{id:"walletAddress",value:u.accountDetails&&JSON.parse(u.accountDetails).walletAddress||"",onChange:e=>{let s=u.accountDetails?JSON.parse(u.accountDetails):{};g({...u,accountDetails:JSON.stringify({...s,walletAddress:e.target.value})})},placeholder:"Địa chỉ ví của bạn"})]})]})]}),{}),(0,s.jsxs)(A.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>m(!1),children:"Hủy"}),(0,s.jsx)(n.Button,{onClick:R,disabled:P||u.amount<(B.minimumPayout||50)||u.amount>(B.availableForPayout||0),children:P?"Đang gửi...":"Gửi Yêu Cầu"})]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Thu Nhập"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:["$",B.totalEarnings?.toFixed(2)||"0.00"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toàn thời gian"})]}),(0,s.jsx)(d.DollarSign,{className:"h-8 w-8 text-green-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Có Sẵn"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",B.availableForPayout?.toFixed(2)||"0.00"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sẵn sàng thanh toán"})]}),(0,s.jsx)(V.CheckCircle,{className:"h-8 w-8 text-green-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Đang Chờ"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:["$",B.pendingPayments?.toFixed(2)||"0.00"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Đang xử lý"})]}),(0,s.jsx)($.Clock,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tháng Này"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:["$",B.paidThisMonth?.toFixed(2)||"0.00"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Đã thanh toán"})]}),(0,s.jsx)(N.Calendar,{className:"h-8 w-8 text-blue-500"})]})})})]}),(0,s.jsxs)(l.Tabs,{value:c,onValueChange:r,className:"space-y-6",children:[(0,s.jsxs)(l.TabsList,{className:"grid w-full grid-cols-3",children:[(0,s.jsx)(l.TabsTrigger,{value:"requests",children:"Yêu Cầu Thanh Toán"}),(0,s.jsx)(l.TabsTrigger,{value:"history",children:"Lịch Sử Thanh Toán"}),(0,s.jsx)(l.TabsTrigger,{value:"settings",children:"Cài Đặt Thanh Toán"})]}),(0,s.jsxs)(l.TabsContent,{value:"requests",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Yêu Cầu Thanh Toán"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(L.Filter,{className:"h-4 w-4 mr-2"}),"Lọc"]}),(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",children:[(0,s.jsx)(_.Download,{className:"h-4 w-4 mr-2"}),"Xuất"]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===F.length?(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.DollarSign,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Chưa có yêu cầu thanh toán"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa thực hiện yêu cầu thanh toán nào."}),B.availableForPayout>=(B.minimumPayout||50)&&(0,s.jsxs)(n.Button,{onClick:()=>m(!0),children:[(0,s.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán Đầu Tiên"]})]})})}):F.map(e=>(0,s.jsx)(K,{request:e},e.id))})]}),(0,s.jsxs)(l.TabsContent,{value:"history",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Lịch Sử Thanh Toán"}),(0,s.jsxs)(S.Select,{value:h,onValueChange:x,children:[(0,s.jsx)(S.SelectTrigger,{className:"w-48",children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"7d",children:"7 ngày qua"}),(0,s.jsx)(S.SelectItem,{value:"30d",children:"30 ngày qua"}),(0,s.jsx)(S.SelectItem,{value:"90d",children:"90 ngày qua"}),(0,s.jsx)(S.SelectItem,{value:"1y",children:"Năm qua"})]})]})]}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(N.Calendar,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Biểu đồ lịch sử thanh toán"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Trực quan hóa lịch sử thanh toán chi tiết sẽ được triển khai ở đây."})]})})})]}),(0,s.jsx)(l.TabsContent,{value:"settings",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsx)(t.CardTitle,{children:"Tùy Chọn Thanh Toán"})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{children:"Phương Thức Thanh Toán Ưu Tiên"}),(0,s.jsxs)(S.Select,{defaultValue:"PAYPAL",children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"PAYPAL",children:"PayPal"}),(0,s.jsx)(S.SelectItem,{value:"BANK_TRANSFER",children:"Chuyển khoản ngân hàng"}),(0,s.jsx)(S.SelectItem,{value:"CRYPTO",children:"Tiền điện tử"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{children:"Ngưỡng Thanh Toán Tự Động"}),(0,s.jsxs)(S.Select,{defaultValue:"100",children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"50",children:"$50"}),(0,s.jsx)(S.SelectItem,{value:"100",children:"$100"}),(0,s.jsx)(S.SelectItem,{value:"250",children:"$250"}),(0,s.jsx)(S.SelectItem,{value:"500",children:"$500"})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tự động yêu cầu thanh toán khi đạt đến số tiền này"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsx)(t.CardTitle,{children:"Thông Tin Thuế"})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{children:"Mã số thuế"}),(0,s.jsx)(b.Input,{placeholder:"XXX-XX-XXXX"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(y.Label,{children:"Quốc Gia Thuế"}),(0,s.jsxs)(S.Select,{defaultValue:"US",children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"US",children:"Hoa Kỳ"}),(0,s.jsx)(S.SelectItem,{value:"CA",children:"Canada"}),(0,s.jsx)(S.SelectItem,{value:"UK",children:"Vương Quốc Anh"}),(0,s.jsx)(S.SelectItem,{value:"DE",children:"Đức"}),(0,s.jsx)(S.SelectItem,{value:"VN",children:"Việt Nam"})]})]})]}),(0,s.jsx)(n.Button,{variant:"outline",children:"Tải Lên Tài Liệu Thuế"})]})]})]})})]})]})}e.s(["default",()=>K],25366),e.s([],457439)}]);