(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,479017,(e,t,r)=>{!function(t,r){if("function"==typeof define&&define.amd){let t;void 0!==(t=r())&&e.v(t)}else r()}(e.e,function(){"use strict";function r(e,t,r){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){l(s.response,t,r)},s.onerror=function(){console.error("could not download file")},s.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:e.g.global===e.g?e.g:void 0,i=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,t,i){var l=a.URL||a.webkitURL,o=document.createElement("a");o.download=t=t||e.name||"download",o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?n(o):s(o.href)?r(e,t,i):n(o,o.target="_blank")):(o.href=l.createObjectURL(e),setTimeout(function(){l.revokeObjectURL(o.href)},4e4),setTimeout(function(){n(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,a){if(t=t||e.name||"download","string"!=typeof e){var i;navigator.msSaveOrOpenBlob((void 0===(i=a)?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),t)}else if(s(e))r(e,t,a);else{var l=document.createElement("a");l.href=e,l.target="_blank",setTimeout(function(){n(l)})}}:function(e,t,s,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,s);var l="application/octet-stream"===e.type,o=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||l&&o||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var h=a.URL||a.webkitURL,u=h.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){h.revokeObjectURL(u)},4e4)}});a.saveAs=l.saveAs=l,t.exports=l})},633236,e=>{"use strict";let t,r,s,n,a;var i,l,o,c,d,h=e.i(44990),u=e.i(403055),m=e.i(450681),g=e.i(982087),x=e.i(479187);let p=({invoices:e,loading:t=!1,onRowClick:r,height:s=600})=>{let n=e=>e||0===e?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"N/A",a=(0,u.useMemo)(()=>[{field:"nbmst",headerName:"MST NgÆ°á»i bÃ¡n",width:130,sortable:!0,filterable:!0,resizable:!0,pinned:"left",cellRenderer:({data:e})=>e.nbmst||"N/A"},{field:"khmshdon",headerName:"KÃ½ hiá»‡u máº«u",width:120,sortable:!0,filterable:!0,resizable:!0,pinned:"left",cellRenderer:({data:e})=>e.khmshdon||"N/A"},{field:"khhdon",headerName:"KÃ½ hiá»‡u HÄ",width:120,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.khhdon||"N/A"},{field:"shdon",headerName:"Sá»‘ HÄ",width:100,sortable:!0,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.shdon||"N/A",cellClass:"font-medium"},{field:"cqt",headerName:"CQT",width:80,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.cqt||"N/A"},{field:"nbdchi",headerName:"Äá»‹a chá»‰ NB",width:200,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nbdchi||"N/A"},{field:"nbten",headerName:"TÃªn NB",width:200,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nbten||"N/A"},{field:"nmdchi",headerName:"Äá»‹a chá»‰ NM",width:200,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nmdchi||"N/A"},{field:"nmmst",headerName:"MST NM",width:130,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nmmst||"N/A"},{field:"nmten",headerName:"TÃªn NM",width:200,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nmten||"N/A"},{field:"nmtnmua",headerName:"TÃªn NM mua",width:200,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.nmtnmua||"N/A"},{field:"tgtcthue",headerName:"Tiá»n chÆ°a thuáº¿",width:150,type:"number",sortable:!0,filterable:!0,resizable:!0,cellRenderer:({data:e})=>(0,h.jsx)("div",{className:"text-right font-medium",children:n(e.tgtcthue)})},{field:"tgtthue",headerName:"Tiá»n thuáº¿",width:150,type:"number",sortable:!0,filterable:!0,resizable:!0,cellRenderer:({data:e})=>(0,h.jsx)("div",{className:"text-right font-medium",children:n(e.tgtthue)})},{field:"tgtttbso",headerName:"Tá»•ng TT (sá»‘)",width:150,type:"number",sortable:!0,filterable:!0,resizable:!0,pinned:"right",cellRenderer:({data:e})=>(0,h.jsx)("div",{className:"text-right font-bold text-blue-600",children:n(e.tgtttbso)})},{field:"tgtttbchu",headerName:"Tá»•ng TT (chá»¯)",width:200,resizable:!0,cellRenderer:({data:e})=>e.tgtttbchu||"N/A"},{field:"thlap",headerName:"Thá»i Ä‘iá»ƒm láº­p",width:150,sortable:!0,filterable:!0,resizable:!0,cellRenderer:({data:e})=>e.thlap||"N/A"},{field:"ttcktmai",headerName:"CKTM",width:100,resizable:!0,cellRenderer:({data:e})=>e.ttcktmai||"N/A"},{field:"tthai",headerName:"Tráº¡ng thÃ¡i",width:120,filterable:!0,resizable:!0,cellRenderer:({data:e})=>{let t=e.tthai,r="bg-yellow-100 text-yellow-800",s=t||"N/A";return"1"===t||"active"===t?(r="bg-green-100 text-green-800",s="Há»£p lá»‡"):("0"===t||"cancelled"===t)&&(r="bg-red-100 text-red-800",s="ÄÃ£ há»§y"),(0,h.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${r}`,children:s})}},{field:"tttbao",headerName:"TT BÃ¡o",width:100,resizable:!0,cellRenderer:({data:e})=>e.tttbao||"N/A"},{field:"ttxly",headerName:"TT Xá»­ lÃ½",width:100,resizable:!0,cellRenderer:({data:e})=>e.ttxly||"N/A"}],[]),i=(0,u.useMemo)(()=>e.map((e,t)=>({...e,id:e.id||`${e.shdon}-${e.khmshdon}-${t}`})),[e]);return(0,h.jsx)("div",{className:"w-full",children:(0,h.jsx)(m.AdvancedTable,{columns:a,data:i,loading:t,height:s,config:{enableSorting:!0,enableFiltering:!0,enableColumnPinning:!0,enableColumnResizing:!0,enableColumnHiding:!0,enableRowSelection:!0,enableInlineEditing:!1,enableDialogEditing:!1,enableRowDeletion:!1,showToolbar:!0,showPagination:!1,virtualScrolling:!0,rowHeight:48,headerHeight:48},onRowSelect:e=>{1===e.length&&r&&r(e[0])},className:"border rounded-lg shadow-sm"})})};var f=e.i(888540),b=e.i(421329),y=e.i(435635),v=e.i(909905),w=e.i(701325),N=e.i(679797),N=N,j=e.i(649248),T=e.i(412400),T=T,E=e.i(112641),S=e.i(257117);let k=({invoice:e,isOpen:t,onClose:r})=>{if(!t||!e)return null;let s=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),n=t=>e?.[t];return(0,h.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,h.jsx)("div",{className:"fixed inset-0 bg-black/50 transition-opacity",onClick:r}),(0,h.jsx)("div",{className:"flex min-h-screen items-center justify-center p-4",children:(0,h.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,h.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-xl",children:(0,h.jsxs)("div",{className:"flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,h.jsx)(b.FileText,{className:"w-8 h-8"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{className:"text-2xl font-bold",children:"Chi tiáº¿t hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("p",{className:"text-blue-100 text-sm",children:"ThÃ´ng tin Ä‘áº§y Ä‘á»§ vá» hÃ³a Ä‘Æ¡n Ä‘iá»‡n tá»­"})]})]}),(0,h.jsx)("button",{onClick:r,className:"p-2 hover:bg-blue-500 rounded-lg transition-colors",children:(0,h.jsx)(f.X,{className:"w-6 h-6"})})]})}),(0,h.jsxs)("div",{className:"p-6 space-y-6",children:[(0,h.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600 mb-2",children:[(0,h.jsx)(N.default,{className:"w-5 h-5"}),(0,h.jsx)("span",{className:"text-sm font-medium",children:"Sá»‘ hÃ³a Ä‘Æ¡n"})]}),(0,h.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:e.shdon})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600 mb-2",children:[(0,h.jsx)(T.default,{className:"w-5 h-5"}),(0,h.jsx)("span",{className:"text-sm font-medium",children:"KÃ½ hiá»‡u hÃ³a Ä‘Æ¡n"})]}),(0,h.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:n("khhdon")||e.khmshdon})]})]})}),(0,h.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,h.jsx)(y.Calendar,{className:"w-5 h-5 mr-2 text-blue-600"}),"ThÃ´ng tin thá»i gian"]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"NgÃ y láº­p"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:(e=>{if(!e)return"N/A";try{let t="string"==typeof e?new Date(e):e;return(0,g.format)(t,"dd/MM/yyyy HH:mm",{locale:x.vi})}catch{return"string"==typeof e?e:"N/A"}})(e.tdlap)})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Thá»i gian láº­p"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("tglap")||"N/A"})]})]})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,h.jsx)(v.User,{className:"w-5 h-5 mr-2 text-green-600"}),"ThÃ´ng tin ngÆ°á»i mua"]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"md:col-span-2",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"TÃªn ngÆ°á»i mua"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nmten")||n("tenxmua")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"MÃ£ sá»‘ thuáº¿"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nmmst")||n("msttmua")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Äá»‹a chá»‰"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nmdchi")||n("dcxmua")||n("dchi")||"N/A"})]}),(0,h.jsxs)("div",{className:"md:col-span-2",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"NgÆ°á»i mua hÃ ng"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nmtnmua")||"N/A"})]})]})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,h.jsx)(w.Building2,{className:"w-5 h-5 mr-2 text-purple-600"}),"ThÃ´ng tin ngÆ°á»i bÃ¡n"]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{className:"md:col-span-2",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"TÃªn ngÆ°á»i bÃ¡n"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nbten")||n("tentcgp")||n("nten")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"MÃ£ sá»‘ thuáº¿ ngÆ°á»i bÃ¡n"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:e.nbmst||n("msttcgp")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Äá»‹a chá»‰ ngÆ°á»i bÃ¡n"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("nbdchi")||n("dctcgp")||"N/A"})]})]})]}),(0,h.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-6 border border-green-200",children:[(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,h.jsx)(j.DollarSign,{className:"w-5 h-5 mr-2 text-green-600"}),"ThÃ´ng tin tÃ i chÃ­nh"]}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Tá»•ng tiá»n trÆ°á»›c thuáº¿"}),(0,h.jsx)("p",{className:"text-xl font-bold text-gray-900",children:s(n("tgtcthue")||e.tgtcthue||0)})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Tiá»n thuáº¿ GTGT"}),(0,h.jsx)("p",{className:"text-xl font-bold text-orange-600",children:s(e.tgtthue||0)})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Tá»•ng tiá»n thanh toÃ¡n"}),(0,h.jsx)("p",{className:"text-xl font-bold text-green-600",children:s(e.tgtttbso||0)})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"HÃ¬nh thá»©c thanh toÃ¡n"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("htttt")||n("pthuc")||"N/A"})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"ÄÆ¡n vá»‹ tiá»n tá»‡"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("dvtte")||"VND"})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,h.jsx)("label",{className:"text-sm text-gray-600",children:"Tá»· giÃ¡"}),(0,h.jsx)("p",{className:"text-base font-medium text-gray-900",children:n("tgia")||"1"})]})]})]}),n("details")&&n("details").length>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,h.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,h.jsx)(T.default,{className:"w-5 h-5 mr-2 text-blue-600"}),"Chi tiáº¿t hÃ ng hÃ³a/dá»‹ch vá»¥ (",n("details").length," máº·t hÃ ng)"]}),(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,h.jsx)("thead",{className:"bg-gray-50",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"STT"}),(0,h.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"TÃªn hÃ ng hÃ³a"}),(0,h.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Sá»‘ lÆ°á»£ng"}),(0,h.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ÄVT"}),(0,h.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"ÄÆ¡n giÃ¡"}),(0,h.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"ThÃ nh tiá»n"})]})}),(0,h.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n("details").map((e,t)=>(0,h.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:t+1}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.dten||e.ten||"N/A"}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:e.dsl||e.sl||0}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.ddvt||e.dvt||""}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:s(e.ddgia||e.dgia||0)}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:s(e.dthanhtien||e.tien||0)})]},t))})]})})]}),(0,h.jsxs)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ThÃ´ng tin ká»¹ thuáº­t"}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"MÃ£ CQT"}),(0,h.jsx)("p",{className:"font-medium text-gray-900",children:n("cqt")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"KÃ½ hiá»‡u máº«u sá»‘ hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("p",{className:"font-medium text-gray-900",children:e.khmshdon||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"Tráº¡ng thÃ¡i hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("p",{className:"font-medium text-gray-900",children:"1"===n("thdon")||"1"===n("tghdon")?(0,h.jsxs)("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 rounded-full",children:[(0,h.jsx)(E.CheckCircle2,{className:"w-4 h-4 mr-1"}),"Há»£p lá»‡"]}):(0,h.jsxs)("span",{className:"inline-flex items-center px-2 py-1 bg-red-100 text-red-800 rounded-full",children:[(0,h.jsx)(S.XCircle,{className:"w-4 h-4 mr-1"}),"KhÃ´ng há»£p lá»‡"]})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"Loáº¡i hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("p",{className:"font-medium text-gray-900",children:n("khdon")||e.shdon||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"MÃ£ tra cá»©u"}),(0,h.jsx)("p",{className:"font-medium text-gray-900 break-all",children:n("mtdiep")||"N/A"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"text-gray-600",children:"Tráº¡ng thÃ¡i láº­p"}),(0,h.jsx)("p",{className:"font-medium text-gray-900",children:n("thlap")||"N/A"})]})]})]}),n("gchu")&&(0,h.jsxs)("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6",children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ghi chÃº"}),(0,h.jsx)("p",{className:"text-gray-700",children:n("gchu")})]})]}),(0,h.jsx)("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 rounded-b-xl border-t border-gray-200",children:(0,h.jsx)("div",{className:"flex justify-end space-x-3",children:(0,h.jsx)("button",{onClick:r,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"ÄÃ³ng"})})})]})})]})};var R=e.i(455461),C=e.i(897711),D=e.i(248025),A=e.i(822390),O=e.i(198513),I=e.i(169989),$=e.i(835819),U=e.i(308140);let L=async(e,t={})=>{let r,s="http://116.118.49.243:13001/graphql".replace("/graphql",""),n=e.startsWith("/")?`${s}${e}`:`${s}/${e}`,a={...(r=localStorage.getItem("accessToken"))?{Authorization:`Bearer ${r}`}:{},...t.headers};return fetch(n,{...t,headers:a})};function F({isOpen:e,onClose:t,onSuccess:r}){let[s,n]=(0,u.useState)(null),[a,i]=(0,u.useState)(!1),[l,o]=(0,u.useState)(null),[c,d]=(0,u.useState)(null),m=(0,u.useRef)(null);if(!e)return null;let g=async()=>{try{let e=await L("/api/invoice-import/template",{method:"GET"});if(!e.ok)throw Error("KhÃ´ng thá»ƒ táº£i file máº«u");let t=await e.blob(),r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=`Mau_Import_Hoadon_${new Date().getTime()}.xlsx`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s),$.toast.success("ÄÃ£ táº£i file máº«u thÃ nh cÃ´ng")}catch(e){console.error("Error downloading template:",e),$.toast.error("KhÃ´ng thá»ƒ táº£i file máº«u")}},x=async()=>{if(!s)return void $.toast.error("Vui lÃ²ng chá»n file Ä‘á»ƒ preview");try{i(!0);let e=new FormData;e.append("file",s);let t=await L("/api/invoice-import/preview",{method:"POST",body:e}),r=await t.json();r.success?(d(r),$.toast.success(r.message)):$.toast.error(r.message)}catch(e){console.error("Error previewing file:",e),$.toast.error("KhÃ´ng thá»ƒ preview file")}finally{i(!1)}},p=async()=>{if(!s)return void $.toast.error("Vui lÃ²ng chá»n file Ä‘á»ƒ import");try{i(!0),o(null);let e=new FormData;e.append("file",s);let t=await L("/api/invoice-import/upload",{method:"POST",body:e}),n=await t.json();o(n),n.success?($.toast.success(n.message),r&&r()):$.toast.error(n.message)}catch(e){console.error("Error importing file:",e),$.toast.error("Import tháº¥t báº¡i")}finally{i(!1)}},b=()=>{n(null),o(null),d(null),m.current&&(m.current.value=""),t()};return(0,h.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[(0,h.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,h.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[(0,h.jsx)(D.FileSpreadsheet,{className:"w-6 h-6 text-blue-600"}),"Import dá»¯ liá»‡u hÃ³a Ä‘Æ¡n"]}),(0,h.jsx)("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,h.jsx)(f.X,{className:"w-6 h-6"})})]}),(0,h.jsxs)("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:[(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsxs)("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,h.jsx)(C.Download,{className:"w-4 h-4"}),"Táº£i file máº«u"]}),(0,h.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Táº£i file Excel máº«u Ä‘á»ƒ Ä‘iá»n dá»¯ liá»‡u hÃ³a Ä‘Æ¡n cá»§a báº¡n"})]}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chá»n file Excel Ä‘á»ƒ import"}),(0,h.jsxs)("div",{className:"flex items-center gap-4",children:[(0,h.jsx)("input",{ref:m,type:"file",accept:".xlsx,.xls",onChange:e=>{let t=e.target.files?.[0];if(t){if(!t.name.match(/\.(xlsx|xls)$/))return void $.toast.error("Vui lÃ²ng chá»n file Excel (.xlsx hoáº·c .xls)");n(t),o(null),d(null)}},className:"hidden",id:"file-upload"}),(0,h.jsxs)("label",{htmlFor:"file-upload",className:"flex items-center gap-2 px-4 py-2 border-2 border-dashed border-gray-300 rounded-md hover:border-blue-500 cursor-pointer transition-colors",children:[(0,h.jsx)(R.Upload,{className:"w-4 h-4 text-gray-600"}),(0,h.jsx)("span",{className:"text-sm text-gray-600",children:"Chá»n file"})]}),s&&(0,h.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,h.jsx)(D.FileSpreadsheet,{className:"w-4 h-4 text-blue-600"}),s.name,(0,h.jsx)("button",{onClick:()=>n(null),className:"text-red-600 hover:text-red-700",children:(0,h.jsx)(f.X,{className:"w-4 h-4"})})]})]})]}),s&&!l&&(0,h.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,h.jsxs)("button",{onClick:x,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:[a?(0,h.jsx)(I.Loader2,{className:"w-4 h-4 animate-spin"}):(0,h.jsx)(D.FileSpreadsheet,{className:"w-4 h-4"}),"Xem trÆ°á»›c dá»¯ liá»‡u"]}),(0,h.jsxs)("button",{onClick:p,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 transition-colors",children:[a?(0,h.jsx)(I.Loader2,{className:"w-4 h-4 animate-spin"}):(0,h.jsx)(R.Upload,{className:"w-4 h-4"}),"Import ngay"]})]}),c&&!l&&(0,h.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-md",children:[(0,h.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"Preview dá»¯ liá»‡u"}),(0,h.jsxs)("p",{className:"text-sm text-blue-700",children:["TÃ¬m tháº¥y ",(0,h.jsx)("strong",{children:c.totalInvoices})," hÃ³a Ä‘Æ¡n trong file"]}),c.data&&c.data.length>0&&(0,h.jsxs)("div",{className:"mt-4 overflow-x-auto",children:[(0,h.jsxs)("table",{className:"min-w-full text-sm",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{className:"bg-blue-100",children:[(0,h.jsx)("th",{className:"px-2 py-1 text-left",children:"Sá»‘ HÄ"}),(0,h.jsx)("th",{className:"px-2 py-1 text-left",children:"KÃ½ hiá»‡u"}),(0,h.jsx)("th",{className:"px-2 py-1 text-left",children:"NgÆ°á»i bÃ¡n"}),(0,h.jsx)("th",{className:"px-2 py-1 text-left",children:"NgÆ°á»i mua"}),(0,h.jsx)("th",{className:"px-2 py-1 text-right",children:"Tá»•ng tiá»n"})]})}),(0,h.jsx)("tbody",{children:c.data.slice(0,5).map((e,t)=>(0,h.jsxs)("tr",{className:"border-b border-blue-100",children:[(0,h.jsx)("td",{className:"px-2 py-1",children:e.shdon}),(0,h.jsx)("td",{className:"px-2 py-1",children:e.khhdon}),(0,h.jsx)("td",{className:"px-2 py-1",children:e.nbten}),(0,h.jsx)("td",{className:"px-2 py-1",children:e.nmten}),(0,h.jsx)("td",{className:"px-2 py-1 text-right",children:e.tgtttbso?.toLocaleString()})]},t))})]}),c.totalInvoices>5&&(0,h.jsxs)("p",{className:"text-xs text-blue-600 mt-2",children:["... vÃ  ",c.totalInvoices-5," hÃ³a Ä‘Æ¡n khÃ¡c"]})]})]}),l&&(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsx)("div",{className:`p-4 rounded-md ${l.success?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:(0,h.jsxs)("div",{className:"flex items-start gap-3",children:[l.success?(0,h.jsx)(A.CheckCircle,{className:"w-6 h-6 text-green-600 flex-shrink-0"}):(0,h.jsx)(O.AlertCircle,{className:"w-6 h-6 text-yellow-600 flex-shrink-0"}),(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)("h3",{className:`font-semibold mb-3 text-lg ${l.success?"text-green-900":"text-yellow-900"}`,children:"Káº¿t quáº£ Import"}),(0,h.jsx)("p",{className:"text-sm mb-3",children:l.message}),(0,h.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-gray-200",children:[(0,h.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"ðŸ“Š Tá»•ng hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("div",{className:"text-xl font-bold text-gray-900",children:l.statistics.totalInvoices})]}),(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-green-200",children:[(0,h.jsx)("div",{className:"text-xs text-green-600 mb-1",children:"âœ… ext_listhoadon Ä‘Ã£ táº¡o"}),(0,h.jsx)("div",{className:"text-xl font-bold text-green-700",children:l.statistics.invoicesCreated})]}),(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-blue-200",children:[(0,h.jsx)("div",{className:"text-xs text-blue-600 mb-1",children:"ðŸ“‹ ext_detailhoadon Ä‘Ã£ táº¡o"}),(0,h.jsx)("div",{className:"text-xl font-bold text-blue-700",children:l.statistics.detailsCreated})]}),l.statistics.duplicatesSkipped>0&&(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-yellow-200",children:[(0,h.jsx)("div",{className:"text-xs text-yellow-600 mb-1",children:"âš ï¸ TrÃ¹ng láº·p (bá» qua)"}),(0,h.jsx)("div",{className:"text-xl font-bold text-yellow-700",children:l.statistics.duplicatesSkipped})]}),l.statistics.validationErrors>0&&(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-red-200",children:[(0,h.jsx)("div",{className:"text-xs text-red-600 mb-1",children:"âŒ Lá»—i validation"}),(0,h.jsx)("div",{className:"text-xl font-bold text-red-700",children:l.statistics.validationErrors})]}),(0,h.jsxs)("div",{className:"bg-white p-3 rounded-md border border-gray-200",children:[(0,h.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"ðŸ“ Chi tiáº¿t trung bÃ¬nh"}),(0,h.jsx)("div",{className:"text-xl font-bold text-gray-900",children:l.statistics.invoicesCreated>0?(l.statistics.detailsCreated/l.statistics.invoicesCreated).toFixed(1):"0"})]})]})]})]})}),l.invoicesCreated&&l.invoicesCreated.length>0&&(0,h.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md",children:[(0,h.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:(0,h.jsxs)("h4",{className:"font-semibold text-gray-900",children:["ðŸ“„ Danh sÃ¡ch hÃ³a Ä‘Æ¡n Ä‘Ã£ xá»­ lÃ½ (",l.invoicesCreated.length,")"]})}),(0,h.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,h.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,h.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Tráº¡ng thÃ¡i"}),(0,h.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Sá»‘ HÄ"}),(0,h.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"KÃ½ hiá»‡u"}),(0,h.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"NgÆ°á»i bÃ¡n"}),(0,h.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"NgÆ°á»i mua"}),(0,h.jsx)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tá»•ng tiá»n"}),(0,h.jsx)("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Chi tiáº¿t"})]})}),(0,h.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.invoicesCreated.map((e,t)=>(0,h.jsxs)("tr",{className:`
                            ${"created"===e.status?"bg-green-50":""}
                            ${"duplicate"===e.status?"bg-yellow-50":""}
                            ${"error"===e.status?"bg-red-50":""}
                          `,children:[(0,h.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:["created"===e.status&&(0,h.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"âœ… ÄÃ£ táº¡o"}),"duplicate"===e.status&&(0,h.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"âš ï¸ TrÃ¹ng"}),"error"===e.status&&(0,h.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"âŒ Lá»—i"})]}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-gray-900",children:e.shdon}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-gray-600",children:e.khhdon}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-gray-600 max-w-[150px] truncate",title:e.nbten,children:e.nbten}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-gray-600 max-w-[150px] truncate",title:e.nmten,children:e.nmten}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-right text-gray-900 font-medium",children:e.tgtttbso?.toLocaleString("vi-VN")}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm text-center text-gray-600",children:e.detailsCount>0&&(0,h.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[e.detailsCount," dÃ²ng"]})})]},t))})]})})]}),l.errors&&l.errors.length>0&&(0,h.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[(0,h.jsxs)("h4",{className:"font-semibold text-red-900 mb-2",children:["Chi tiáº¿t lá»—i (",l.errors.length,")"]}),(0,h.jsx)("div",{className:"max-h-64 overflow-y-auto space-y-2",children:l.errors.map((e,t)=>(0,h.jsxs)("div",{className:"text-sm bg-white p-3 rounded border border-red-100",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 text-red-700 font-medium mb-1",children:[(0,h.jsx)(O.AlertCircle,{className:"w-4 h-4"}),"DÃ²ng ",e.row]}),(0,h.jsx)("p",{className:"text-red-600",children:e.error})]},t))})]}),l.success&&l.invoiceIds.length>0&&(0,h.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,h.jsxs)("p",{className:"text-sm text-green-700",children:["âœ… ÄÃ£ import thÃ nh cÃ´ng ",(0,h.jsx)("strong",{children:l.invoiceIds.length})," hÃ³a Ä‘Æ¡n"]})})]}),!s&&!l&&(0,h.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-4",children:[(0,h.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"HÆ°á»›ng dáº«n"}),(0,h.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-700",children:[(0,h.jsx)("li",{children:"Táº£i file máº«u Excel vÃ  Ä‘iá»n dá»¯ liá»‡u hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("li",{children:"Äáº£m báº£o cÃ¡c trÆ°á»ng báº¯t buá»™c (*) Ä‘Æ°á»£c Ä‘iá»n Ä‘áº§y Ä‘á»§"}),(0,h.jsx)("li",{children:"Chá»n file Excel Ä‘Ã£ Ä‘iá»n dá»¯ liá»‡u"}),(0,h.jsx)("li",{children:'Click "Xem trÆ°á»›c dá»¯ liá»‡u" Ä‘á»ƒ kiá»ƒm tra trÆ°á»›c khi import'}),(0,h.jsx)("li",{children:'Click "Import ngay" Ä‘á»ƒ thÃªm dá»¯ liá»‡u vÃ o há»‡ thá»‘ng'})]})]})]}),(0,h.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-4",children:[l&&(0,h.jsx)("button",{onClick:()=>{o(null),n(null),d(null),m.current&&(m.current.value="")},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Import tiáº¿p"}),(0,h.jsx)("button",{onClick:b,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"ÄÃ³ng"})]})]})})}let P=class{static STORAGE_KEY="invoice_config";static DEFAULT_CONFIG={bearerToken:"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI1OTAwNDI4OTA0IiwidHlwZSI6MiwiZXhwIjoxNzU4OTQ2MjgxLCJpYXQiOjE3NTg4NTk4ODF9.Uo17DIposfoivAM-o6BYe0gxa6YY2rIeWn1QhthrZitU6cHDFM5A70ngBeGoe1RUPz4R9_K_CjqkB3YbDhNkbA",pageSize:50,invoiceType:"banra",brandname:""};static getConfig(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(e){let t=JSON.parse(e);return{...this.DEFAULT_CONFIG,...t}}}catch(e){console.error("Error loading config from localStorage:",e)}return this.DEFAULT_CONFIG}static setConfig(e){try{let t={...this.getConfig(),...e};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){console.error("Error saving config to localStorage:",e)}}static setBearerToken(e){this.setConfig({bearerToken:e})}static setPageSize(e){this.setConfig({pageSize:e})}static setInvoiceType(e){this.setConfig({invoiceType:e,apiEndpoint:"banra"===e?"/query/invoices/sold":"/query/invoices/purchase"})}static setBrandname(e){this.setConfig({brandname:e})}static getApiEndpoint(e){let t=this.getConfig(),r=e||t.invoiceType;return t.apiEndpoint?t.apiEndpoint:"banra"===r?"/query/invoices/sold":"/query/invoices/purchase"}static resetConfig(){localStorage.removeItem(this.STORAGE_KEY)}static validateBearerToken(e){if(!e||"string"!=typeof e)return!1;let t=e.split(".");return 3===t.length&&t.every(e=>e.length>0)}static getValidatedConfig(){let e=this.getConfig();return this.validateBearerToken(e.bearerToken)||(console.warn("Invalid bearer token detected, using default"),e.bearerToken=this.DEFAULT_CONFIG.bearerToken),(!e.pageSize||e.pageSize<1||e.pageSize>1e3)&&(e.pageSize=this.DEFAULT_CONFIG.pageSize),void 0!==e.brandname&&"string"!=typeof e.brandname&&(e.brandname=this.DEFAULT_CONFIG.brandname),e}};function M(e,t){return function(){return e.apply(t,arguments)}}let{toString:_}=Object.prototype,{getPrototypeOf:B}=Object,{iterator:z,toStringTag:q}=Symbol,H=(t=Object.create(null),e=>{let r=_.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())}),V=e=>(e=e.toLowerCase(),t=>H(t)===e),K=e=>t=>typeof t===e,{isArray:Y}=Array,X=K("undefined");function W(e){return null!==e&&!X(e)&&null!==e.constructor&&!X(e.constructor)&&Q(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}let J=V("ArrayBuffer"),G=K("string"),Q=K("function"),Z=K("number"),ee=e=>null!==e&&"object"==typeof e,et=e=>{if("object"!==H(e))return!1;let t=B(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(q in e)&&!(z in e)},er=V("Date"),es=V("File"),en=V("Blob"),ea=V("FileList"),ei=V("URLSearchParams"),[el,eo,ec,ed]=["ReadableStream","Request","Response","Headers"].map(V);function eh(e,t,{allOwnKeys:r=!1}={}){let s,n;if(null!=e)if("object"!=typeof e&&(e=[e]),Y(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{let n;if(W(e))return;let a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;for(s=0;s<i;s++)n=a[s],t.call(null,e[n],n,e)}}function eu(e,t){let r;if(W(e))return null;t=t.toLowerCase();let s=Object.keys(e),n=s.length;for(;n-- >0;)if(t===(r=s[n]).toLowerCase())return r;return null}let em="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g,eg=e=>!X(e)&&e!==em,ex=(r="undefined"!=typeof Uint8Array&&B(Uint8Array),e=>r&&e instanceof r),ep=V("HTMLFormElement"),ef=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),eb=V("RegExp"),ey=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),s={};eh(r,(r,n)=>{let a;!1!==(a=t(r,n,e))&&(s[n]=a||r)}),Object.defineProperties(e,s)},ev=V("AsyncFunction"),ew=(i="function"==typeof setImmediate,l=Q(em.postMessage),i?setImmediate:l?(o=`axios@${Math.random()}`,c=[],em.addEventListener("message",({source:e,data:t})=>{e===em&&t===o&&c.length&&c.shift()()},!1),e=>{c.push(e),em.postMessage(o,"*")}):e=>setTimeout(e)),eN="undefined"!=typeof queueMicrotask?queueMicrotask.bind(em):void 0!==U.default&&U.default.nextTick||ew,ej={isArray:Y,isArrayBuffer:J,isBuffer:W,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Q(e.append)&&("formdata"===(t=H(e))||"object"===t&&Q(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&J(e.buffer)},isString:G,isNumber:Z,isBoolean:e=>!0===e||!1===e,isObject:ee,isPlainObject:et,isEmptyObject:e=>{if(!ee(e)||W(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(e){return!1}},isReadableStream:el,isRequest:eo,isResponse:ec,isHeaders:ed,isUndefined:X,isDate:er,isFile:es,isBlob:en,isRegExp:eb,isFunction:Q,isStream:e=>ee(e)&&Q(e.pipe),isURLSearchParams:ei,isTypedArray:ex,isFileList:ea,forEach:eh,merge:function e(){let{caseless:t}=eg(this)&&this||{},r={},s=(s,n)=>{let a=t&&eu(r,n)||n;et(r[a])&&et(s)?r[a]=e(r[a],s):et(s)?r[a]=e({},s):Y(s)?r[a]=s.slice():r[a]=s};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&eh(arguments[e],s);return r},extend:(e,t,r,{allOwnKeys:s}={})=>(eh(t,(t,s)=>{r&&Q(t)?e[s]=M(t,r):e[s]=t},{allOwnKeys:s}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,s)=>{let n,a,i,l={};if(t=t||{},null==e)return t;do{for(a=(n=Object.getOwnPropertyNames(e)).length;a-- >0;)i=n[a],(!s||s(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=!1!==r&&B(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype)return t},kindOf:H,kindOfTest:V,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;let s=e.indexOf(t,r);return -1!==s&&s===r},toArray:e=>{if(!e)return null;if(Y(e))return e;let t=e.length;if(!Z(t))return null;let r=Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{let r,s=(e&&e[z]).call(e);for(;(r=s.next())&&!r.done;){let s=r.value;t.call(e,s[0],s[1])}},matchAll:(e,t)=>{let r,s=[];for(;null!==(r=e.exec(t));)s.push(r);return s},isHTMLForm:ep,hasOwnProperty:ef,hasOwnProp:ef,reduceDescriptors:ey,freezeMethods:e=>{ey(e,(t,r)=>{if(Q(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;if(Q(e[r])){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},toObjectSet:(e,t)=>{let r={};return(Y(e)?e:String(e).split(t)).forEach(e=>{r[e]=!0}),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e*=1)?e:t,findKey:eu,global:em,isContextDefined:eg,isSpecCompliantForm:function(e){return!!(e&&Q(e.append)&&"FormData"===e[q]&&e[z])},toJSONObject:e=>{let t=Array(10),r=(e,s)=>{if(ee(e)){if(t.indexOf(e)>=0)return;if(W(e))return e;if(!("toJSON"in e)){t[s]=e;let n=Y(e)?[]:{};return eh(e,(e,t)=>{let a=r(e,s+1);X(a)||(n[t]=a)}),t[s]=void 0,n}}return e};return r(e,0)},isAsyncFn:ev,isThenable:e=>e&&(ee(e)||Q(e))&&Q(e.then)&&Q(e.catch),setImmediate:ew,asap:eN,isIterable:e=>null!=e&&Q(e[z])};var eT=e.i(457951);function eE(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}ej.inherits(eE,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ej.toJSONObject(this.config),code:this.code,status:this.status}}});let eS=eE.prototype,ek={};function eR(e){return ej.isPlainObject(e)||ej.isArray(e)}function eC(e){return ej.endsWith(e,"[]")?e.slice(0,-2):e}function eD(e,t,r){return e?e.concat(t).map(function(e,t){return e=eC(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ek[e]={value:e}}),Object.defineProperties(eE,ek),Object.defineProperty(eS,"isAxiosError",{value:!0}),eE.from=(e,t,r,s,n,a)=>{let i=Object.create(eS);return ej.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),eE.call(i,e.message,t,r,s,n),i.cause=e,i.name=e.name,a&&Object.assign(i,a),i};let eA=ej.toFlatObject(ej,{},null,function(e){return/^is[A-Z]/.test(e)}),eO=function(e,t,r){if(!ej.isObject(e))throw TypeError("target must be an object");t=t||new FormData;let s=(r=ej.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!ej.isUndefined(t[e])})).metaTokens,n=r.visitor||c,a=r.dots,i=r.indexes,l=(r.Blob||"undefined"!=typeof Blob&&Blob)&&ej.isSpecCompliantForm(t);if(!ej.isFunction(n))throw TypeError("visitor must be a function");function o(e){if(null===e)return"";if(ej.isDate(e))return e.toISOString();if(ej.isBoolean(e))return e.toString();if(!l&&ej.isBlob(e))throw new eE("Blob is not supported. Use a Buffer instead.");return ej.isArrayBuffer(e)||ej.isTypedArray(e)?l&&"function"==typeof Blob?new Blob([e]):eT.Buffer.from(e):e}function c(e,r,n){let l=e;if(e&&!n&&"object"==typeof e)if(ej.endsWith(r,"{}"))r=s?r:r.slice(0,-2),e=JSON.stringify(e);else{var c;if(ej.isArray(e)&&(c=e,ej.isArray(c)&&!c.some(eR))||(ej.isFileList(e)||ej.endsWith(r,"[]"))&&(l=ej.toArray(e)))return r=eC(r),l.forEach(function(e,s){ej.isUndefined(e)||null===e||t.append(!0===i?eD([r],s,a):null===i?r:r+"[]",o(e))}),!1}return!!eR(e)||(t.append(eD(n,r,a),o(e)),!1)}let d=[],h=Object.assign(eA,{defaultVisitor:c,convertValue:o,isVisitable:eR});if(!ej.isObject(e))throw TypeError("data must be an object");return!function e(r,s){if(!ej.isUndefined(r)){if(-1!==d.indexOf(r))throw Error("Circular reference detected in "+s.join("."));d.push(r),ej.forEach(r,function(r,a){!0===(!(ej.isUndefined(r)||null===r)&&n.call(t,r,ej.isString(a)?a.trim():a,s,h))&&e(r,s?s.concat(a):[a])}),d.pop()}}(e),t};function eI(e){let t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function e$(e,t){this._pairs=[],e&&eO(e,this,t)}let eU=e$.prototype;function eL(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function eF(e,t,r){let s;if(!t)return e;let n=r&&r.encode||eL;ej.isFunction(r)&&(r={serialize:r});let a=r&&r.serialize;if(s=a?a(t,r):ej.isURLSearchParams(t)?t.toString():new e$(t,r).toString(n)){let t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}eU.append=function(e,t){this._pairs.push([e,t])},eU.toString=function(e){let t=e?function(t){return e.call(this,t,eI)}:eI;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};let eP=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ej.forEach(this.handlers,function(t){null!==t&&e(t)})}},eM={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},e_="undefined"!=typeof URLSearchParams?URLSearchParams:e$,eB="undefined"!=typeof FormData?FormData:null,ez="undefined"!=typeof Blob?Blob:null,eq="undefined"!=typeof window&&"undefined"!=typeof document,eH="object"==typeof navigator&&navigator||void 0,eV=eq&&(!eH||0>["ReactNative","NativeScript","NS"].indexOf(eH.product)),eK="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,eY=eq&&window.location.href||"http://localhost";e.s(["hasBrowserEnv",()=>eq,"hasStandardBrowserEnv",()=>eV,"hasStandardBrowserWebWorkerEnv",()=>eK,"navigator",()=>eH,"origin",()=>eY],744959);let eX={...e.i(744959),isBrowser:!0,classes:{URLSearchParams:e_,FormData:eB,Blob:ez},protocols:["http","https","file","blob","url","data"]},eW=function(e){if(ej.isFormData(e)&&ej.isFunction(e.entries)){let t={};return ej.forEachEntry(e,(e,r)=>{!function e(t,r,s,n){let a=t[n++];if("__proto__"===a)return!0;let i=Number.isFinite(+a),l=n>=t.length;return(a=!a&&ej.isArray(s)?s.length:a,l)?ej.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r:(s[a]&&ej.isObject(s[a])||(s[a]=[]),e(t,r,s[a],n)&&ej.isArray(s[a])&&(s[a]=function(e){let t,r,s={},n=Object.keys(e),a=n.length;for(t=0;t<a;t++)s[r=n[t]]=e[r];return s}(s[a]))),!i}(ej.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0]),r,t,0)}),t}return null},eJ={transitional:eM,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){let r,s=t.getContentType()||"",n=s.indexOf("application/json")>-1,a=ej.isObject(e);if(a&&ej.isHTMLForm(e)&&(e=new FormData(e)),ej.isFormData(e))return n?JSON.stringify(eW(e)):e;if(ej.isArrayBuffer(e)||ej.isBuffer(e)||ej.isStream(e)||ej.isFile(e)||ej.isBlob(e)||ej.isReadableStream(e))return e;if(ej.isArrayBufferView(e))return e.buffer;if(ej.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1){var i,l;return(i=e,l=this.formSerializer,eO(i,new eX.classes.URLSearchParams,{visitor:function(e,t,r,s){return eX.isNode&&ej.isBuffer(e)?(this.append(t,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...l})).toString()}if((r=ej.isFileList(e))||s.indexOf("multipart/form-data")>-1){let t=this.env&&this.env.FormData;return eO(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}if(a||n){t.setContentType("application/json",!1);var o=e;if(ej.isString(o))try{return(0,JSON.parse)(o),ej.trim(o)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(o)}return e}],transformResponse:[function(e){let t=this.transitional||eJ.transitional,r=t&&t.forcedJSONParsing,s="json"===this.responseType;if(ej.isResponse(e)||ej.isReadableStream(e))return e;if(e&&ej.isString(e)&&(r&&!this.responseType||s)){let r=t&&t.silentJSONParsing;try{return JSON.parse(e)}catch(e){if(!r&&s){if("SyntaxError"===e.name)throw eE.from(e,eE.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:eX.classes.FormData,Blob:eX.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ej.forEach(["delete","get","head","post","put","patch"],e=>{eJ.headers[e]={}});let eG=ej.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eQ=Symbol("internals");function eZ(e){return e&&String(e).trim().toLowerCase()}function e0(e){return!1===e||null==e?e:ej.isArray(e)?e.map(e0):String(e)}function e1(e,t,r,s,n){if(ej.isFunction(s))return s.call(this,t,r);if(n&&(t=r),ej.isString(t)){if(ej.isString(s))return -1!==t.indexOf(s);if(ej.isRegExp(s))return s.test(t)}}class e2{constructor(e){e&&this.set(e)}set(e,t,r){let s=this;function n(e,t,r){let n=eZ(t);if(!n)throw Error("header name must be a non-empty string");let a=ej.findKey(s,n);a&&void 0!==s[a]&&!0!==r&&(void 0!==r||!1===s[a])||(s[a||t]=e0(e))}let a=(e,t)=>ej.forEach(e,(e,r)=>n(e,r,t));if(ej.isPlainObject(e)||e instanceof this.constructor)a(e,t);else{let s;if(ej.isString(e)&&(e=e.trim())&&(s=e,!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim()))){var i;let r,s,n,l;a((l={},(i=e)&&i.split("\n").forEach(function(e){n=e.indexOf(":"),r=e.substring(0,n).trim().toLowerCase(),s=e.substring(n+1).trim(),!r||l[r]&&eG[r]||("set-cookie"===r?l[r]?l[r].push(s):l[r]=[s]:l[r]=l[r]?l[r]+", "+s:s)}),l),t)}else if(ej.isObject(e)&&ej.isIterable(e)){let r={},s,n;for(let t of e){if(!ej.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[n=t[0]]=(s=r[n])?ej.isArray(s)?[...s,t[1]]:[s,t[1]]:t[1]}a(r,t)}else null!=e&&n(t,e,r)}return this}get(e,t){if(e=eZ(e)){let r=ej.findKey(this,e);if(r){let e=this[r];if(!t)return e;if(!0===t){let t,r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;for(;t=s.exec(e);)r[t[1]]=t[2];return r}if(ej.isFunction(t))return t.call(this,e,r);if(ej.isRegExp(t))return t.exec(e);throw TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=eZ(e)){let r=ej.findKey(this,e);return!!(r&&void 0!==this[r]&&(!t||e1(this,this[r],r,t)))}return!1}delete(e,t){let r=this,s=!1;function n(e){if(e=eZ(e)){let n=ej.findKey(r,e);n&&(!t||e1(r,r[n],n,t))&&(delete r[n],s=!0)}}return ej.isArray(e)?e.forEach(n):n(e),s}clear(e){let t=Object.keys(this),r=t.length,s=!1;for(;r--;){let n=t[r];(!e||e1(this,this[n],n,e,!0))&&(delete this[n],s=!0)}return s}normalize(e){let t=this,r={};return ej.forEach(this,(s,n)=>{let a=ej.findKey(r,n);if(a){t[a]=e0(s),delete t[n];return}let i=e?n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r):String(n).trim();i!==n&&delete t[n],t[i]=e0(s),r[i]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return ej.forEach(this,(r,s)=>{null!=r&&!1!==r&&(t[s]=e&&ej.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let r=new this(e);return t.forEach(e=>r.set(e)),r}static accessor(e){let t=(this[eQ]=this[eQ]={accessors:{}}).accessors,r=this.prototype;function s(e){let s=eZ(e);if(!t[s]){let n;n=ej.toCamelCase(" "+e),["get","set","has"].forEach(t=>{Object.defineProperty(r,t+n,{value:function(r,s,n){return this[t].call(this,e,r,s,n)},configurable:!0})}),t[s]=!0}}return ej.isArray(e)?e.forEach(s):s(e),this}}function e4(e,t){let r=this||eJ,s=t||r,n=e2.from(s.headers),a=s.data;return ej.forEach(e,function(e){a=e.call(r,a,n.normalize(),t?t.status:void 0)}),n.normalize(),a}function e5(e){return!!(e&&e.__CANCEL__)}function e3(e,t,r){eE.call(this,null==e?"canceled":e,eE.ERR_CANCELED,t,r),this.name="CanceledError"}function e6(e,t,r){let s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new eE("Request failed with status code "+r.status,[eE.ERR_BAD_REQUEST,eE.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}e2.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ej.reduceDescriptors(e2.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[r]=e}}}),ej.freezeMethods(e2),ej.inherits(e3,eE,{__CANCEL__:!0});let e9=function(e,t){let r,s=Array(e=e||10),n=Array(e),a=0,i=0;return t=void 0!==t?t:1e3,function(l){let o=Date.now(),c=n[i];r||(r=o),s[a]=l,n[a]=o;let d=i,h=0;for(;d!==a;)h+=s[d++],d%=e;if((a=(a+1)%e)===i&&(i=(i+1)%e),o-r<t)return;let u=c&&o-c;return u?Math.round(1e3*h/u):void 0}},e7=function(e,t){let r,s,n=0,a=1e3/t,i=(t,a=Date.now())=>{n=a,r=null,s&&(clearTimeout(s),s=null),e(...t)};return[(...e)=>{let t=Date.now(),l=t-n;l>=a?i(e,t):(r=e,s||(s=setTimeout(()=>{s=null,i(r)},a-l)))},()=>r&&i(r)]},e8=(e,t,r=3)=>{let s=0,n=e9(50,250);return e7(r=>{let a=r.loaded,i=r.lengthComputable?r.total:void 0,l=a-s,o=n(l);s=a,e({loaded:a,total:i,progress:i?a/i:void 0,bytes:l,rate:o||void 0,estimated:o&&i&&a<=i?(i-a)/o:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},te=(e,t)=>{let r=null!=e;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},tt=e=>(...t)=>ej.asap(()=>e(...t)),tr=eX.hasStandardBrowserEnv?(s=new URL(eX.origin),n=eX.navigator&&/(msie|trident)/i.test(eX.navigator.userAgent),e=>(e=new URL(e,eX.origin),s.protocol===e.protocol&&s.host===e.host&&(n||s.port===e.port))):()=>!0,ts=eX.hasStandardBrowserEnv?{write(e,t,r,s,n,a){let i=[e+"="+encodeURIComponent(t)];ej.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),ej.isString(s)&&i.push("path="+s),ej.isString(n)&&i.push("domain="+n),!0===a&&i.push("secure"),document.cookie=i.join("; ")},read(e){let t=document.cookie.match(RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function tn(e,t,r){let s=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(s||!1==r)?t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e:t}let ta=e=>e instanceof e2?{...e}:e;function ti(e,t){t=t||{};let r={};function s(e,t,r,s){return ej.isPlainObject(e)&&ej.isPlainObject(t)?ej.merge.call({caseless:s},e,t):ej.isPlainObject(t)?ej.merge({},t):ej.isArray(t)?t.slice():t}function n(e,t,r,n){return ej.isUndefined(t)?ej.isUndefined(e)?void 0:s(void 0,e,r,n):s(e,t,r,n)}function a(e,t){if(!ej.isUndefined(t))return s(void 0,t)}function i(e,t){return ej.isUndefined(t)?ej.isUndefined(e)?void 0:s(void 0,e):s(void 0,t)}function l(r,n,a){return a in t?s(r,n):a in e?s(void 0,r):void 0}let o={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(e,t,r)=>n(ta(e),ta(t),r,!0)};return ej.forEach(Object.keys({...e,...t}),function(s){let a=o[s]||n,i=a(e[s],t[s],s);ej.isUndefined(i)&&a!==l||(r[s]=i)}),r}let tl=e=>{let t,r=ti({},e),{data:s,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:l,auth:o}=r;if(r.headers=l=e2.from(l),r.url=eF(tn(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ej.isFormData(s)){if(eX.hasStandardBrowserEnv||eX.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(!1!==(t=l.getContentType())){let[e,...r]=t?t.split(";").map(e=>e.trim()).filter(Boolean):[];l.setContentType([e||"multipart/form-data",...r].join("; "))}}if(eX.hasStandardBrowserEnv&&(n&&ej.isFunction(n)&&(n=n(r)),n||!1!==n&&tr(r.url))){let e=a&&i&&ts.read(i);e&&l.set(a,e)}return r},to="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){var s;let n,a,i,l,o,c,d=tl(e),h=d.data,u=e2.from(d.headers).normalize(),{responseType:m,onUploadProgress:g,onDownloadProgress:x}=d;function p(){l&&l(),o&&o(),d.cancelToken&&d.cancelToken.unsubscribe(n),d.signal&&d.signal.removeEventListener("abort",n)}let f=new XMLHttpRequest;function b(){if(!f)return;let s=e2.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());e6(function(e){t(e),p()},function(e){r(e),p()},{data:m&&"text"!==m&&"json"!==m?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:s,config:e,request:f}),f=null}f.open(d.method.toUpperCase(),d.url,!0),f.timeout=d.timeout,"onloadend"in f?f.onloadend=b:f.onreadystatechange=function(){!f||4!==f.readyState||(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(b)},f.onabort=function(){f&&(r(new eE("Request aborted",eE.ECONNABORTED,e,f)),f=null)},f.onerror=function(){r(new eE("Network Error",eE.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let t=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",s=d.transitional||eM;d.timeoutErrorMessage&&(t=d.timeoutErrorMessage),r(new eE(t,s.clarifyTimeoutError?eE.ETIMEDOUT:eE.ECONNABORTED,e,f)),f=null},void 0===h&&u.setContentType(null),"setRequestHeader"in f&&ej.forEach(u.toJSON(),function(e,t){f.setRequestHeader(t,e)}),ej.isUndefined(d.withCredentials)||(f.withCredentials=!!d.withCredentials),m&&"json"!==m&&(f.responseType=d.responseType),x&&([i,o]=e8(x,!0),f.addEventListener("progress",i)),g&&f.upload&&([a,l]=e8(g),f.upload.addEventListener("progress",a),f.upload.addEventListener("loadend",l)),(d.cancelToken||d.signal)&&(n=t=>{f&&(r(!t||t.type?new e3(null,e,f):t),f.abort(),f=null)},d.cancelToken&&d.cancelToken.subscribe(n),d.signal&&(d.signal.aborted?n():d.signal.addEventListener("abort",n)));let y=(s=d.url,(c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s))&&c[1]||"");y&&-1===eX.protocols.indexOf(y)?r(new eE("Unsupported protocol "+y+":",eE.ERR_BAD_REQUEST,e)):f.send(h||null)})},tc=function*(e,t){let r,s=e.byteLength;if(!t||s<t)return void(yield e);let n=0;for(;n<s;)r=n+t,yield e.slice(n,r),n=r},td=async function*(e,t){for await(let r of th(e))yield*tc(r,t)},th=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);let t=e.getReader();try{for(;;){let{done:e,value:r}=await t.read();if(e)break;yield r}}finally{await t.cancel()}},tu=(e,t,r,s)=>{let n,a=td(e,t),i=0,l=e=>{!n&&(n=!0,s&&s(e))};return new ReadableStream({async pull(e){try{let{done:t,value:s}=await a.next();if(t){l(),e.close();return}let n=s.byteLength;if(r){let e=i+=n;r(e)}e.enqueue(new Uint8Array(s))}catch(e){throw l(e),e}},cancel:e=>(l(e),a.return())},{highWaterMark:2})},tm="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,tg=tm&&"function"==typeof ReadableStream,tx=tm&&("function"==typeof TextEncoder?(a=new TextEncoder,e=>a.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer())),tp=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},tf=tg&&tp(()=>{let e=!1,t=new Request(eX.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),tb=tg&&tp(()=>ej.isReadableStream(new Response("").body)),ty={stream:tb&&(e=>e.body)};tm&&(d=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{ty[e]||(ty[e]=ej.isFunction(d[e])?t=>t[e]():(t,r)=>{throw new eE(`Response type '${e}' is not supported`,eE.ERR_NOT_SUPPORT,r)})}));let tv=async e=>{if(null==e)return 0;if(ej.isBlob(e))return e.size;if(ej.isSpecCompliantForm(e)){let t=new Request(eX.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return ej.isArrayBufferView(e)||ej.isArrayBuffer(e)?e.byteLength:(ej.isURLSearchParams(e)&&(e+=""),ej.isString(e))?(await tx(e)).byteLength:void 0},tw=async(e,t)=>{let r=ej.toFiniteNumber(e.getContentLength());return null==r?tv(t):r},tN={http:null,xhr:to,fetch:tm&&(async e=>{let t,r,{url:s,method:n,data:a,signal:i,cancelToken:l,timeout:o,onDownloadProgress:c,onUploadProgress:d,responseType:h,headers:u,withCredentials:m="same-origin",fetchOptions:g}=tl(e);h=h?(h+"").toLowerCase():"text";let x=((e,t)=>{let{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,s=new AbortController,n=function(e){if(!r){r=!0,i();let t=e instanceof Error?e:this.reason;s.abort(t instanceof eE?t:new e3(t instanceof Error?t.message:t))}},a=t&&setTimeout(()=>{a=null,n(new eE(`timeout ${t} of ms exceeded`,eE.ETIMEDOUT))},t),i=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(n):e.removeEventListener("abort",n)}),e=null)};e.forEach(e=>e.addEventListener("abort",n));let{signal:l}=s;return l.unsubscribe=()=>ej.asap(i),l}})([i,l&&l.toAbortSignal()],o),p=x&&x.unsubscribe&&(()=>{x.unsubscribe()});try{if(d&&tf&&"get"!==n&&"head"!==n&&0!==(r=await tw(u,a))){let e,t=new Request(s,{method:"POST",body:a,duplex:"half"});if(ej.isFormData(a)&&(e=t.headers.get("content-type"))&&u.setContentType(e),t.body){let[e,s]=te(r,e8(tt(d)));a=tu(t.body,65536,e,s)}}ej.isString(m)||(m=m?"include":"omit");let i="credentials"in Request.prototype;t=new Request(s,{...g,signal:x,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:a,duplex:"half",credentials:i?m:void 0});let l=await fetch(t,g),o=tb&&("stream"===h||"response"===h);if(tb&&(c||o&&p)){let e={};["status","statusText","headers"].forEach(t=>{e[t]=l[t]});let t=ej.toFiniteNumber(l.headers.get("content-length")),[r,s]=c&&te(t,e8(tt(c),!0))||[];l=new Response(tu(l.body,65536,r,()=>{s&&s(),p&&p()}),e)}h=h||"text";let f=await ty[ej.findKey(ty,h)||"text"](l,e);return!o&&p&&p(),await new Promise((r,s)=>{e6(r,s,{data:f,headers:e2.from(l.headers),status:l.status,statusText:l.statusText,config:e,request:t})})}catch(r){if(p&&p(),r&&"TypeError"===r.name&&/Load failed|fetch/i.test(r.message))throw Object.assign(new eE("Network Error",eE.ERR_NETWORK,e,t),{cause:r.cause||r});throw eE.from(r,r&&r.code,e,t)}})};ej.forEach(tN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});let tj=e=>`- ${e}`,tT=e=>ej.isFunction(e)||null===e||!1===e,tE=e=>{let t,r,{length:s}=e=ej.isArray(e)?e:[e],n={};for(let a=0;a<s;a++){let s;if(r=t=e[a],!tT(t)&&void 0===(r=tN[(s=String(t)).toLowerCase()]))throw new eE(`Unknown adapter '${s}'`);if(r)break;n[s||"#"+a]=r}if(!r){let e=Object.entries(n).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));throw new eE("There is no suitable adapter to dispatch the request "+(s?e.length>1?"since :\n"+e.map(tj).join("\n"):" "+tj(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r};function tS(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new e3(null,e)}function tk(e){return tS(e),e.headers=e2.from(e.headers),e.data=e4.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),tE(e.adapter||eJ.adapter)(e).then(function(t){return tS(e),t.data=e4.call(e,e.transformResponse,t),t.headers=e2.from(t.headers),t},function(t){return!e5(t)&&(tS(e),t&&t.response&&(t.response.data=e4.call(e,e.transformResponse,t.response),t.response.headers=e2.from(t.response.headers))),Promise.reject(t)})}let tR="1.11.0",tC={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{tC[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});let tD={};tC.transitional=function(e,t,r){function s(e,t){return"[Axios v"+tR+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,n,a)=>{if(!1===e)throw new eE(s(n," has been removed"+(t?" in "+t:"")),eE.ERR_DEPRECATED);return t&&!tD[n]&&(tD[n]=!0,console.warn(s(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},tC.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};let tA=function(e,t,r){if("object"!=typeof e)throw new eE("options must be an object",eE.ERR_BAD_OPTION_VALUE);let s=Object.keys(e),n=s.length;for(;n-- >0;){let a=s[n],i=t[a];if(i){let t=e[a],r=void 0===t||i(t,a,e);if(!0!==r)throw new eE("option "+a+" must be "+r,eE.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new eE("Unknown option "+a,eE.ERR_BAD_OPTION)}};class tO{constructor(e){this.defaults=e||{},this.interceptors={request:new eP,response:new eP}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=Error();let r=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?r&&!String(e.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+r):e.stack=r}catch(e){}}throw e}}_request(e,t){let r,s;"string"==typeof e?(t=t||{}).url=e:t=e||{};let{transitional:n,paramsSerializer:a,headers:i}=t=ti(this.defaults,t);void 0!==n&&tA(n,{silentJSONParsing:tC.transitional(tC.boolean),forcedJSONParsing:tC.transitional(tC.boolean),clarifyTimeoutError:tC.transitional(tC.boolean)},!1),null!=a&&(ej.isFunction(a)?t.paramsSerializer={serialize:a}:tA(a,{encode:tC.function,serialize:tC.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),tA(t,{baseUrl:tC.spelling("baseURL"),withXsrfToken:tC.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=i&&ej.merge(i.common,i[t.method]);i&&ej.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=e2.concat(l,i);let o=[],c=!0;this.interceptors.request.forEach(function(e){("function"!=typeof e.runWhen||!1!==e.runWhen(t))&&(c=c&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});let d=[];this.interceptors.response.forEach(function(e){d.push(e.fulfilled,e.rejected)});let h=0;if(!c){let e=[tk.bind(this),void 0];for(e.unshift(...o),e.push(...d),s=e.length,r=Promise.resolve(t);h<s;)r=r.then(e[h++],e[h++]);return r}s=o.length;let u=t;for(h=0;h<s;){let e=o[h++],t=o[h++];try{u=e(u)}catch(e){t.call(this,e);break}}try{r=tk.call(this,u)}catch(e){return Promise.reject(e)}for(h=0,s=d.length;h<s;)r=r.then(d[h++],d[h++]);return r}getUri(e){return eF(tn((e=ti(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}ej.forEach(["delete","get","head","options"],function(e){tO.prototype[e]=function(t,r){return this.request(ti(r||{},{method:e,url:t,data:(r||{}).data}))}}),ej.forEach(["post","put","patch"],function(e){function t(t){return function(r,s,n){return this.request(ti(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:s}))}}tO.prototype[e]=t(),tO.prototype[e+"Form"]=t(!0)});class tI{constructor(e){let t;if("function"!=typeof e)throw TypeError("executor must be a function.");this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t,s=new Promise(e=>{r.subscribe(e),t=e}).then(e);return s.cancel=function(){r.unsubscribe(t)},s},e(function(e,s,n){r.reason||(r.reason=new e3(e,s,n),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){let e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new tI(function(t){e=t}),cancel:e}}}let t$={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(t$).forEach(([e,t])=>{t$[t]=e});let tU=function e(t){let r=new tO(t),s=M(tO.prototype.request,r);return ej.extend(s,tO.prototype,r,{allOwnKeys:!0}),ej.extend(s,r,null,{allOwnKeys:!0}),s.create=function(r){return e(ti(t,r))},s}(eJ);tU.Axios=tO,tU.CanceledError=e3,tU.CancelToken=tI,tU.isCancel=e5,tU.VERSION=tR,tU.toFormData=eO,tU.AxiosError=eE,tU.Cancel=tU.CanceledError,tU.all=function(e){return Promise.all(e)},tU.spread=function(e){return function(t){return e.apply(null,t)}},tU.isAxiosError=function(e){return ej.isObject(e)&&!0===e.isAxiosError},tU.mergeConfig=ti,tU.AxiosHeaders=e2,tU.formToJSON=e=>eW(ej.isHTMLForm(e)?new FormData(e):e),tU.getAdapter=tE,tU.HttpStatusCode=t$,tU.default=tU;let tL=class{static getMonthDateRange(e,t){if(e<1||e>12)throw Error("ThÃ¡ng pháº£i tá»« 1 Ä‘áº¿n 12");if(t<1900||t>new Date().getFullYear()+10)throw Error("NÄƒm khÃ´ng há»£p lá»‡");let r=new Date(t,e-1,1),s=new Date(t,e,0);return{fromDate:this.formatDate(r),toDate:this.formatDate(s)}}static formatDate(e){let t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getFullYear();return`${t}/${r}/${s}`}static parseDate(e){let[t,r,s]=e.split("/").map(Number);return new Date(s,r-1,t)}static getCurrentMonthYear(){let e=new Date;return{month:e.getMonth()+1,year:e.getFullYear()}}static getPreviousMonthYear(){let e=new Date,t=e.getMonth(),r=e.getFullYear();return 0===t&&(t=12,r-=1),{month:t,year:r}}static getMonthName(e){return e<1||e>12?"ThÃ¡ng khÃ´ng há»£p lá»‡":["ThÃ¡ng 1","ThÃ¡ng 2","ThÃ¡ng 3","ThÃ¡ng 4","ThÃ¡ng 5","ThÃ¡ng 6","ThÃ¡ng 7","ThÃ¡ng 8","ThÃ¡ng 9","ThÃ¡ng 10","ThÃ¡ng 11","ThÃ¡ng 12"][e-1]}static getMonthOptions(){return Array.from({length:12},(e,t)=>({value:t+1,label:this.getMonthName(t+1)}))}static getYearOptions(){let e=new Date().getFullYear(),t=[];for(let r=e-10;r<=e+2;r++)t.push({value:r,label:r.toString()});return t.reverse()}static validateDateRange(e,t){try{let r=this.parseDate(e),s=this.parseDate(t),n=new Date;if(r>s)return{isValid:!1,error:"NgÃ y báº¯t Ä‘áº§u khÃ´ng thá»ƒ lá»›n hÆ¡n ngÃ y káº¿t thÃºc"};if(s>n)return{isValid:!1,error:"NgÃ y káº¿t thÃºc khÃ´ng thá»ƒ lá»›n hÆ¡n ngÃ y hiá»‡n táº¡i"};if(Math.ceil((s.getTime()-r.getTime())/864e5)>365)return{isValid:!1,error:"Khoáº£ng thá»i gian khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ 365 ngÃ y"};return{isValid:!0}}catch(e){return{isValid:!1,error:"Äá»‹nh dáº¡ng ngÃ y khÃ´ng há»£p lá»‡ 123"}}}static getDateRangeOptions(){let e=new Date,t=e.getMonth()+1,r=e.getFullYear();return[{value:"current_month",label:"ThÃ¡ng nÃ y",getData:()=>this.getMonthDateRange(t,r)},{value:"previous_month",label:"ThÃ¡ng trÆ°á»›c",getData:()=>{let{month:e,year:t}=this.getPreviousMonthYear();return this.getMonthDateRange(e,t)}},{value:"last_3_months",label:"3 thÃ¡ng gáº§n nháº¥t",getData:()=>{let t=new Date;return t.setMonth(t.getMonth()-3),{fromDate:this.formatDate(t),toDate:this.formatDate(e)}}},{value:"last_6_months",label:"6 thÃ¡ng gáº§n nháº¥t",getData:()=>{let t=new Date;return t.setMonth(t.getMonth()-6),{fromDate:this.formatDate(t),toDate:this.formatDate(e)}}}]}},tF=class{static BASE_URL="https://hoadondientu.gdt.gov.vn:30000";static createAxiosInstance(){let e=P.getValidatedConfig();return tU.create({baseURL:this.BASE_URL,headers:{Authorization:`Bearer ${e.bearerToken}`,"Content-Type":"application/json",Accept:"application/json"},timeout:3e4})}static buildSearchQuery(e){let t=[],r=e.fromDate,s=e.toDate;if(e.month&&e.year){let t=tL.getMonthDateRange(e.month,e.year);r=t.fromDate,s=t.toDate}if(r&&t.push(`tdlap=ge=${r}T00:00:00`),s&&t.push(`tdlap=le=${s}T23:59:59`),e.invoiceNumber&&t.push(`shdon=like=${encodeURIComponent(e.invoiceNumber)}`),e.taxCode&&t.push(`msttcgp=like=${encodeURIComponent(e.taxCode)}`),e.buyerName&&t.push(`tenxmua=like=${encodeURIComponent(e.buyerName)}`),e.globalSearch){let r=encodeURIComponent(e.globalSearch);t.push(`(shdon=like=${r};tenxmua=like=${r};msttcgp=like=${r})`)}return e.amountFrom&&t.push(`tgtttbso=ge=${e.amountFrom}`),e.amountTo&&t.push(`tgtttbso=le=${e.amountTo}`),e.status&&t.push(`tghdon=like=${encodeURIComponent(e.status)}`),t.join(";")}static rateLimitQueue=[];static isProcessingQueue=!1;static lastRequestTime=0;static MIN_REQUEST_INTERVAL=1e3;static MAX_RETRIES=3;static RETRY_DELAYS=[2e3,5e3,1e4];static async processQueue(){if(!this.isProcessingQueue&&0!==this.rateLimitQueue.length){for(this.isProcessingQueue=!0;this.rateLimitQueue.length>0;){let e=Date.now()-this.lastRequestTime;if(e<this.MIN_REQUEST_INTERVAL){let t=this.MIN_REQUEST_INTERVAL-e;await new Promise(e=>setTimeout(e,t))}let t=this.rateLimitQueue.shift();if(t)try{this.lastRequestTime=Date.now(),await t()}catch(e){console.error("Queue request failed:",e)}}this.isProcessingQueue=!1}}static async executeWithRetry(e,t=0){try{return await e()}catch(r){if(tU.isAxiosError(r)){let s=r.response?.status;if((409===s||429===s)&&t<this.MAX_RETRIES){let r=this.RETRY_DELAYS[t]||1e4;return console.warn(`âš ï¸ Rate limit hit (${s}), retrying in ${r}ms... (attempt ${t+1}/${this.MAX_RETRIES})`),await new Promise(e=>setTimeout(e,r)),this.executeWithRetry(e,t+1)}if(503===s&&t<this.MAX_RETRIES){let r=Math.min(15e3*(t+1),6e4);return console.warn(`âš ï¸ Server overload (503), retrying in ${r}ms... (attempt ${t+1}/${this.MAX_RETRIES})`),await new Promise(e=>setTimeout(e,r)),this.executeWithRetry(e,t+1)}}throw r}}static async fetchInvoices(e,t={},r){let s=async()=>{let s=this.createAxiosInstance(),n=P.getValidatedConfig(),a=this.buildSearchQuery(e),i=P.getApiEndpoint(r),l=new URLSearchParams({sort:t.sort||"tdlap:desc,khmshdon:asc,shdon:desc",size:(t.size||n.pageSize).toString(),page:(t.page||0).toString(),...a&&{search:a},...t.state&&{state:t.state}});return console.log(`ðŸ”„ Fetching invoices: ${i}?${l.toString().substring(0,100)}...`),(await s.get(`${i}?${l.toString()}`)).data};try{let n=await this.executeWithRetry(s);if(n.total&&n.total>50&&n.state&&!t.state)return console.log(`ðŸ“Š Total records: ${n.total}, initiating controlled pagination...`),await this.fetchAllInvoices(e,t,r,n);return n}catch(e){if(console.error("âŒ Error fetching invoice data:",e),tU.isAxiosError(e)){let t=e.response?.status;if(401===t)throw Error("Token xÃ¡c thá»±c khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ háº¿t háº¡n. Vui lÃ²ng cáº­p nháº­t token trong cáº¥u hÃ¬nh.");if(403===t)throw Error("KhÃ´ng cÃ³ quyá»n truy cáº­p dá»¯ liá»‡u hÃ³a Ä‘Æ¡n");if(404===t)throw Error("Endpoint API khÃ´ng tá»“n táº¡i");else if(409===t)throw Error("Server Ä‘ang quÃ¡ táº£i. Vui lÃ²ng thá»­ láº¡i sau Ã­t phÃºt.");else if(429===t)throw Error("ÄÃ£ vÆ°á»£t quÃ¡ giá»›i háº¡n sá»‘ láº§n gá»i API. Vui lÃ²ng thá»­ láº¡i sau.");else if(503===t)throw Error("Dá»‹ch vá»¥ táº¡m thá»i khÃ´ng kháº£ dá»¥ng. Vui lÃ²ng thá»­ láº¡i sau.");else if("ECONNABORTED"===e.code)throw Error("Káº¿t ná»‘i timeout, vui lÃ²ng thá»­ láº¡i");else if(t&&t>=500)throw Error("Lá»—i há»‡ thá»‘ng phÃ­a server, vui lÃ²ng thá»­ láº¡i sau")}throw Error("KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u hÃ³a Ä‘Æ¡n. Vui lÃ²ng kiá»ƒm tra káº¿t ná»‘i internet vÃ  thá»­ láº¡i.")}}static async fetchAllInvoices(e,t,r,s){let n=[],a=s?.state,i=0,l=s?.total||0,o=1,c=0;s?.datas&&(n.push(...s.datas),i=s.datas.length),console.log(`ðŸ”„ Starting controlled pagination: ${i}/${l} records (${Math.ceil(l/50)} estimated pages)`);let d=l>1e3?2e3:l>500?1500:1e3;for(console.log(`â±ï¸ Using ${d}ms base delay between requests to prevent server overload`);a&&i<l;)try{let s=a.length>50?`${a.substring(0,50)}...`:a;console.log(`ðŸ“„ Fetching page ${o+1}/${Math.ceil(l/50)} with state: ${s}`);let h=d+1e3*c;o>1&&await new Promise(e=>setTimeout(e,h));let u=await this.fetchInvoices(e,{...t,state:a},r);if(c=0,u.datas&&u.datas.length>0){n.push(...u.datas),i+=u.datas.length;let e=Math.round(i/l*100);console.log(`âœ… Page ${o+1}/${Math.ceil(l/50)}: ${u.datas.length} records | Total: ${i}/${l} (${e}%)`)}else console.log(`âš ï¸ Page ${o+1}: No data returned`);if(a=u.state,o++,!a){console.log("ðŸ No more state token, pagination complete");break}if(i>=l){console.log("ðŸŽ¯ Reached total record count, stopping pagination");break}if(o>200){console.warn("âš ï¸ Exceeded 200 pages, stopping pagination for safety");break}}catch(e){if(c++,console.error(`âŒ Error during pagination fetch (page ${o+1}), consecutive errors: ${c}:`,e),c>=3){console.error(`ðŸ’¥ Too many consecutive errors (${c}), stopping pagination`);break}if(tU.isAxiosError(e)&&(e.response?.status===409||e.response?.status===429)){let e=Math.min(3e4,5e3*c);console.warn(`â³ Rate limit error, waiting ${e}ms before continuing...`),await new Promise(t=>setTimeout(t,e))}else await new Promise(e=>setTimeout(e,3e3))}let h=Math.round(n.length/l*100);return console.log(`ðŸŽ‰ Controlled pagination complete: fetched ${n.length} records out of ${l} total (${h}% success rate)`),{datas:n,totalElements:l,totalPages:Math.ceil(l/(t.size||50)),size:n.length,number:0,numberOfElements:n.length,first:!0,last:!0,total:l,state:void 0}}static async fetchInvoicesWithProgress(e,t={},r,s){let n=await this.fetchInvoices(e,t,r);if(!n.total||n.total<=50||!n.state)return s?.(n.datas.length,n.total||n.datas.length,100),n;console.log(`ðŸš€ Starting progress-tracked pagination for ${n.total} records`);let a=[],i=n.state,l=0,o=n.total,c=0,d=o>1e3?2e3:o>500?1500:1e3;for(n.datas&&(a.push(...n.datas),l=n.datas.length,s?.(l,o,Math.round(l/o*100)));i&&l<o&&c<3;)try{let n=d+1e3*c;await new Promise(e=>setTimeout(e,n));let h=await this.fetchInvoices(e,{...t,state:i},r);if(c=0,h.datas&&h.datas.length>0){a.push(...h.datas),l+=h.datas.length;let e=Math.round(l/o*100);s?.(l,o,e)}if(!(i=h.state)||l>=o)break}catch(e){if(c++,console.error(`âŒ Error during progress fetch (attempt ${c}/3):`,e),s?.(l,o,Math.round(l/o*100)),tU.isAxiosError(e)&&(e.response?.status===409||e.response?.status===429)){let e=Math.min(3e4,5e3*c);console.warn(`â³ Rate limit in progress fetch, waiting ${e}ms...`),await new Promise(t=>setTimeout(t,e))}else c<3&&await new Promise(e=>setTimeout(e,3e3))}let h=Math.round(a.length/o*100);return console.log(`ðŸŽ¯ Progress fetch complete: ${a.length}/${o} records (${h}% success rate)`),{datas:a,totalElements:o,totalPages:Math.ceil(o/(t.size||50)),size:a.length,number:0,numberOfElements:a.length,first:!0,last:!0,total:o,state:void 0}}static getDefaultMonthYear(){return tL.getCurrentMonthYear()}static getDefaultDateRange(){let{month:e,year:t}=tL.getCurrentMonthYear();return tL.getMonthDateRange(e,t)}static formatDateForAPI(e){return tL.formatDate(e)}static validateDateRange(e,t){return tL.validateDateRange(e,t)}static getConfigOptions(){return{invoiceTypes:[{value:"banra",label:"HÃ³a Ä‘Æ¡n bÃ¡n ra"},{value:"muavao",label:"HÃ³a Ä‘Æ¡n mua vÃ o"}],pageSizes:[10,20,50,100,200],monthOptions:tL.getMonthOptions(),yearOptions:tL.getYearOptions(),dateRangeOptions:tL.getDateRangeOptions()}}};var tP=e.i(706547),tM=e.i(553082),t_=e.i(558851),tB=e.i(404210),tz=e.i(660179);let tq=({isOpen:e,onClose:t,onConfigChanged:r})=>{let[s,n]=(0,u.useState)(P.getConfig()),[a,i]=(0,u.useState)(!1),[l,o]=(0,u.useState)(!1),c=tF.getConfigOptions();return((0,u.useEffect)(()=>{e&&n(P.getConfig())},[e]),e)?(0,h.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(tP.Settings,{className:"w-5 h-5 text-blue-600 mr-2"}),(0,h.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Cáº¥u hÃ¬nh há»‡ thá»‘ng"})]}),(0,h.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,h.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,h.jsxs)("div",{className:"p-6 space-y-6",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bearer Token"}),(0,h.jsxs)("div",{className:"relative",children:[(0,h.jsx)("input",{type:a?"text":"password",value:s.bearerToken,onChange:e=>n({...s,bearerToken:e.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nháº­p Bearer Token"}),(0,h.jsx)("button",{type:"button",onClick:()=>i(!a),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?(0,h.jsx)(tz.EyeOff,{className:"w-4 h-4"}):(0,h.jsx)(tB.Eye,{className:"w-4 h-4"})})]}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Token xÃ¡c thá»±c Ä‘á»ƒ truy cáº­p API hÃ³a Ä‘Æ¡n Ä‘iá»‡n tá»­"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loáº¡i hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("select",{value:s.invoiceType,onChange:e=>n({...s,invoiceType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:c.invoiceTypes.map(e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"banra"===s.invoiceType?"Endpoint: /query/invoices/sold":"Endpoint: /query/invoices/purchase"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"TÃªn nhÃ£n hÃ ng"}),(0,h.jsx)("input",{type:"text",value:s.brandname||"",onChange:e=>n({...s,brandname:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nháº­p tÃªn nhÃ£n hÃ ng"}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"TÃªn nhÃ£n hÃ ng sáº½ Ä‘Æ°á»£c lÆ°u cÃ¹ng vá»›i thÃ´ng tin hÃ³a Ä‘Æ¡n"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sá»‘ báº£n ghi trÃªn trang"}),(0,h.jsx)("select",{value:s.pageSize,onChange:e=>n({...s,pageSize:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:c.pageSizes.map(e=>(0,h.jsxs)("option",{value:e,children:[e," báº£n ghi"]},e))}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Sá»‘ lÆ°á»£ng hÃ³a Ä‘Æ¡n hiá»ƒn thá»‹ trÃªn má»—i trang"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Endpoint"}),(0,h.jsx)("input",{type:"text",value:P.getApiEndpoint(s.invoiceType),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"}),(0,h.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Äá»‹a chá»‰ API Ä‘Æ°á»£c sá»­ dá»¥ng dá»±a trÃªn loáº¡i hÃ³a Ä‘Æ¡n"})]})]}),(0,h.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[(0,h.jsxs)("button",{onClick:()=>{confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n khÃ´i phá»¥c cáº¥u hÃ¬nh máº·c Ä‘á»‹nh?")&&(P.resetConfig(),n(P.getConfig()),$.toast.success("ÄÃ£ khÃ´i phá»¥c cáº¥u hÃ¬nh máº·c Ä‘á»‹nh"))},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[(0,h.jsx)(t_.RotateCcw,{className:"w-4 h-4 mr-2"}),"KhÃ´i phá»¥c máº·c Ä‘á»‹nh"]}),(0,h.jsxs)("div",{className:"flex space-x-3",children:[(0,h.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors",children:"Há»§y"}),(0,h.jsxs)("button",{onClick:()=>{if(o(!0),!P.validateBearerToken(s.bearerToken)){$.toast.error("Token Bearer khÃ´ng há»£p lá»‡"),o(!1);return}if(s.pageSize<1||s.pageSize>1e3){$.toast.error("KÃ­ch thÆ°á»›c trang pháº£i tá»« 1 Ä‘áº¿n 1000"),o(!1);return}try{P.setConfig(s),$.toast.success("ÄÃ£ lÆ°u cáº¥u hÃ¬nh thÃ nh cÃ´ng"),r?.(),t()}catch(e){$.toast.error("KhÃ´ng thá»ƒ lÆ°u cáº¥u hÃ¬nh")}finally{o(!1)}},disabled:l,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded-lg transition-colors",children:[(0,h.jsx)(tM.Save,{className:"w-4 h-4 mr-2"}),l?"Äang lÆ°u...":"LÆ°u cáº¥u hÃ¬nh"]})]})]})]})}):null};var tH=e.i(415588),tV=e.i(169100),tK=e.i(257725);let tY=({progress:e,onClose:t})=>{let r=e=>e<1e3?`${e}ms`:e<6e4?`${(e/1e3).toFixed(2)}s`:`${(e/6e4).toFixed(2)} ph\xfat`,s=()=>e.metadata?.durationMs?r(e.metadata.durationMs):e.startTime?r((e.endTime||new Date).getTime()-e.startTime.getTime()):"0s",n=0===e.totalInvoices?0:Math.round(e.processedInvoices/e.totalInvoices*100),a="fetching"===e.status||"syncing"===e.status;return(0,h.jsxs)("div",{className:`border-2 rounded-lg p-6 ${(()=>{switch(e.status){case"fetching":case"syncing":return"border-blue-500 bg-blue-50";case"completed":return"border-green-500 bg-green-50";case"error":return"border-red-500 bg-red-50";default:return"border-gray-300 bg-gray-50"}})()} transition-all duration-300`,children:[(0,h.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,h.jsxs)("div",{className:"flex items-center gap-3",children:[(()=>{switch(e.status){case"fetching":case"syncing":return(0,h.jsx)(I.Loader2,{className:"w-6 h-6 text-blue-500 animate-spin"});case"completed":return(0,h.jsx)(A.CheckCircle,{className:"w-6 h-6 text-green-500"});case"error":return(0,h.jsx)(S.XCircle,{className:"w-6 h-6 text-red-500"});default:return(0,h.jsx)(tH.Clock,{className:"w-6 h-6 text-gray-400"})}})(),(0,h.jsxs)("div",{children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Tiáº¿n trÃ¬nh Ä‘á»“ng bá»™ hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("p",{className:"text-sm text-gray-600",children:e.currentStep})]})]}),t&&!a&&(0,h.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"âœ•"})]}),a&&e.totalInvoices>0&&(0,h.jsxs)("div",{className:"mb-4",children:[(0,h.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,h.jsxs)("span",{children:["Tiáº¿n Ä‘á»™: ",e.processedInvoices,"/",e.totalInvoices]}),(0,h.jsxs)("span",{children:[n,"%"]})]}),(0,h.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:(0,h.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-300 ease-out",style:{width:`${n}%`},children:(0,h.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 to-blue-600 animate-pulse"})})})]}),e.totalInvoices>0&&(0,h.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,h.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,h.jsx)(b.FileText,{className:"w-4 h-4 text-blue-500"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:"Tá»•ng sá»‘"})]}),(0,h.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:e.totalInvoices})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,h.jsx)(A.CheckCircle,{className:"w-4 h-4 text-green-500"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:"ÄÃ£ lÆ°u"})]}),(0,h.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.savedInvoices})]}),e.skippedInvoices>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,h.jsx)(tV.AlertTriangle,{className:"w-4 h-4 text-yellow-500"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:"ÄÃ£ bá» qua"})]}),(0,h.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:e.skippedInvoices})]}),e.failedInvoices>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,h.jsx)(S.XCircle,{className:"w-4 h-4 text-red-500"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:"Tháº¥t báº¡i"})]}),(0,h.jsx)("div",{className:"text-2xl font-bold text-red-600",children:e.failedInvoices})]}),e.detailsFetched>0&&(0,h.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,h.jsx)(tK.Database,{className:"w-4 h-4 text-purple-500"}),(0,h.jsx)("span",{className:"text-xs text-gray-500",children:"Chi tiáº¿t"})]}),(0,h.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:e.detailsFetched})]})]}),"completed"===e.status&&e.metadata&&(0,h.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:[(0,h.jsxs)("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,h.jsx)(A.CheckCircle,{className:"w-5 h-5 text-green-500"}),"Káº¿t quáº£ Ä‘á»“ng bá»™"]}),(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{className:"text-gray-600",children:"Thá»i gian:"}),(0,h.jsx)("span",{className:"font-semibold text-gray-800",children:s()})]}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{className:"text-gray-600",children:"Tá»· lá»‡ thÃ nh cÃ´ng:"}),(0,h.jsxs)("span",{className:"font-semibold text-green-600",children:[e.metadata.successRate.toFixed(2),"%"]})]}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{className:"text-gray-600",children:"ÄÃ£ xá»­ lÃ½:"}),(0,h.jsxs)("span",{className:"font-semibold text-gray-800",children:[e.metadata.totalProcessed," hÃ³a Ä‘Æ¡n"]})]}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{className:"text-gray-600",children:"Chi tiáº¿t:"}),(0,h.jsxs)("span",{className:"font-semibold text-purple-600",children:[e.detailsFetched," báº£n ghi"]})]})]})]}),a&&e.startTime&&(0,h.jsxs)("div",{className:"text-sm text-gray-600 mb-4",children:[(0,h.jsx)(tH.Clock,{className:"w-4 h-4 inline mr-1"}),"Thá»i gian: ",s()]}),e.errors.length>0&&(0,h.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,h.jsxs)("h4",{className:"font-semibold text-red-800 mb-2 flex items-center gap-2",children:[(0,h.jsx)(S.XCircle,{className:"w-5 h-5"}),"Lá»—i (",e.errors.length,")"]}),(0,h.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:e.errors.map((e,t)=>(0,h.jsxs)("div",{className:"text-sm text-red-700 flex items-start gap-2",children:[(0,h.jsx)("span",{className:"text-red-400 mt-1",children:"â€¢"}),(0,h.jsx)("span",{className:"flex-1",children:e})]},t))})]}),"completed"===e.status&&0===e.errors.length&&(0,h.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[(0,h.jsx)(A.CheckCircle,{className:"w-6 h-6 text-green-500 flex-shrink-0"}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"font-semibold text-green-800",children:"Äá»“ng bá»™ hoÃ n táº¥t!"}),(0,h.jsxs)("p",{className:"text-sm text-green-700",children:["ÄÃ£ lÆ°u thÃ nh cÃ´ng ",e.savedInvoices," hÃ³a Ä‘Æ¡n vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u"]})]})]})]})};var tX=e.i(137651),tW=e.i(885205),tJ=e.i(702470),tG=e.i(726759),tQ=e.i(479017);let tZ=class{static formatCurrency(e){return e||0===e?new Intl.NumberFormat("vi-VN",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):""}static formatDate(e){if(!e)return"";try{if(e.includes("/"))return e;let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return`${r}/${s}/${n}`}catch{return e}}static formatStatus(e){return e?"1"===e||"active"===e?"Há»£p lá»‡":"0"===e||"cancelled"===e?"ÄÃ£ há»§y":e:""}static getHeaders(){return["STT","MST NgÆ°á»i bÃ¡n","KÃ½ hiá»‡u máº«u","KÃ½ hiá»‡u HÄ","Sá»‘ HÄ","CQT","Tá»•ng tiá»n chÆ°a thuáº¿","Tá»•ng tiá»n thuáº¿","Tá»•ng thanh toÃ¡n","Thá»i Ä‘iá»ƒm láº­p","TT CKTM","Tráº¡ng thÃ¡i","TT BÃ¡o","TT Xá»­ lÃ½","TÃªn hÃ ng hÃ³a/DV","ÄÆ¡n vá»‹ tÃ­nh","Sá»‘ lÆ°á»£ng","ÄÆ¡n giÃ¡","ThÃ nh tiá»n trÆ°á»›c thuáº¿","ThÃ nh tiá»n","Tá»· lá»‡ CK (%)","Loáº¡i thuáº¿ suáº¥t","Thuáº¿ suáº¥t (%)","Tiá»n thuáº¿","ThÃ nh giÃ¡"]}static invoiceToRow(e,t){return[t+1,e.nbmst||"",e.khmshdon||"",e.khhdon||"",e.shdon||"",e.cqt||"",this.formatCurrency(e.tgtcthue),this.formatCurrency(e.tgtthue),this.formatCurrency(e.tgtttbso),this.formatDate(e.thlap),e.ttcktmai||"",this.formatStatus(e.tthai),e.tttbao||"",e.ttxly||"",e.ten||"",e.dvtinh||"",e.sluong||"",this.formatCurrency(e.dgia),this.formatCurrency(e.thtcthue),this.formatCurrency(e.thtien),e.tlckhau||"",e.ltsuat||"",e.tsuat||"",this.formatCurrency(e.tthue),this.formatCurrency(e.tgia)]}static generatePreview(e,t=10){let r=this.getHeaders(),s=e.map((e,t)=>this.invoiceToRow(e,t)),n=s.slice(0,t);return{headers:r,rows:n,totalRows:s.length,previewRows:n.length,fileName:`hoa-don-${new Date().toISOString().split("T")[0]}.xlsx`}}static createWorkbook(e){let t=[this.getHeaders(),...e.map((e,t)=>this.invoiceToRow(e,t))],r=tG.utils.aoa_to_sheet(t);r["!cols"]=[{wch:5},{wch:15},{wch:12},{wch:12},{wch:10},{wch:8},{wch:18},{wch:15},{wch:18},{wch:18},{wch:10},{wch:12},{wch:10},{wch:10},{wch:30},{wch:12},{wch:10},{wch:15},{wch:18},{wch:18},{wch:10},{wch:12},{wch:10},{wch:15},{wch:18}];let s=tG.utils.decode_range(r["!ref"]||"A1");for(let e=s.s.c;e<=s.e.c;e++){let t=tG.utils.encode_cell({r:0,c:e});r[t]&&(r[t].s={font:{bold:!0},fill:{fgColor:{rgb:"E0E0E0"}},alignment:{horizontal:"center",vertical:"center"}})}let n=tG.utils.book_new();return tG.utils.book_append_sheet(n,r,"HÃ³a Ä‘Æ¡n"),n}static exportToExcel(e,t){try{if(console.log("ðŸš€ Starting frontend Excel export..."),console.log("ðŸ“Š Total invoices:",e.length),0===e.length)return void alert("âš ï¸ KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t");let r=this.createWorkbook(e),s=tG.write(r,{bookType:"xlsx",type:"array",cellStyles:!0}),n=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=`hoa-don-${new Date().toISOString().split("T")[0]}.xlsx`,i=t||a;(0,tQ.saveAs)(n,i),console.log("âœ… Excel export completed:",i),console.log("ðŸ“¦ File size:",n.size,"bytes")}catch(e){throw console.error("âŒ Frontend Excel export error:",e),alert(`âŒ Lá»—i xuáº¥t Excel: ${e instanceof Error?e.message:"Unknown error"}`),e}}static exportWithDateRange(e,t,r){let s=`hoa-don-${t}_${r}.xlsx`;this.exportToExcel(e,s)}static filterByDateRange(e,t,r){try{let s=new Date(t),n=new Date(r);return n.setHours(23,59,59,999),e.filter(e=>{if(!e.thlap)return!1;try{let t;if(e.thlap.includes("/")){let[r,s,n]=e.thlap.split("/");t=new Date(`${n}-${s}-${r}`)}else t=new Date(e.thlap);return t>=s&&t<=n}catch{return!1}})}catch(t){return console.error("Error filtering by date range:",t),e}}static getStatistics(e){return{totalInvoices:e.length,totalAmount:e.reduce((e,t)=>e+(t.tgtttbso||0),0),totalTax:e.reduce((e,t)=>e+(t.tgtthue||0),0),totalBeforeTax:e.reduce((e,t)=>e+(t.tgtcthue||0),0),validInvoices:e.filter(e=>"1"===e.tthai||"active"===e.tthai).length,cancelledInvoices:e.filter(e=>"0"===e.tthai||"cancelled"===e.tthai).length}}static validateData(e){let t=[],r=[];0===e.length&&t.push("KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t"),e.length>1e4&&r.push(`Sá»‘ lÆ°á»£ng h\xf3a Ä‘Æ¡n lá»›n (${e.length}). Qu\xe1 tr\xecnh export c\xf3 thá»ƒ máº¥t thá»i gian.`);let s=e.filter(e=>!e.shdon||!e.nbmst);return s.length>0&&r.push(`${s.length} h\xf3a Ä‘Æ¡n thiáº¿u th\xf4ng tin quan trá»ng (Sá»‘ HÄ hoáº·c MST)`),{isValid:0===t.length,errors:t,warnings:r}}};function t0({open:e,onOpenChange:t,invoices:r,fromDate:s,toDate:n}){let[a,i]=(0,u.useState)(!1),l=r.length>0?tZ.generatePreview(r,10):null,o=tZ.getStatistics(r),c=tZ.validateData(r),d=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,h.jsx)(tX.Dialog,{open:e,onOpenChange:t,children:(0,h.jsxs)(tX.DialogContent,{className:"max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,h.jsx)(tX.DialogHeader,{children:(0,h.jsxs)(tX.DialogTitle,{className:"flex items-center gap-2",children:[(0,h.jsx)(D.FileSpreadsheet,{className:"w-5 h-5 text-green-600"}),"Xem trÆ°á»›c xuáº¥t Excel"]})}),(0,h.jsxs)("div",{className:"flex-1 overflow-auto space-y-4 py-4",children:[(0,h.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,h.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[(0,h.jsx)("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"Tá»•ng hÃ³a Ä‘Æ¡n"}),(0,h.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:o.totalInvoices})]}),(0,h.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:[(0,h.jsx)("div",{className:"text-xs text-green-600 font-medium mb-1",children:"Tá»•ng tiá»n"}),(0,h.jsx)("div",{className:"text-lg font-bold text-green-900 truncate",title:d(o.totalAmount),children:d(o.totalAmount)})]}),(0,h.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-200",children:[(0,h.jsx)("div",{className:"text-xs text-purple-600 font-medium mb-1",children:"Há»£p lá»‡"}),(0,h.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:o.validInvoices})]}),(0,h.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:[(0,h.jsx)("div",{className:"text-xs text-red-600 font-medium mb-1",children:"ÄÃ£ há»§y"}),(0,h.jsx)("div",{className:"text-2xl font-bold text-red-900",children:o.cancelledInvoices})]})]}),c.warnings.length>0&&(0,h.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,h.jsxs)("div",{className:"flex items-start gap-2",children:[(0,h.jsx)(O.AlertCircle,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)("div",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Cáº£nh bÃ¡o:"}),(0,h.jsx)("ul",{className:"text-xs text-yellow-700 space-y-1",children:c.warnings.map((e,t)=>(0,h.jsxs)("li",{children:["â€¢ ",e]},t))})]})]})}),c.errors.length>0&&(0,h.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,h.jsxs)("div",{className:"flex items-start gap-2",children:[(0,h.jsx)(O.AlertCircle,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)("div",{className:"text-sm font-medium text-red-800 mb-1",children:"Lá»—i:"}),(0,h.jsx)("ul",{className:"text-xs text-red-700 space-y-1",children:c.errors.map((e,t)=>(0,h.jsxs)("li",{children:["â€¢ ",e]},t))})]})]})}),l&&(0,h.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-2 border-b flex items-center justify-between",children:[(0,h.jsxs)("div",{className:"font-medium text-sm",children:["Xem trÆ°á»›c dá»¯ liá»‡u",(0,h.jsxs)(tJ.Badge,{variant:"secondary",className:"ml-2",children:[l.previewRows," / ",l.totalRows," dÃ²ng"]})]}),(0,h.jsxs)("div",{className:"text-xs text-gray-600",children:["File: ",l.fileName]})]}),(0,h.jsx)("div",{className:"overflow-auto max-h-96",children:(0,h.jsxs)("table",{className:"w-full text-xs",children:[(0,h.jsx)("thead",{className:"bg-gray-100 sticky top-0",children:(0,h.jsx)("tr",{children:l.headers.map((e,t)=>(0,h.jsx)("th",{className:"px-2 py-2 text-left font-medium text-gray-700 border-b whitespace-nowrap",children:e},t))})}),(0,h.jsx)("tbody",{children:l.rows.map((e,t)=>(0,h.jsx)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:e.map((e,t)=>(0,h.jsx)("td",{className:"px-2 py-1.5 border-b text-gray-800 whitespace-nowrap",title:String(e),children:(0,h.jsx)("div",{className:"max-w-xs truncate",children:e})},t))},t))})]})}),l.totalRows>l.previewRows&&(0,h.jsxs)("div",{className:"bg-gray-50 px-4 py-2 border-t text-xs text-gray-600 text-center",children:["... vÃ  ",l.totalRows-l.previewRows," dÃ²ng ná»¯a"]})]}),s&&n&&(0,h.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,h.jsx)("div",{className:"text-xs font-medium text-blue-800 mb-1",children:"Khoáº£ng thá»i gian:"}),(0,h.jsxs)("div",{className:"text-sm text-blue-900",children:["Tá»« ",(0,h.jsx)("strong",{children:s})," Ä‘áº¿n ",(0,h.jsx)("strong",{children:n})]})]})]}),(0,h.jsxs)(tX.DialogFooter,{className:"flex-shrink-0 border-t pt-4",children:[(0,h.jsxs)(tW.Button,{variant:"outline",onClick:()=>t(!1),disabled:a,children:[(0,h.jsx)(f.X,{className:"w-4 h-4 mr-2"}),"Há»§y"]}),(0,h.jsxs)(tW.Button,{onClick:()=>{try{i(!0),s&&n?tZ.exportWithDateRange(r,s,n):tZ.exportToExcel(r),setTimeout(()=>{alert(`âœ… Xuáº¥t th\xe0nh c\xf4ng ${r.length} h\xf3a Ä‘Æ¡n!`),t(!1)},500)}catch(e){console.error("Export error:",e),alert("âŒ Lá»—i khi xuáº¥t Excel. Vui lÃ²ng thá»­ láº¡i.")}finally{i(!1)}},disabled:a||!c.isValid,className:"bg-green-600 hover:bg-green-700",children:[(0,h.jsx)(C.Download,{className:"w-4 h-4 mr-2"}),a?"Äang xuáº¥t...":`Xuáº¥t Excel (${o.totalInvoices} h\xf3a Ä‘Æ¡n)`]})]})]})})}let t1=new class{baseUrl;constructor(){this.baseUrl=U.default.env.NEXT_PUBLIC_API_URL||"http://localhost:14000"}getAuthHeaders(){let e=localStorage.getItem("accessToken");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}async syncInvoiceData(e,t,r,s,n){try{console.log("Syncing invoice data to database:",{invoiceCount:e.length,detailsCount:t?.length||0,hasBearerToken:!!r}),n&&n({processed:0,total:e.length,current:"Báº¯t Ä‘áº§u Ä‘á»“ng bá»™..."});let a=null;if(n){let t=2500*e.length,r=Math.floor(t/1e3),s=0;a=setInterval(()=>{s++;let t=Math.min(Math.floor(s/r*e.length),e.length-1);n({processed:t,total:e.length,current:`Äang xá»­ l\xfd h\xf3a Ä‘Æ¡n ${t+1}/${e.length}...`}),s>=r&&a&&clearInterval(a)},1e3)}let i=await fetch(`${this.baseUrl}/api/invoices/sync`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({invoiceData:e,detailsData:t||[],bearerToken:r||void 0,brandname:s||void 0})});if(a&&clearInterval(a),a&&clearInterval(a),!i.ok)throw Error(`HTTP error! status: ${i.status}`);let l=await i.json();return n&&l.success&&n({processed:e.length,total:e.length,current:`Ho\xe0n th\xe0nh: ${l.invoicesSaved} h\xf3a Ä‘Æ¡n, ${l.detailsSaved} chi tiáº¿t`}),console.log("Database sync result:",l),l}catch(e){return console.error("Error syncing invoice data:",e),{success:!1,invoicesSaved:0,detailsSaved:0,errors:[e instanceof Error?e.message:"Unknown error"],message:"Lá»—i khi Ä‘á»“ng bá»™ dá»¯ liá»‡u vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u"}}}async checkInvoiceExists(e,t,r){try{console.log("Checking invoice exists:",{nbmst:e,khmshdon:t,shdon:r});let s=await fetch(`${this.baseUrl}/api/invoices/exists/${encodeURIComponent(e)}/${encodeURIComponent(t)}/${encodeURIComponent(r)}`,{method:"GET",headers:this.getAuthHeaders()});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);return(await s.json()).exists||!1}catch(e){return console.error("Error checking invoice existence:",e),!1}}async getDatabaseStats(){try{console.log("Getting database statistics");let e=await fetch(`${this.baseUrl}/api/invoices/stats/summary`,{method:"GET",headers:this.getAuthHeaders()});if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let t=await e.json();return t.lastSyncDate&&(t.lastSyncDate=new Date(t.lastSyncDate)),t}catch(e){return console.error("Error getting database stats:",e),{totalInvoices:0,totalDetails:0,totalAmount:0,totalTax:0}}}async searchInvoices(e){try{let t=new URLSearchParams;Object.entries(e).forEach(([e,r])=>{null!=r&&""!==r&&t.append(e,r.toString())}),console.log("Searching invoices with params:",t.toString());let r=await fetch(`${this.baseUrl}/api/invoices?${t}`,{method:"GET",headers:this.getAuthHeaders()});if(!r.ok){if(403===r.status||401===r.status)throw localStorage.removeItem("accessToken"),window.location.href="/login",Error("Unauthorized. Please log in again.");throw Error(`HTTP error! status: ${r.status}`)}return await r.json()}catch(e){throw console.error("Error searching invoices:",e),e}}async createInvoice(e){try{let t=await fetch(`${this.baseUrl}/api/invoices`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(e)});if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(e){throw console.error("Error creating invoice:",e),e}}async getInvoiceById(e){try{let t=await fetch(`${this.baseUrl}/api/invoices/${e}`,{method:"GET",headers:this.getAuthHeaders()});if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(e){throw console.error("Error getting invoice by ID:",e),e}}};var t2=e.i(850384),t4=e.i(791174);let t5=class{static getApiUrl(){return"http://116.118.49.243:13001/ketoan/listhoadon"}static getExportUrl(){return`${this.getApiUrl()}/export-excel`}static normalizeDateString(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;if(/^\d{2}\/\d{2}\/\d{4}$/.test(e)){let[t,r,s]=e.split("/");return`${s}-${r.padStart(2,"0")}-${t.padStart(2,"0")}`}if(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e)){let[t,r,s]=e.split("/");return`${s}-${t.padStart(2,"0")}-${r.padStart(2,"0")}`}try{let t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString().split("T")[0]}catch(t){console.warn("Failed to parse date:",e)}return e}static async testConnection(e){try{return(await tU.get(`${e}/health`,{timeout:5e3,validateStatus:()=>!0})).status<500}catch(e){return!1}}static async detectBackendUrl(){for(let e of[14e3,4e3,3001,8e3]){let t=`http://localhost:${e}`;if(console.log(`ðŸ” Testing connection to ${t}...`),await this.testConnection(t))return console.log(`âœ… Found working backend at ${t}`),`${t}/ketoan/listhoadon`}return this.getApiUrl()}static async checkServerConnection(){try{let e=this.getApiUrl().replace("/ketoan/listhoadon","");console.log("ðŸ” Checking server connection:",e);try{let t=await tU.head(`${e}/ketoan/listhoadon/export-excel?fromDate=2024-01-01&toDate=2024-01-31`,{timeout:5e3,validateStatus:()=>!0});if(200===t.status)return{connected:!0,url:e,message:`Backend server connected on ${e} (Excel export endpoint working)`}}catch(e){console.log("Excel export endpoint test failed, trying health endpoint...")}if(await this.testConnection(e))return{connected:!0,url:e,message:`Backend server connected on ${e}`};console.log("ðŸ”„ Primary connection failed, trying auto-detection...");let t=(await this.detectBackendUrl()).replace("/ketoan/listhoadon","");try{let e=await tU.head(`${t}/ketoan/listhoadon/export-excel?fromDate=2024-01-01&toDate=2024-01-31`,{timeout:5e3,validateStatus:()=>!0});if(200===e.status)return{connected:!0,url:t,message:`Backend server found on ${t} (auto-detected, Excel export endpoint working)`}}catch(e){console.log("Auto-detected Excel export endpoint test failed, trying health endpoint...")}if(await this.testConnection(t))return{connected:!0,url:t,message:`Backend server found on ${t} (auto-detected)`};return{connected:!1,message:"Backend server khÃ´ng kháº£ dá»¥ng trÃªn cÃ¡c port thÃ´ng thÆ°á»ng (14000, 4000, 3001, 8000). Vui lÃ²ng kiá»ƒm tra server cÃ³ Ä‘ang cháº¡y khÃ´ng."}}catch(e){return console.error("âŒ Connection check error:",e),{connected:!1,message:`Lá»—i kiá»ƒm tra káº¿t ná»‘i server: ${e instanceof Error?e.message:"Unknown error"}`}}}static validateDateRange(e,t){try{if(!e||!t)return{isValid:!1,message:"Vui lÃ²ng chá»n ngÃ y báº¯t Ä‘áº§u vÃ  ngÃ y káº¿t thÃºc"};let r=this.normalizeDateString(e),s=this.normalizeDateString(t),n=/^\d{4}-\d{2}-\d{2}$/;if(!n.test(r)||!n.test(s))return{isValid:!1,message:"Äá»‹nh dáº¡ng ngÃ y khÃ´ng há»£p lá»‡. Vui lÃ²ng sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng DD/MM/YYYY hoáº·c YYYY-MM-DD"};let a=new Date(r),i=new Date(s);if(console.log("ðŸ” Validating date range:",{originalFromDate:e,originalToDate:t,normalizedFromDate:r,normalizedToDate:s,startDate:a.toISOString(),endDate:i.toISOString(),startValid:!isNaN(a.getTime()),endValid:!isNaN(i.getTime())}),isNaN(a.getTime())||isNaN(i.getTime()))return{isValid:!1,message:"NgÃ y khÃ´ng há»£p lá»‡. Vui lÃ²ng kiá»ƒm tra láº¡i ngÃ y thÃ¡ng"};if(a>i)return{isValid:!1,message:"NgÃ y báº¯t Ä‘áº§u pháº£i nhá» hÆ¡n hoáº·c báº±ng ngÃ y káº¿t thÃºc"};let l=new Date;if(l.setHours(23,59,59,999),a>l)return{isValid:!1,message:"NgÃ y báº¯t Ä‘áº§u khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ ngÃ y hiá»‡n táº¡i"};let o=Math.ceil((i.getTime()-a.getTime())/864e5);if(o>365)return{isValid:!1,message:"Khoáº£ng thá»i gian khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ 365 ngÃ y"};return console.log("âœ… Date range validation passed:",{daysDiff:o}),{isValid:!0}}catch(e){return console.error("âŒ Date validation error:",e),{isValid:!1,message:"Lá»—i kiá»ƒm tra khoáº£ng thá»i gian"}}}static async exportToExcel(e,t){try{console.log("ðŸ” Starting Excel export process..."),console.log("ðŸ“… Date range:",{fromDate:e,toDate:t});let r=this.validateDateRange(e,t);if(!r.isValid)return void alert(`âŒ Validation Error: ${r.message}`);console.log("ðŸ”Œ Checking server connection...");let s=await this.checkServerConnection();if(console.log("ðŸ”Œ Connection check result:",s),!s.connected){let e=`âŒ Server Connection Failed: ${s.message}`;console.error(e),alert(e);return}let n=s.url,a=`${n}/ketoan/listhoadon/export-excel`,i=this.normalizeDateString(e),l=this.normalizeDateString(t);console.log("ðŸ“… Normalized dates:",{original:{fromDate:e,toDate:t},normalized:{fromDate:i,toDate:l}});let o=new URLSearchParams({fromDate:i,toDate:l}),c=`${a}?${o.toString()}`;console.log("ðŸŒ Request URL:",c),console.log("ðŸ§ª Testing export endpoint availability...");try{let e=await tU.head(c,{timeout:5e3});console.log("âœ… Export endpoint is accessible:",e.status)}catch(e){console.log("âš ï¸ HEAD request failed, proceeding with GET...")}console.log("ðŸ“¤ Making Excel export request...");let d=await tU.get(c,{responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/octet-stream, */*","User-Agent":"Mozilla/5.0 (compatible; rausachcore-Frontend)"},timeout:3e4,withCredentials:!1,validateStatus:e=>e>=200&&e<300});if(console.log("ðŸ“Š Response received:",{status:d.status,statusText:d.statusText,contentType:d.headers["content-type"],contentLength:d.headers["content-length"],dataSize:d.data?.size||"unknown"}),!d.data||0===d.data.size)throw Error("Received empty file from server");let h=new Blob([d.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=`hoa-don-${i}_${l}.xlsx`;console.log("ðŸ’¾ Downloading file:",u,"Size:",h.size,"bytes"),(0,tQ.saveAs)(h,u),console.log("âœ… Excel export completed successfully!"),alert(`âœ… Export th\xe0nh c\xf4ng! File: ${u} (${h.size} bytes)`)}catch(t){console.error("âŒ Excel export error:",t);let e="Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh khi export Excel";if(tU.isAxiosError(t))if(t.response){let r=t.response.status,s=t.response.statusText;if(e=`Lá»—i server (${r}): ${s}`,t.response.data)try{let e="string"==typeof t.response.data?t.response.data:JSON.stringify(t.response.data);console.error("Server error details:",e)}catch(e){console.error("Could not parse error response:",t.response.data)}}else t.request?(e="KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server. Vui lÃ²ng kiá»ƒm tra:\n- Server cÃ³ Ä‘ang cháº¡y khÃ´ng?\n- URL cÃ³ Ä‘Ãºng khÃ´ng?\n- CÃ³ váº¥n Ä‘á» CORS khÃ´ng?",console.error("Request error details:",t.request)):e=`Lá»—i setup request: ${t.message}`;else t instanceof Error&&(e=t.message);throw alert(`âŒ Export Excel tháº¥t báº¡i:
${e}`),t}}static testValidation(){console.log("ðŸ§ª Testing date validation:"),[{from:"2025-01-01",to:"2025-01-31",expected:!0},{from:"01/01/2025",to:"31/01/2025",expected:!0},{from:"2025-12-01",to:"2025-11-01",expected:!1},{from:"",to:"2025-01-31",expected:!1},{from:"invalid",to:"2025-01-31",expected:!1},{from:"2025-01-01",to:"2026-01-01",expected:!1}].forEach((e,t)=>{let r=this.validateDateRange(e.from,e.to),s=r.isValid===e.expected;console.log(`Test ${t+1}: ${s?"âœ…":"âŒ"}`,{input:{from:e.from,to:e.to},expected:e.expected,actual:r.isValid,message:r.message})})}};e.s(["default",0,()=>{let[e,t]=(0,u.useState)([]),[r,s]=(0,u.useState)(!1),[n,a]=(0,u.useState)(null),[i,l]=(0,u.useState)(!1),[o,c]=(0,u.useState)(null),[d,m]=(0,u.useState)(!1),[g,x]=(0,u.useState)({page:0,size:50,totalElements:0,totalPages:0}),[f,b]=(0,u.useState)(P.getConfig()),[y,v]=(0,u.useState)(!1),[w,N]=(0,u.useState)(!1),[j,T]=(0,u.useState)(!1),[E,S]=(0,u.useState)([]),{syncData:C,searchInvoices:A,isLoading:O}=function(){let[e,t]=(0,u.useState)(!1),[r,s]=(0,u.useState)(null);return{syncData:async(e,r,n,a,i)=>{t(!0),s(null);try{return await t1.syncInvoiceData(e,r,n,a,i)}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},checkExists:async(e,r,n)=>{t(!0),s(null);try{return await t1.checkInvoiceExists(e,r,n)}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},getStats:async()=>{t(!0),s(null);try{return await t1.getDatabaseStats()}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},searchInvoices:async e=>{t(!0),s(null);try{return await t1.searchInvoices(e)}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},createInvoice:async e=>{t(!0),s(null);try{return await t1.createInvoice(e)}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},getInvoiceById:async e=>{t(!0),s(null);try{return await t1.getInvoiceById(e)}catch(e){throw s(e instanceof Error?e.message:"Unknown error"),e}finally{t(!1)}},isLoading:e,error:r}}(),[I,U]=(0,u.useState)(""),[L,M]=(0,u.useState)(!1),[_,B]=(0,u.useState)({status:"idle",currentStep:"ChÆ°a báº¯t Ä‘áº§u",totalInvoices:0,processedInvoices:0,savedInvoices:0,skippedInvoices:0,failedInvoices:0,detailsFetched:0,errors:[]}),[z,q]=(0,u.useState)(()=>{let{month:e}=tL.getCurrentMonthYear();return e}),[H,V]=(0,u.useState)(()=>{let{year:e}=tL.getCurrentMonthYear();return e}),[K,Y]=(0,u.useState)(()=>{let{month:e,year:t}=tL.getCurrentMonthYear(),r=tL.getMonthDateRange(e,t);return{fromDate:r.fromDate,toDate:r.toDate,month:e,year:t,invoiceNumber:"",taxCode:"",buyerName:"",globalSearch:"",amountFrom:void 0,amountTo:void 0}}),[X,W]=(0,u.useState)("custom"),[J,G]=(0,u.useState)("tdlap"),[Q,Z]=(0,u.useState)("desc");(0,u.useEffect)(()=>{l(!0)},[]),(0,u.useEffect)(()=>{let e=tL.getMonthDateRange(z,H);Y(t=>({...t,fromDate:e.fromDate,toDate:e.toDate,month:z,year:H}))},[z,H]);let ee=async()=>{try{M(!0),U("Äang láº¥y dá»¯ liá»‡u tá»« API bÃªn ngoÃ i..."),B({status:"fetching",currentStep:"Äang láº¥y dá»¯ liá»‡u tá»« API bÃªn ngoÃ i...",totalInvoices:0,processedInvoices:0,savedInvoices:0,skippedInvoices:0,failedInvoices:0,detailsFetched:0,errors:[],startTime:new Date});let e=P.getValidatedConfig();if(b(e),!K.month||!K.year||K.month<1||K.month>12){$.toast.error("Vui lÃ²ng chá»n thÃ¡ng vÃ  nÄƒm há»£p lá»‡"),B(e=>({...e,status:"error",currentStep:"Lá»—i: ThÃ¡ng/nÄƒm khÃ´ng há»£p lá»‡",errors:["Vui lÃ²ng chá»n thÃ¡ng vÃ  nÄƒm há»£p lá»‡"]}));return}let t=await tF.fetchInvoices(K,{page:0,size:50,sort:"tdlap:desc,khmshdon:asc,shdon:desc"},e.invoiceType);if(t.totalElements&&t.totalElements>50){let e=t.totalElements-50;(0,$.toast)(`âš ï¸ C\xf3 ${t.totalElements} h\xf3a Ä‘Æ¡n. Äang Ä‘á»“ng bá»™ 50 Ä‘áº§u ti\xean. C\xf2n ${e} h\xf3a Ä‘Æ¡n.`,{duration:5e3,icon:"â„¹ï¸"}),console.log(`ðŸ“Š Total invoices available: ${t.totalElements}, Syncing: 50, Remaining: ${e}`)}if(t.datas&&t.datas.length>0){U(`Äang Ä‘á»“ng bá»™ ${t.datas.length} h\xf3a Ä‘Æ¡n v\xe0o database...`),B(e=>({...e,status:"syncing",currentStep:`Äang Ä‘á»“ng bá»™ ${t.datas.length} h\xf3a Ä‘Æ¡n...`,totalInvoices:t.datas.length}));let r=e.bearerToken||void 0,s=e.brandname||void 0,n=await C(t.datas,[],r,s,e=>{B(t=>({...t,processedInvoices:e.processed,currentStep:e.current}))});if(n.success){$.toast.success(`Ä\xe3 Ä‘á»“ng bá»™ th\xe0nh c\xf4ng ${n.invoicesSaved} h\xf3a Ä‘Æ¡n`),U(`Äá»“ng bá»™ th\xe0nh c\xf4ng: ${n.invoicesSaved} h\xf3a Ä‘Æ¡n`);let e=t.datas.length-n.invoicesSaved-n.errors.length;B(r=>({...r,status:"completed",currentStep:"HoÃ n thÃ nh Ä‘á»“ng bá»™",processedInvoices:t.datas.length,savedInvoices:n.invoicesSaved,skippedInvoices:e>0?e:0,failedInvoices:n.errors.length,detailsFetched:n.detailsSaved,errors:n.errors,endTime:new Date,metadata:n.metadata})),await et()}else $.toast.error(`Äá»“ng bá»™ tháº¥t báº¡i: ${n.errors.join(", ")}`),U("Äá»“ng bá»™ tháº¥t báº¡i"),B(e=>({...e,status:"error",currentStep:"Äá»“ng bá»™ tháº¥t báº¡i",errors:n.errors,endTime:new Date}))}else(0,$.toast)("KhÃ´ng cÃ³ dá»¯ liá»‡u má»›i Ä‘á»ƒ Ä‘á»“ng bá»™",{icon:"â„¹ï¸"}),U("KhÃ´ng cÃ³ dá»¯ liá»‡u má»›i"),B(e=>({...e,status:"completed",currentStep:"KhÃ´ng cÃ³ dá»¯ liá»‡u má»›i",endTime:new Date})),await et()}catch(t){let e=t?.message||"KhÃ´ng thá»ƒ Ä‘á»“ng bá»™ dá»¯ liá»‡u";a(e),$.toast.error(e),U("Lá»—i Ä‘á»“ng bá»™"),B(t=>({...t,status:"error",currentStep:"Lá»—i Ä‘á»“ng bá»™",errors:[e],endTime:new Date})),console.error("Error syncing data:",t)}finally{M(!1)}},et=async(e=0,r=!0)=>{try{r&&s(!0),a(null);let n={page:e,size:f.pageSize,sortBy:J,sortOrder:Q,fromDate:K.fromDate,toDate:K.toDate,...K.invoiceNumber&&{shdon:K.invoiceNumber},...K.taxCode&&{nbmst:K.taxCode},...K.buyerName&&{nmten:K.buyerName},...K.thlap&&{thlap:K.thlap}},i=await A(n),l=i.invoices.map(e=>({nbmst:e.nbmst||e.msttcgp,khmshdon:e.khmshdon,khhdon:e.khmshdon,shdon:e.shdon,cqt:"",nbdchi:e.dchi||e.dctcgp,nbten:e.nten||e.tentcgp,nmdchi:e.dcxmua,nmmst:e.msttmua,nmten:e.tenxmua,nmtnmua:e.tenxmua,tgtcthue:e.tgtcthue,tgtthue:e.tgtthue,tgtttbso:e.tgtttbso,tgtttbchu:e.tgtttchu,thlap:e.tdlap,ttcktmai:"",tthai:e.tghdon||"",tttbao:"",ttxly:"",details:e.details.map(e=>({dgia:e.dgia,dvtinh:e.dvtinh,ltsuat:e.ltsuat,sluong:e.sluong,ten:e.ten,thtcthue:e.thtcthue,thtien:e.thtien,tlckhau:e.tlckhau,tsuat:e.tsuat,tthue:e.tthue,tgia:e.tgia,tgtcthue:e.tgtcthue,tgthue:e.tgthue}))||[]}));t(l||[]),console.log("Fetched invoices from database:",l),x({page:i.page||0,size:i.size||f.pageSize,totalElements:i.total||0,totalPages:i.totalPages||0}),l&&0!==l.length||0!==e||(0,$.toast)(`Kh\xf4ng t\xecm tháº¥y h\xf3a Ä‘Æ¡n n\xe0o trong database cho th\xe1ng ${z}/${H}`,{icon:"â„¹ï¸"})}catch(t){let e=t?.message||"KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u tá»« database";a(e),$.toast.error(e),console.error("Error fetching from database:",t)}finally{s(!1)}},er=async(e=0,t=!0)=>{await et(e,t)},es=async()=>{try{let e=t5.validateDateRange(K.fromDate,K.toDate);if(!e.isValid)return void $.toast.error(e.message||"Dá»¯ liá»‡u ngÃ y khÃ´ng há»£p lá»‡");$.toast.loading("Kiá»ƒm tra káº¿t ná»‘i server...",{id:"excel-export"});let t=await t5.checkServerConnection();if(!t.connected){$.toast.error(t.message,{id:"excel-export"}),console.error("âŒ Server connection failed:",t.message);return}console.log("âœ… Server connection OK:",t.message),$.toast.loading("Äang xuáº¥t file Excel tá»« server...",{id:"excel-export"}),await t5.exportToExcel(K.fromDate,K.toDate)}catch(e){console.error("Excel export error:",e)}finally{$.toast.dismiss("excel-export")}};return(0,u.useEffect)(()=>{er()},[]),(0,h.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,h.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,h.jsxs)("div",{className:"mb-8",children:[(0,h.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Danh sÃ¡ch hÃ³a Ä‘Æ¡n Ä‘iá»‡n tá»­"}),(0,h.jsx)("p",{className:"text-gray-600",children:"Quáº£n lÃ½ vÃ  tra cá»©u hÃ³a Ä‘Ã´n Ä‘iá»‡n tá»­ tá»« há»‡ thá»‘ng thuáº¿ Ä‘iá»‡n tá»­"})]}),(0,h.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,h.jsx)("div",{className:"bg-blue-50 px-3 py-2 rounded-lg",children:(0,h.jsx)("span",{className:"text-sm font-medium text-blue-800",children:i?`Loáº¡i: ${"banra"===f.invoiceType?"HÃ³a Ä‘Æ¡n bÃ¡n ra":"HÃ³a Ä‘Æ¡n mua vÃ o"}`:"Loáº¡i: HÃ³a Ä‘Æ¡n bÃ¡n ra"})}),(0,h.jsxs)("div",{className:"text-sm text-gray-600",children:["KÃ­ch thÆ°á»›c trang: ",i?f.pageSize:20]})]}),(0,h.jsxs)("button",{onClick:()=>v(!0),className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors",children:[(0,h.jsx)(tP.Settings,{className:"w-4 h-4 mr-2"}),"Cáº¥u hÃ¬nh"]})]}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),et(0,!0)},className:"space-y-6",children:[(0,h.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khoáº£ng thá»i gian"}),(0,h.jsxs)("select",{value:X,onChange:e=>(e=>{if(W(e),"custom"===e)return;let t=tL.getDateRangeOptions().find(t=>t.value===e);if(t){let{fromDate:e,toDate:r}=t.getData();Y(t=>({...t,fromDate:e,toDate:r}))}})(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,h.jsx)("option",{value:"current_month",children:"ThÃ¡ng nÃ y"}),(0,h.jsx)("option",{value:"previous_month",children:"ThÃ¡ng trÆ°á»›c"}),(0,h.jsx)("option",{value:"last_3_months",children:"3 thÃ¡ng gáº§n nháº¥t"}),(0,h.jsx)("option",{value:"last_6_months",children:"6 thÃ¡ng gáº§n nháº¥t"}),(0,h.jsx)("option",{value:"custom",children:"TÃ¹y chá»n"})]})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ThÃ¡ng"}),(0,h.jsx)("select",{value:z,onChange:e=>q(Number(e.target.value)),disabled:"custom"!==X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",children:tL.getMonthOptions().map(e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NÄƒm"}),(0,h.jsx)("select",{value:H,onChange:e=>V(Number(e.target.value)),disabled:"custom"!==X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",children:tL.getYearOptions().map(e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tá»« ngÃ y"}),(0,h.jsx)("input",{type:"text",value:K.fromDate,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Äáº¿n ngÃ y"}),(0,h.jsx)("input",{type:"text",value:K.toDate,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"})]})]}),(0,h.jsxs)("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[(0,h.jsxs)("button",{type:"submit",disabled:r||O,className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50",title:"TÃ¬m kiáº¿m hÃ³a Ä‘Æ¡n trong database theo Ä‘iá»u kiá»‡n lá»c",children:[(0,h.jsx)(t2.Search,{className:"w-4 h-4 mr-2"}),r||O?"Äang tÃ¬m...":"TÃ¬m trong Database"]}),(0,h.jsxs)("button",{type:"button",onClick:ee,disabled:r||L||O||!K.month||!K.year,className:"inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50",title:"Äá»“ng bá»™ hÃ³a Ä‘Æ¡n tá»« API bÃªn ngoÃ i vÃ o database",children:[(0,h.jsx)(t4.RefreshCw,{className:`w-4 h-4 mr-2 ${L?"animate-spin":""}`}),L?"Äang Ä‘á»“ng bá»™...":"Äá»“ng bá»™ tá»« API"]}),(0,h.jsxs)("button",{type:"button",onClick:()=>N(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors",title:"Import hÃ³a Ä‘Æ¡n tá»« file Excel",children:[(0,h.jsx)(R.Upload,{className:"w-4 h-4 mr-2"}),"Import Excel"]}),(0,h.jsxs)("button",{type:"button",onClick:()=>et(0,!0),disabled:r||L||O,className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50",title:"LÃ m má»›i danh sÃ¡ch tá»« database",children:[(0,h.jsx)(t4.RefreshCw,{className:"w-4 h-4 mr-2"}),"LÃ m má»›i"]}),(0,h.jsxs)("button",{type:"button",onClick:es,disabled:!K.fromDate||!K.toDate,className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50",title:`Xuáº¥t Excel tá»« server: ${K.fromDate} Ä‘áº¿n ${K.toDate}`,children:[(0,h.jsx)(D.FileSpreadsheet,{className:"w-4 h-4 mr-2"}),"Xuáº¥t tá»« Server"]}),(0,h.jsxs)("button",{type:"button",onClick:()=>{try{if(0===e.length)return void $.toast.error("KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t");$.toast.loading("ðŸ”„ Äang chuáº©n bá»‹ dá»¯ liá»‡u chi tiáº¿t...",{id:"export-prep"}),console.log("ðŸ“Š Preparing export data for",e,"invoices");let t=e.flatMap(e=>{if(e.details&&e.details.length>0)return e.details.map(t=>{let{details:r,...s}=e;return{nbmst:s.nbmst||s.msttcgp,khmshdon:s.khmshdon,khhdon:s.khmshdon,shdon:s.shdon,cqt:"",tgtcthue:s.tgtcthue,tgtthue:s.tgtthue,tgtttbso:s.tgtttbso,thlap:s.tdlap,ttcktmai:"",tthai:s.tghdon||"",tttbao:"",ttxly:"",dgia:t.dgia,dvtinh:t.dvtinh,ltsuat:t.ltsuat,sluong:t.sluong,ten:t.ten,thtcthue:t.thtcthue,thtien:t.thtien,tlckhau:t.tlckhau,tsuat:t.tsuat,tthue:t.tthue,tgia:t.tgia}});let{details:t,...r}=e;return[{nbmst:r.nbmst||r.msttcgp,khmshdon:r.khmshdon,khhdon:r.khmshdon,shdon:r.shdon,cqt:"",tgtcthue:r.tgtcthue,tgtthue:r.tgtthue,tgtttbso:r.tgtttbso,thlap:r.tdlap,ttcktmai:"",tthai:r.tghdon||"",tttbao:"",ttxly:"",dgia:null,dvtinh:null,ltsuat:null,sluong:null,ten:null,thtcthue:null,thtien:null,tlckhau:null,tsuat:null,tthue:null,tgia:null}]});$.toast.success(`âœ… Ä\xe3 chuáº©n bá»‹ ${t.length} d\xf2ng dá»¯ liá»‡u`,{id:"export-prep"}),console.log("ðŸ“Š Export data prepared:",t.length,"rows (flatmapped by details)"),S(t),T(!0)}catch(e){console.error("âŒ Error preparing export:",e),$.toast.error("Lá»—i khi chuáº©n bá»‹ xuáº¥t Excel",{id:"export-prep"})}},disabled:0===e.length,className:"inline-flex items-center px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50",title:`Xuáº¥t Excel vá»›i xem trÆ°á»›c (${e.length} h\xf3a Ä‘Æ¡n)`,children:[(0,h.jsx)(tB.Eye,{className:"w-4 h-4 mr-2"}),"Xuáº¥t vá»›i Xem trÆ°á»›c",(0,h.jsxs)("span",{className:"ml-1 text-xs opacity-75",children:["(",e.length,")"]})]})]})]})]}),(L||"completed"===_.status||"error"===_.status)&&_.totalInvoices>0&&(0,h.jsx)("div",{className:"mb-6",children:(0,h.jsx)(tY,{progress:_,onClose:()=>B(e=>({...e,status:"idle",totalInvoices:0}))})}),I&&!L&&"idle"===_.status&&(0,h.jsx)("div",{className:"bg-purple-50 border border-purple-200 text-purple-700 px-4 py-3 rounded-lg mb-6",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{className:"font-medium",children:"Tráº¡ng thÃ¡i Ä‘á»“ng bá»™:"}),(0,h.jsx)("span",{className:"ml-2",children:I})]})}),n&&(0,h.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)("span",{className:"font-medium",children:"Lá»—i:"}),(0,h.jsx)("span",{className:"ml-2",children:n})]})}),(0,h.jsx)(p,{invoices:e,loading:r,onRowClick:e=>{c(e),m(!0)},height:700}),(0,h.jsx)(k,{invoice:o,isOpen:d,onClose:()=>{m(!1),c(null)}}),(0,h.jsx)(tq,{isOpen:y,onClose:()=>v(!1),onConfigChanged:()=>{let e=P.getConfig();b(e),er(0,!0),$.toast.success(`Ä\xe3 chuyá»ƒn sang h\xf3a Ä‘Æ¡n ${"banra"===e.invoiceType?"bÃ¡n ra":"mua vÃ o"}`)}}),(0,h.jsx)(F,{isOpen:w,onClose:()=>N(!1),onSuccess:()=>{et(0,!0)}}),(0,h.jsx)(t0,{open:j,onOpenChange:T,invoices:E,fromDate:K.fromDate,toDate:K.toDate})]})})}],633236)}]);