module.exports=[190367,a=>{"use strict";var b=a.i(321248),c=a.i(53627),d=a.i(235746),e=a.i(975780),f=a.i(202979),g=a.i(478184),h=a.i(441405),i=a.i(466577),j=a.i(516482),k=a.i(973174),l=a.i(327987),m=a.i(723593),n=a.i(363615),o=a.i(651332),p=a.i(234211),q=a.i(144932),r=a.i(785694);function s(){let a=(0,c.useParams)(),s=(0,c.useRouter)(),{toast:t}=(0,p.useToast)(),u=a?.id||"",{data:v,loading:w,error:x}=(0,d.useFindUnique)("Course",{id:u},{include:{instructor:{select:{id:!0,firstName:!0,lastName:!0,username:!0}},category:{select:{id:!0,name:!0}}}},{skip:!u||""===u}),{data:y}=(0,d.useFindMany)("CourseCategory",{select:{id:!0,name:!0},orderBy:{name:"asc"}}),{data:z}=(0,d.useFindMany)("User",{where:{roleType:"GIANGVIEN"},select:{id:!0,firstName:!0,lastName:!0,username:!0}}),[A,{loading:B}]=(0,d.useUpdateOne)("Course"),[C,D]=(0,o.useState)({title:"",slug:"",description:"",thumbnail:"",trailer:"",price:"0",level:"BEGINNER",status:"DRAFT",duration:"0",language:"vi",metaTitle:"",metaDescription:"",categoryId:"",instructorId:""}),[E,F]=(0,o.useState)([]),[G,H]=(0,o.useState)([]),[I,J]=(0,o.useState)([]),[K,L]=(0,o.useState)([]),[M,N]=(0,o.useState)(""),[O,P]=(0,o.useState)(""),[Q,R]=(0,o.useState)(""),[S,T]=(0,o.useState)("");(0,o.useEffect)(()=>{v&&(D({title:v.title||"",slug:v.slug||"",description:v.description||"",thumbnail:v.thumbnail||"",trailer:v.trailer||"",price:v.price?.toString()||"0",level:v.level||"BEGINNER",status:v.status||"DRAFT",duration:v.duration?.toString()||"0",language:v.language||"vi",metaTitle:v.metaTitle||"",metaDescription:v.metaDescription||"",categoryId:v.category?.id||"",instructorId:v.instructor?.id||""}),F(v.whatYouWillLearn||[]),H(v.requirements||[]),J(v.targetAudience||[]),L(v.tags||[]))},[v]);let U=(a,b)=>{D(c=>({...c,[a]:b}))},V=a=>a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),W=a=>{"learn"===a&&M.trim()?(F([...E,M.trim()]),N("")):"requirement"===a&&O.trim()?(H([...G,O.trim()]),P("")):"audience"===a&&Q.trim()?(J([...I,Q.trim()]),R("")):"tag"===a&&S.trim()&&(L([...K,S.trim()]),T(""))},X=(a,b)=>{"learn"===a?F(E.filter((a,c)=>c!==b)):"requirement"===a?H(G.filter((a,c)=>c!==b)):"audience"===a?J(I.filter((a,c)=>c!==b)):"tag"===a&&L(K.filter((a,c)=>c!==b))},Y=async a=>{a.preventDefault();try{await A({where:{id:u},data:{title:C.title,slug:C.slug,description:C.description||null,thumbnail:C.thumbnail||null,trailer:C.trailer||null,price:parseFloat(C.price)||0,level:C.level,status:C.status,duration:parseInt(C.duration)||0,language:C.language,metaTitle:C.metaTitle||null,metaDescription:C.metaDescription||null,whatYouWillLearn:E,requirements:G,targetAudience:I,tags:K,categoryId:C.categoryId||null,instructorId:C.instructorId}}),t({title:"Thành công",description:"Đã cập nhật khóa học",type:"success"}),s.push(`/lms/admin/courses/${u}`)}catch(a){t({title:"Lỗi",description:a.message||"Không thể cập nhật khóa học",type:"error"})}},Z=()=>{s.push(`/lms/admin/courses/${u}`)};return w?(0,b.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"text-gray-500 mt-4",children:"Đang tải..."})]})}):x||!v?(0,b.jsx)("div",{className:"p-4 sm:p-6 lg:p-8",children:(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(l.AlertCircle,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-red-600",children:x?.message||"Không tìm thấy khóa học"}),(0,b.jsx)(f.Button,{onClick:()=>s.push("/lms/admin/courses"),className:"mt-4",children:"Quay lại"})]})})}):(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"icon",onClick:Z,children:(0,b.jsx)(j.ArrowLeft,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Chỉnh sửa khóa học"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:v.title})]})]}),(0,b.jsxs)("form",{onSubmit:Y,className:"space-y-6",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Thông tin cơ bản"}),(0,b.jsx)(e.CardDescription,{children:"Cập nhật thông tin khóa học"})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"title",children:"Tiêu đề *"}),(0,b.jsx)(g.Input,{id:"title",value:C.title,onChange:a=>{var b;U("title",b=a.target.value),C.slug&&C.slug!==V(C.title)||U("slug",V(b))},required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"slug",children:"Slug *"}),(0,b.jsx)(g.Input,{id:"slug",value:C.slug,onChange:a=>U("slug",a.target.value),required:!0})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"description",children:"Mô tả"}),(0,b.jsx)(i.Textarea,{id:"description",value:C.description,onChange:a=>U("description",a.target.value),rows:5})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"thumbnail",children:"URL Thumbnail"}),(0,b.jsx)(g.Input,{id:"thumbnail",value:C.thumbnail,onChange:a=>U("thumbnail",a.target.value),placeholder:"https://..."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"trailer",children:"URL Video giới thiệu"}),(0,b.jsx)(g.Input,{id:"trailer",value:C.trailer,onChange:a=>U("trailer",a.target.value),placeholder:"https://..."})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"price",children:"Giá (VND)"}),(0,b.jsx)(g.Input,{id:"price",type:"number",value:C.price,onChange:a=>U("price",a.target.value),min:"0"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"duration",children:"Thời lượng (phút)"}),(0,b.jsx)(g.Input,{id:"duration",type:"number",value:C.duration,onChange:a=>U("duration",a.target.value),min:"0"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"level",children:"Cấp độ"}),(0,b.jsxs)(q.Select,{value:C.level,onValueChange:a=>U("level",a),children:[(0,b.jsx)(q.SelectTrigger,{id:"level",children:(0,b.jsx)(q.SelectValue,{})}),(0,b.jsxs)(q.SelectContent,{children:[(0,b.jsx)(q.SelectItem,{value:"BEGINNER",children:"Cơ bản"}),(0,b.jsx)(q.SelectItem,{value:"INTERMEDIATE",children:"Trung cấp"}),(0,b.jsx)(q.SelectItem,{value:"ADVANCED",children:"Nâng cao"}),(0,b.jsx)(q.SelectItem,{value:"EXPERT",children:"Chuyên gia"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"status",children:"Trạng thái"}),(0,b.jsxs)(q.Select,{value:C.status,onValueChange:a=>U("status",a),children:[(0,b.jsx)(q.SelectTrigger,{id:"status",children:(0,b.jsx)(q.SelectValue,{})}),(0,b.jsxs)(q.SelectContent,{children:[(0,b.jsx)(q.SelectItem,{value:"DRAFT",children:"Nháp"}),(0,b.jsx)(q.SelectItem,{value:"PUBLISHED",children:"Xuất bản"}),(0,b.jsx)(q.SelectItem,{value:"ARCHIVED",children:"Lưu trữ"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"language",children:"Ngôn ngữ"}),(0,b.jsxs)(q.Select,{value:C.language,onValueChange:a=>U("language",a),children:[(0,b.jsx)(q.SelectTrigger,{id:"language",children:(0,b.jsx)(q.SelectValue,{})}),(0,b.jsxs)(q.SelectContent,{children:[(0,b.jsx)(q.SelectItem,{value:"vi",children:"Tiếng Việt"}),(0,b.jsx)(q.SelectItem,{value:"en",children:"English"}),(0,b.jsx)(q.SelectItem,{value:"ja",children:"日本語"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"categoryId",children:"Danh mục"}),(0,b.jsxs)(q.Select,{value:C.categoryId||void 0,onValueChange:a=>U("categoryId",a),children:[(0,b.jsx)(q.SelectTrigger,{id:"categoryId",children:(0,b.jsx)(q.SelectValue,{placeholder:"Chọn danh mục"})}),(0,b.jsx)(q.SelectContent,{children:y?.map(a=>(0,b.jsx)(q.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Nội dung học tập"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(h.Label,{children:"Bạn sẽ học được gì"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Input,{value:M,onChange:a=>N(a.target.value),placeholder:"Nhập mục tiêu học tập...",onKeyPress:a=>"Enter"===a.key&&(a.preventDefault(),W("learn"))}),(0,b.jsx)(f.Button,{type:"button",onClick:()=>W("learn"),size:"icon",children:(0,b.jsx)(m.Plus,{className:"w-4 h-4"})})]}),E.length>0&&(0,b.jsx)("ul",{className:"space-y-2",children:E.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[(0,b.jsx)("span",{className:"flex-1",children:a}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>X("learn",c),children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]},c))})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(h.Label,{children:"Yêu cầu"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Input,{value:O,onChange:a=>P(a.target.value),placeholder:"Nhập yêu cầu...",onKeyPress:a=>"Enter"===a.key&&(a.preventDefault(),W("requirement"))}),(0,b.jsx)(f.Button,{type:"button",onClick:()=>W("requirement"),size:"icon",children:(0,b.jsx)(m.Plus,{className:"w-4 h-4"})})]}),G.length>0&&(0,b.jsx)("ul",{className:"space-y-2",children:G.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[(0,b.jsx)("span",{className:"flex-1",children:a}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>X("requirement",c),children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]},c))})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(h.Label,{children:"Đối tượng học viên"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Input,{value:Q,onChange:a=>R(a.target.value),placeholder:"Nhập đối tượng học viên...",onKeyPress:a=>"Enter"===a.key&&(a.preventDefault(),W("audience"))}),(0,b.jsx)(f.Button,{type:"button",onClick:()=>W("audience"),size:"icon",children:(0,b.jsx)(m.Plus,{className:"w-4 h-4"})})]}),I.length>0&&(0,b.jsx)("ul",{className:"space-y-2",children:I.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[(0,b.jsx)("span",{className:"flex-1",children:a}),(0,b.jsx)(f.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>X("audience",c),children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]},c))})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"SEO & Marketing"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"metaTitle",children:"Meta Title"}),(0,b.jsx)(g.Input,{id:"metaTitle",value:C.metaTitle,onChange:a=>U("metaTitle",a.target.value),maxLength:60}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[C.metaTitle.length,"/60 ký tự"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"metaDescription",children:"Meta Description"}),(0,b.jsx)(i.Textarea,{id:"metaDescription",value:C.metaDescription,onChange:a=>U("metaDescription",a.target.value),maxLength:160,rows:3}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[C.metaDescription.length,"/160 ký tự"]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(h.Label,{children:"Tags"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(g.Input,{value:S,onChange:a=>T(a.target.value),placeholder:"Nhập tag...",onKeyPress:a=>"Enter"===a.key&&(a.preventDefault(),W("tag"))}),(0,b.jsx)(f.Button,{type:"button",onClick:()=>W("tag"),size:"icon",children:(0,b.jsx)(m.Plus,{className:"w-4 h-4"})})]}),K.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:K.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[(0,b.jsx)("span",{children:a}),(0,b.jsx)("button",{type:"button",onClick:()=>X("tag",c),className:"hover:text-blue-900",children:(0,b.jsx)(n.X,{className:"w-3 h-3"})})]},c))})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:Z,children:"Hủy"}),(0,b.jsxs)(f.Button,{type:"submit",disabled:B,className:"gap-2",children:[(0,b.jsx)(k.Save,{className:"w-4 h-4"}),B?"Đang lưu...":"Lưu thay đổi"]})]})]})]})}a.s(["default",()=>s])}];

//# sourceMappingURL=frontend_src_app_lms_admin_courses_%5Bid%5D_edit_page_tsx_c8ef19cf._.js.map