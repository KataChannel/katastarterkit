module.exports=[205365,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(235746),e=a.i(975780),f=a.i(202979),g=a.i(478184),h=a.i(293470),i=a.i(629432),j=a.i(26720),k=a.i(358054),l=a.i(140300),m=a.i(434741),n=a.i(723989),o=a.i(508335),p=a.i(390874),q=a.i(327987),r=a.i(363615),s=a.i(524622),s=s,t=a.i(778775),u=a.i(755820),v=a.i(730705),w=a.i(234211),x=a.i(650661),y=a.i(335558);function z(){let{toast:a}=(0,w.useToast)(),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(""),{data:N=[],loading:O,error:P,refetch:Q}=(0,d.useFindMany)("User",{where:{roleType:"GIANGVIEN"},select:{id:!0,username:!0,email:!0,phone:!0,firstName:!0,lastName:!0,avatar:!0,roleType:!0,isActive:!0,createdAt:!0},include:{coursesInstructed:{select:{id:!0,title:!0,status:!0}},_count:{select:{coursesInstructed:!0}}},orderBy:{createdAt:"desc"}}),{data:R=[],loading:S,refetch:T}=(0,d.useFindMany)("User",{where:{roleType:{not:"GIANGVIEN"}},select:{id:!0,username:!0,email:!0,phone:!0,firstName:!0,lastName:!0,roleType:!0,isActive:!0},orderBy:{createdAt:"desc"}}),[U,{loading:V}]=(0,d.useUpdateOne)("User"),[W,{loading:X}]=(0,d.useDeleteOne)("User"),Y=N.filter(a=>a.username.toLowerCase().includes(z.toLowerCase())||(a.email||"").toLowerCase().includes(z.toLowerCase())||(a.firstName||"").toLowerCase().includes(z.toLowerCase())||(a.lastName||"").toLowerCase().includes(z.toLowerCase())),Z=R.filter(a=>a.username.toLowerCase().includes(B.toLowerCase())||(a.email||"").toLowerCase().includes(B.toLowerCase())||(a.firstName||"").toLowerCase().includes(B.toLowerCase())||(a.lastName||"").toLowerCase().includes(B.toLowerCase())),$=()=>{M(""),C(""),E(!0)},_=async()=>{if(!L)return void a({title:"Lỗi",description:"Vui lòng chọn user để phân quyền",type:"error"});try{await U({where:{id:L},data:{roleType:"GIANGVIEN"}}),a({title:"Thành công",description:"Đã phân quyền giảng viên thành công",type:"success"}),E(!1),M(""),Q(),T()}catch(b){a({title:"Lỗi",description:b.message||"Không thể phân quyền giảng viên",type:"error"})}},aa=async(b,c)=>{try{await U({where:{id:b},data:{isActive:c}}),a({title:"Thành công",description:`Đ\xe3 ${c?"kích hoạt":"vô hiệu hóa"} t\xe0i khoản`,type:"success"}),Q()}catch(b){a({title:"Lỗi",description:b.message||"Không thể cập nhật trạng thái",type:"error"})}},ab=async()=>{if(J)try{await U({where:{id:J.id},data:{roleType:"USER"}}),a({title:"Thành công",description:"Đã thu hồi quyền giảng viên",type:"success"}),I(!1),K(null),Q(),T()}catch(b){a({title:"Lỗi",description:b.message||"Không thể thu hồi quyền",type:"error"})}},ac=a=>a.firstName&&a.lastName?`${a.firstName} ${a.lastName}`:a.username,ad=a=>{switch(a){case"ADMIN":return"bg-red-100 text-red-800 border-red-300";case"GIANGVIEN":return"bg-blue-100 text-blue-800 border-blue-300";case"USER":return"bg-green-100 text-green-800 border-green-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Quản lý giảng viên"}),(0,b.jsxs)("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:["Tổng cộng ",N.length," giảng viên | ",R.length," user có thể phân quyền"]})]}),(0,b.jsxs)(f.Button,{onClick:$,className:"gap-2",children:[(0,b.jsx)(s.default,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Phân quyền giảng viên"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Phân quyền"})]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)(g.Input,{placeholder:"Tìm kiếm giảng viên...",value:z,onChange:a=>A(a.target.value),className:"pl-10"})]}),O?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"text-gray-500 mt-4",children:"Đang tải..."})]}):P?(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(q.AlertCircle,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,b.jsxs)("p",{className:"text-red-600",children:["Lỗi: ",P.message]})]})}):0===Y.length?(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(k.Users,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Không tìm thấy giảng viên nào"}),(0,b.jsxs)(f.Button,{onClick:$,className:"mt-4 gap-2",children:[(0,b.jsx)(s.default,{className:"w-4 h-4"}),"Phân quyền user làm giảng viên"]})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Y.map(a=>(0,b.jsxs)(e.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg",children:a.username.charAt(0).toUpperCase()}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2 flex-wrap",children:[ac(a),a.isActive?(0,b.jsx)(o.CheckCircle,{className:"w-4 h-4 text-green-500"}):(0,b.jsx)(p.XCircle,{className:"w-4 h-4 text-red-500"})]}),(0,b.jsxs)(e.CardDescription,{className:"mt-1",children:[(0,b.jsxs)(h.Badge,{className:ad(a.roleType),children:[(0,b.jsx)(t.Shield,{className:"w-3 h-3 mr-1"}),"GIẢNG VIÊN"]}),(0,b.jsxs)("span",{className:"text-xs ml-2",children:["@",a.username]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(x.Switch,{checked:a.isActive,onCheckedChange:b=>aa(a.id,b)})})]}),(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(n.MoreVertical,{className:"w-4 h-4"})})]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(l.Mail,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:a.email})]}),a.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,b.jsx)(m.Phone,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:a.phone})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6 pt-3 border-t",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.BookOpen,{className:"w-5 h-5 text-blue-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xl font-bold",children:a._count?.coursesInstructed||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Khóa học"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Users,{className:"w-5 h-5 text-green-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xl font-bold",children:"0"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Học viên"})]})]})]}),a.coursesInstructed&&a.coursesInstructed.length>0&&(0,b.jsxs)("div",{className:"pt-3 border-t",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Khóa học đang dạy:"}),(0,b.jsxs)("div",{className:"space-y-1",children:[a.coursesInstructed.slice(0,3).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600 truncate flex-1",children:a.title}),(0,b.jsx)(h.Badge,{variant:"PUBLISHED"===a.status?"default":"secondary",className:"ml-2 text-xs",children:"PUBLISHED"===a.status?"Public":"Draft"})]},a.id)),a.coursesInstructed.length>3&&(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["+",a.coursesInstructed.length-3," khóa khác"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 pt-3 border-t",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"flex-1 gap-2",children:[(0,b.jsx)(j.BookOpen,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Khóa học"}),(0,b.jsxs)("span",{className:"sm:hidden",children:["Khóa học (",a._count?.coursesInstructed||0,")"]})]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 gap-2",onClick:()=>{K(a),I(!0)},children:[(0,b.jsx)(p.XCircle,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Thu hồi"})]})]})]})]},a.id))}),(0,b.jsx)(u.Dialog,{open:D,onOpenChange:E,children:(0,b.jsxs)(u.DialogContent,{className:"max-w-3xl max-h-[90vh] flex flex-col",children:[(0,b.jsxs)(u.DialogHeader,{children:[(0,b.jsxs)(u.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.default,{className:"w-5 h-5"}),"Phân quyền giảng viên"]}),(0,b.jsxs)(u.DialogDescription,{children:["Chọn user từ hệ thống để phân quyền làm giảng viên. Có ",R.length," user khả dụng."]})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col",children:[(0,b.jsx)("div",{className:"px-1 pb-3",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)(g.Input,{placeholder:"Tìm kiếm user...",value:B,onChange:a=>C(a.target.value),className:"pl-10"})]})}),(0,b.jsx)(y.ScrollArea,{className:"flex-1 px-1",children:(0,b.jsx)("div",{className:"space-y-2 pr-4",children:S?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Đang tải..."}):0===Z.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Không tìm thấy user nào"}):Z.map(a=>(0,b.jsx)("div",{onClick:()=>M(a.id),className:`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${L===a.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h4",{className:"font-semibold text-sm truncate",children:ac(a)}),(0,b.jsx)(h.Badge,{className:ad(a.roleType),variant:"outline",children:a.roleType})]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 mb-2",children:["@",a.username]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[a.email&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.Mail,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"truncate",children:a.email})]}),a.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Phone,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:a.phone})]})]})]}),L===a.id&&(0,b.jsx)(o.CheckCircle,{className:"w-5 h-5 text-blue-500 flex-shrink-0"})]})},a.id))})})]}),(0,b.jsxs)(u.DialogFooter,{className:"gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{E(!1),M(""),C("")},disabled:V,children:[(0,b.jsx)(r.X,{className:"w-4 h-4 mr-2"}),"Hủy"]}),(0,b.jsxs)(f.Button,{onClick:_,disabled:V||!L,children:[(0,b.jsx)(t.Shield,{className:"w-4 h-4 mr-2"}),V?"Đang phân quyền...":"Phân quyền"]})]})]})}),(0,b.jsx)(v.AlertDialog,{open:H,onOpenChange:I,children:(0,b.jsxs)(v.AlertDialogContent,{children:[(0,b.jsxs)(v.AlertDialogHeader,{children:[(0,b.jsx)(v.AlertDialogTitle,{children:"Thu hồi quyền giảng viên"}),(0,b.jsxs)(v.AlertDialogDescription,{children:["Bạn có chắc chắn muốn thu hồi quyền giảng viên của"," ",(0,b.jsx)("span",{className:"font-semibold",children:J?ac(J):""}),"?",(0,b.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded text-blue-800 text-sm",children:[(0,b.jsx)(q.AlertCircle,{className:"w-4 h-4 inline mr-2"}),"User sẽ được chuyển về quyền ",(0,b.jsx)("strong",{children:"USER"})," thông thường."]}),J&&J._count?.coursesInstructed>0&&(0,b.jsxs)("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded text-yellow-800 text-sm",children:[(0,b.jsx)(q.AlertCircle,{className:"w-4 h-4 inline mr-2"}),"Giảng viên này đang dạy ",(0,b.jsxs)("strong",{children:[J._count.coursesInstructed," khóa học"]}),"!"]})]})]}),(0,b.jsxs)(v.AlertDialogFooter,{children:[(0,b.jsx)(v.AlertDialogCancel,{children:"Hủy"}),(0,b.jsx)(v.AlertDialogAction,{onClick:ab,disabled:V,className:"bg-red-600 hover:bg-red-700",children:V?"Đang thu hồi...":"Thu hồi quyền"})]})]})})]})}a.s(["default",()=>z],205365)}];

//# sourceMappingURL=frontend_src_app_lms_admin_instructors_page_tsx_d1018c2d._.js.map