module.exports=[164558,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(772213),e=a.i(168918),f=a.i(8912),g=a.i(975780),h=a.i(202979),i=a.i(293470),j=a.i(951369),k=a.i(478184),l=a.i(441405),m=a.i(144932),n=a.i(755820),o=a.i(650661),p=a.i(335558),q=a.i(976762),r=a.i(434741),s=a.i(435494),s=s,t=a.i(988349),t=t,u=a.i(515678),v=a.i(325521),w=a.i(321279),x=a.i(733554),y=a.i(508335),z=a.i(390874),A=a.i(411185),B=a.i(128348),C=a.i(519732),D=a.i(966565),D=D,E=a.i(510071),F=a.i(300827),G=a.i(509423),H=a.i(585291),I=a.i(377194),J=a.i(189101),K=a.i(788758),L=a.i(235746),M=a.i(769056);let N=d.gql`
  mutation SyncCallCenterData($input: SyncCallCenterInput) {
    syncCallCenterData(input: $input) {
      success
      message
      syncLogId
      recordsFetched
      recordsCreated
      recordsUpdated
      error
    }
  }
`;function O({recordPath:a,domain:d}){let[e,f]=(0,c.useState)(!1),[g,i]=(0,c.useState)(0),[j,k]=(0,c.useState)(0),l=(0,c.useRef)(null);if((0,c.useEffect)(()=>{let a=l.current;if(!a)return;let b=()=>i(a.currentTime),c=()=>k(a.duration);return a.addEventListener("timeupdate",b),a.addEventListener("loadedmetadata",c),a.addEventListener("durationchange",c),()=>{a.removeEventListener("timeupdate",b),a.removeEventListener("loadedmetadata",c),a.removeEventListener("durationchange",c)}},[]),!a)return(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:"KhÃ´ng cÃ³ recording"});let m=`https://pbx01.onepos.vn:8080/recordings${a}`,n=a=>{if(isNaN(a))return"0:00";let b=Math.floor(a/60),c=Math.floor(a%60);return`${b}:${c.toString().padStart(2,"0")}`};return(0,b.jsxs)("div",{className:"flex flex-col gap-1 min-w-[120px]",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.Button,{size:"sm",variant:"ghost",onClick:()=>{l.current&&(e?l.current.pause():l.current.play(),f(!e))},className:"h-8 w-8 p-0",children:e?(0,b.jsx)(D.default,{className:"h-4 w-4"}):(0,b.jsx)(w.Play,{className:"h-4 w-4"})}),(0,b.jsx)("audio",{ref:l,src:m,onEnded:()=>f(!1),onPlay:()=>f(!0),onPause:()=>f(!1)}),(0,b.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline",children:"Táº£i vá»"})]}),j>0&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground font-mono",children:[n(g)," / ",n(j)]})]})}function P({open:a,onClose:d,syncLogId:f,initialStats:g}){let[i,j]=(0,c.useState)([]),[k,m]=(0,c.useState)(g||{recordsFetched:0,recordsCreated:0,recordsUpdated:0,recordsSkipped:0,status:"running"}),o=(0,c.useRef)(null),{data:r,startPolling:s,stopPolling:t}=(0,e.useQuery)(M.FIND_UNIQUE,{variables:{model:"callCenterSyncLog",where:{id:f||""}},skip:!f||!a,fetchPolicy:"network-only"}),u=r?.findUnique;(0,c.useEffect)(()=>{a&&f?j([`[${new Date().toLocaleTimeString("vi-VN")}] Báº¯t Ä‘áº§u Ä‘á»“ng bá»™ dá»¯ liá»‡u...`]):(j([]),m({recordsFetched:0,recordsCreated:0,recordsUpdated:0,recordsSkipped:0,status:"running"}))},[a,f]),(0,c.useEffect)(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},[i]),(0,c.useEffect)(()=>{if(u){let a={recordsFetched:u.recordsFetched||0,recordsCreated:u.recordsCreated||0,recordsUpdated:u.recordsUpdated||0,recordsSkipped:u.recordsSkipped||0,status:u.status||"running"},b=k.recordsFetched;u.recordsFetched>b&&j(a=>[...a,`[${new Date().toLocaleTimeString("vi-VN")}] Ä\xe3 táº£i ${u.recordsFetched} records tá»« PBX API...`]),u.recordsCreated>k.recordsCreated&&j(a=>[...a,`[${new Date().toLocaleTimeString("vi-VN")}] âœ… Táº¡o má»›i ${u.recordsCreated} records...`]),u.recordsUpdated>k.recordsUpdated&&j(a=>[...a,`[${new Date().toLocaleTimeString("vi-VN")}] ðŸ”„ Cáº­p nháº­t ${u.recordsUpdated} records...`]),"success"===u.status&&"success"!==k.status&&j(a=>[...a,`[${new Date().toLocaleTimeString("vi-VN")}] âœ¨ Äá»“ng bá»™ ho\xe0n th\xe0nh th\xe0nh c\xf4ng!`]),"failed"===u.status&&"failed"!==k.status&&j(a=>[...a,`[${new Date().toLocaleTimeString("vi-VN")}] âŒ Äá»“ng bá»™ tháº¥t báº¡i: ${u.errorMessage||"Unknown error"}`]),m(a)}},[u]);let v=k.recordsFetched>0?(k.recordsCreated+k.recordsUpdated)/k.recordsFetched*100:0,w="success"===k.status||"failed"===k.status;return(0,b.jsx)(n.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(n.DialogContent,{className:"sm:max-w-[600px]",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsxs)(n.DialogTitle,{className:"flex items-center gap-2",children:[!w&&(0,b.jsx)(x.Loader2,{className:"h-4 w-4 animate-spin"}),"success"===k.status&&(0,b.jsx)(y.CheckCircle,{className:"h-4 w-4 text-green-600"}),"failed"===k.status&&(0,b.jsx)(z.XCircle,{className:"h-4 w-4 text-red-600"}),"Tiáº¿n trÃ¬nh Ä‘á»“ng bá»™"]}),(0,b.jsxs)(n.DialogDescription,{children:["running"===k.status&&"Äang Ä‘á»“ng bá»™ dá»¯ liá»‡u tá»« PBX API...","success"===k.status&&"Äá»“ng bá»™ hoÃ n thÃ nh thÃ nh cÃ´ng!","failed"===k.status&&"Äá»“ng bá»™ tháº¥t báº¡i!"]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Tiáº¿n trÃ¬nh"}),(0,b.jsxs)("span",{className:"font-semibold",children:[Math.round(v),"%"]})]}),(0,b.jsx)(q.Progress,{value:v})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:k.recordsFetched}),(0,b.jsx)("div",{className:"text-xs text-blue-600",children:"ÄÃ£ táº£i tá»« API"})]}),(0,b.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-700",children:k.recordsCreated}),(0,b.jsx)("div",{className:"text-xs text-green-600",children:"Táº¡o má»›i"})]}),(0,b.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:k.recordsUpdated}),(0,b.jsx)("div",{className:"text-xs text-yellow-600",children:"Cáº­p nháº­t"})]}),(0,b.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-700",children:k.recordsSkipped}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Bá» qua"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Logs (Real-time)"}),(0,b.jsxs)(p.ScrollArea,{ref:o,className:"h-[200px] w-full rounded-md border bg-slate-950 p-4",children:[i.map((a,c)=>(0,b.jsx)("div",{className:"text-xs text-green-400 font-mono mb-1",children:a},c)),0===i.length&&(0,b.jsx)("div",{className:"text-xs text-gray-500 font-mono",children:"Äang chá» logs..."})]})]})]}),(0,b.jsx)(n.DialogFooter,{children:(0,b.jsx)(h.Button,{onClick:d,variant:w?"default":"outline",children:w?"ÄÃ³ng":"Cháº¡y ná»n"})})]})})}function Q(){let[a,d]=(0,c.useState)("records"),[e,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[w,y]=(0,c.useState)(null),[D,M]=(0,c.useState)({}),[Q,T]=(0,c.useState)({page:1,limit:20}),[U,V]=(0,c.useState)({fromDate:"",toDate:""}),{data:W=[],loading:X,refetch:Y}=(0,L.useFindMany)("callCenterConfig",{take:1}),Z=W[0]||null,{data:$,loading:_,refetch:aa}=(0,L.useFindMany)("callCenterRecord",{where:D,skip:(Q.page-1)*Q.limit,take:Q.limit,orderBy:{startEpoch:"desc"}}),ab=$?{items:Array.isArray($)?$:[],pagination:{currentPage:Q.page,totalPages:Math.ceil((Array.isArray($)?$.length:0)/Q.limit),totalItems:Array.isArray($)?$.length:0,hasNextPage:Array.isArray($)&&$.length===Q.limit,hasPreviousPage:Q.page>1}}:null,{data:ac=[],loading:ad,refetch:ae}=(0,L.useFindMany)("callCenterSyncLog",{take:10,orderBy:{startedAt:"desc"}}),[af,{loading:ag}]=(0,f.useMutation)(N),[ah,{loading:ai}]=(0,L.useUpdateOne)("callCenterConfig"),[aj,{loading:ak}]=(0,L.useCreateOne)("callCenterConfig"),al=async()=>{try{let a=await af({variables:{input:{}}});a.data.syncCallCenterData.success?(q(a.data.syncCallCenterData.syncLogId),y({recordsFetched:0,recordsCreated:0,recordsUpdated:0,recordsSkipped:0,status:"running"}),o(!0)):J.toast.error("Sync tháº¥t báº¡i",{description:a.data.syncCallCenterData.error})}catch(a){J.toast.error("Sync error",{description:a.message})}},am=async()=>{if(!U.fromDate||!U.toDate)return void J.toast.error("Vui lÃ²ng chá»n khoáº£ng ngÃ y");try{m(!1);let a=await af({variables:{input:{fromDate:U.fromDate,toDate:U.toDate}}});a.data.syncCallCenterData.success?(q(a.data.syncCallCenterData.syncLogId),y({recordsFetched:0,recordsCreated:0,recordsUpdated:0,recordsSkipped:0,status:"running"}),o(!0)):J.toast.error("Sync tháº¥t báº¡i",{description:a.data.syncCallCenterData.error})}catch(a){J.toast.error("Sync error",{description:a.message})}},an=async a=>{try{Z?.id?(await ah({where:{id:Z.id},data:a}),J.toast.success("Cáº­p nháº­t config thÃ nh cÃ´ng")):(await aj({data:{apiUrl:"https://pbx01.onepos.vn:8080/api/v2/cdrs",domain:"tazaspa102019",...a}}),J.toast.success("Táº¡o config thÃ nh cÃ´ng")),await Y(),k(!1)}catch(a){console.error("Config operation error:",a),J.toast.error("Config operation failed",{description:a.message})}},ao=a=>{if(!a)return"0s";let b=parseInt(a),c=Math.floor(b/60),d=b%60;return c>0?`${c}m ${d}s`:`${d}s`},ap=[{field:"direction",headerName:"Direction",width:120,sortable:!0,cellRenderer:a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{switch(a){case"INBOUND":return(0,b.jsx)(s.default,{className:"h-4 w-4 text-blue-600"});case"OUTBOUND":return(0,b.jsx)(t.default,{className:"h-4 w-4 text-green-600"});case"LOCAL":return(0,b.jsx)(r.Phone,{className:"h-4 w-4 text-purple-600"});default:return(0,b.jsx)(r.Phone,{className:"h-4 w-4"})}})(a.value),(0,b.jsx)("span",{className:"text-xs",children:a.value})]})},{field:"callerIdNumber",headerName:"Caller",width:130,sortable:!0,cellRenderer:a=>(0,b.jsx)("div",{className:"font-mono text-sm",children:a.value})},{field:"destinationNumber",headerName:"Destination",width:130,sortable:!0,cellRenderer:a=>(0,b.jsx)("div",{className:"font-mono text-sm",children:a.value})},{field:"startEpoch",headerName:"Start Time",width:180,sortable:!0,cellRenderer:a=>(0,b.jsx)("div",{className:"text-sm",children:(a=>{if(!a||"0"===a)return"N/A";let b=new Date(1e3*parseInt(a));return(0,H.format)(b,"dd/MM/yyyy HH:mm:ss",{locale:I.vi})})(a.value)})},{field:"duration",headerName:"Duration",width:120,sortable:!0,cellRenderer:a=>(0,b.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,b.jsxs)("span",{children:["Total: ",ao(a.value)]}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Talk: ",ao(a.data.billsec)]})]})},{field:"callStatus",headerName:"Status",width:120,sortable:!0,cellRenderer:a=>{var c;let d;return d=({ANSWER:{variant:"default",label:"Answered"},CANCELED:{variant:"secondary",label:"Canceled"},BUSY:{variant:"destructive",label:"Busy"},NO_ANSWER:{variant:"outline",label:"No Answer"},FAILED:{variant:"destructive",label:"Failed"},UNKNOWN:{variant:"outline",label:"Unknown"}})[c=a.value]||{variant:"outline",label:c},(0,b.jsx)(i.Badge,{variant:d.variant,children:d.label})}},{field:"recordPath",headerName:"Recording",width:180,cellRenderer:a=>(0,b.jsx)(O,{recordPath:a.value,domain:a.data.domain})}];return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Call Center"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Quáº£n lÃ½ dá»¯ liá»‡u cuá»™c gá»i tá»« PBX"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>k(!0),children:[(0,b.jsx)(v.Settings,{className:"mr-2 h-4 w-4"}),"Cáº¥u hÃ¬nh"]}),(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>m(!0),disabled:!Z?.isActive,children:[(0,b.jsx)(B.Calendar,{className:"mr-2 h-4 w-4"}),"Chá»n ngÃ y sync"]}),(0,b.jsxs)(h.Button,{onClick:al,disabled:ag||!Z?.isActive,children:[ag?(0,b.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(C.RefreshCw,{className:"mr-2 h-4 w-4"}),"Sync Ngay"]})]})]}),Z&&!Z.isActive&&(0,b.jsx)(g.Card,{className:"border-orange-200 bg-orange-50",children:(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"text-orange-800 flex items-center gap-2",children:[(0,b.jsx)(z.XCircle,{className:"h-5 w-5"}),"ChÆ°a kÃ­ch hoáº¡t"]}),(0,b.jsx)(g.CardDescription,{className:"text-orange-700",children:"Call Center chÆ°a Ä‘Æ°á»£c kÃ­ch hoáº¡t. Vui lÃ²ng báº­t trong pháº§n cáº¥u hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng Ä‘á»“ng bá»™."})]})}),Z&&Z.isActive&&(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Tá»•ng Records"}),(0,b.jsx)(r.Phone,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:Z.totalRecordsSynced||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ÄÃ£ Ä‘á»“ng bá»™"})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Sync Mode"}),(0,b.jsx)(A.Clock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:Z.syncMode}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:Z.isActive?"Active":"Inactive"})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Last Sync"}),(0,b.jsx)(B.Calendar,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-sm font-bold",children:Z.lastSyncAt?(0,G.formatDistanceToNow)(new Date(Z.lastSyncAt),{addSuffix:!0,locale:I.vi}):"ChÆ°a sync"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:Z.lastSyncStatus})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Batch Size"}),(0,b.jsx)(u.Download,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:Z.batchSize}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"records/request"})]})]})]}),(0,b.jsxs)(j.Tabs,{value:a,onValueChange:d,children:[(0,b.jsxs)(j.TabsList,{children:[(0,b.jsx)(j.TabsTrigger,{value:"records",children:"Call Records"}),(0,b.jsx)(j.TabsTrigger,{value:"logs",children:"Sync Logs"})]}),(0,b.jsxs)(j.TabsContent,{value:"records",className:"space-y-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Danh sÃ¡ch cuá»™c gá»i"}),(0,b.jsxs)(g.CardDescription,{children:["Hiá»ƒn thá»‹ ",ab?.pagination.totalItems||0," cuá»™c gá»i"]})]}),(0,b.jsx)(g.CardContent,{className:"p-0",children:_?(0,b.jsx)("div",{className:"flex justify-center p-8",children:(0,b.jsx)(x.Loader2,{className:"h-8 w-8 animate-spin"})}):(0,b.jsx)(K.AdvancedTable,{columns:ap,data:ab?.items||[],config:{enableSorting:!0,enableFiltering:!0,enableColumnPinning:!1,enableColumnResizing:!0,enableColumnHiding:!0,enableRowSelection:!1,enableInlineEditing:!1,enableRowDeletion:!1,showToolbar:!0,showPagination:!1},height:600})})]}),ab?.pagination&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Trang ",ab.pagination.currentPage," / ",ab.pagination.totalPages]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>T({...Q,page:Q.page-1}),disabled:!ab.pagination.hasPreviousPage,children:[(0,b.jsx)(E.ChevronLeft,{className:"h-4 w-4"}),"TrÆ°á»›c"]}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",onClick:()=>T({...Q,page:Q.page+1}),disabled:!ab.pagination.hasNextPage,children:["Sau",(0,b.jsx)(F.ChevronRight,{className:"h-4 w-4"})]})]})]})]}),(0,b.jsx)(j.TabsContent,{value:"logs",className:"space-y-4",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Lá»‹ch sá»­ Ä‘á»“ng bá»™"})}),(0,b.jsx)(g.CardContent,{children:ad?(0,b.jsx)("div",{className:"flex justify-center p-8",children:(0,b.jsx)(x.Loader2,{className:"h-8 w-8 animate-spin"})}):(0,b.jsx)("div",{className:"space-y-4",children:ac?.map(a=>(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold",children:a.syncType}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,H.format)(new Date(a.startedAt),"dd/MM/yyyy HH:mm:ss",{locale:I.vi})})]}),(0,b.jsx)(i.Badge,{variant:"success"===a.status?"default":"destructive",children:a.status})]}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Fetched"}),(0,b.jsx)("div",{className:"font-semibold",children:a.recordsFetched})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Created"}),(0,b.jsx)("div",{className:"font-semibold text-green-600",children:a.recordsCreated})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Updated"}),(0,b.jsx)("div",{className:"font-semibold text-blue-600",children:a.recordsUpdated})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Skipped"}),(0,b.jsx)("div",{className:"font-semibold text-gray-600",children:a.recordsSkipped})]})]}),a.duration&&(0,b.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Duration: ",(a.duration/1e3).toFixed(2),"s"]})]})},a.id))})})]})})]}),(0,b.jsx)(R,{open:l,onClose:()=>m(!1),dateRange:U,setDateRange:V,onSync:am,loading:ag}),(0,b.jsx)(S,{open:e,onClose:()=>k(!1),config:Z,onSave:an,loading:ai||ak}),(0,b.jsx)(P,{open:n,onClose:()=>{o(!1),aa(),ae(),Y()},syncLogId:p,initialStats:w})]})}function R({open:a,onClose:c,dateRange:d,setDateRange:e,onSync:f,loading:g}){return(0,b.jsx)(n.Dialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(n.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsx)(n.DialogTitle,{children:"Chá»n khoáº£ng thá»i gian Ä‘á»“ng bá»™"}),(0,b.jsx)(n.DialogDescription,{children:"Chá»n khoáº£ng ngÃ y Ä‘á»ƒ láº¥y dá»¯ liá»‡u cuá»™c gá»i tá»« PBX"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Quick Select"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:[{label:"1 ngÃ y qua",days:1},{label:"7 ngÃ y qua",days:7},{label:"15 ngÃ y qua",days:15},{label:"30 ngÃ y qua",days:30},{label:"90 ngÃ y qua",days:90}].map(a=>(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>{var b;let c,d;return b=a.days,c=new Date,void((d=new Date).setDate(d.getDate()-b),e({fromDate:d.toISOString().split("T")[0],toDate:c.toISOString().split("T")[0]}))},children:a.label},a.days))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Tá»« ngÃ y"}),(0,b.jsx)(k.Input,{type:"date",value:d.fromDate,onChange:a=>e({...d,fromDate:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Äáº¿n ngÃ y"}),(0,b.jsx)(k.Input,{type:"date",value:d.toDate,onChange:a=>e({...d,toDate:a.target.value})})]})]}),d.fromDate&&d.toDate&&(0,b.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,b.jsxs)("p",{className:"text-sm text-blue-800",children:["Sáº½ Ä‘á»“ng bá»™ dá»¯ liá»‡u tá»« ",(0,H.format)(new Date(d.fromDate),"dd/MM/yyyy",{locale:I.vi})," Ä‘áº¿n"," ",(0,H.format)(new Date(d.toDate),"dd/MM/yyyy",{locale:I.vi})]})})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:c,children:"Há»§y"}),(0,b.jsxs)(h.Button,{onClick:f,disabled:g||!d.fromDate||!d.toDate,children:[g&&(0,b.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),(0,b.jsx)(C.RefreshCw,{className:"mr-2 h-4 w-4"}),"Äá»“ng bá»™"]})]})]})})}function S({open:a,onClose:d,config:e,onSave:f,loading:g}){let[i,j]=(0,c.useState)({syncMode:e?.syncMode||"MANUAL",cronExpression:e?.cronExpression||"",isActive:e?.isActive??!0,defaultDaysBack:e?.defaultDaysBack||30,batchSize:e?.batchSize||200});(0,c.useEffect)(()=>{a&&e&&j({syncMode:e.syncMode||"MANUAL",cronExpression:e.cronExpression||"",isActive:e.isActive??!0,defaultDaysBack:e.defaultDaysBack||30,batchSize:e.batchSize||200})},[a,e]);let p=!e?.id;return(0,b.jsx)(n.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(n.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsx)(n.DialogTitle,{children:p?"Táº¡o cáº¥u hÃ¬nh Call Center":"Cáº­p nháº­t cáº¥u hÃ¬nh Call Center"}),(0,b.jsx)(n.DialogDescription,{children:p?"Thiáº¿t láº­p cáº¥u hÃ¬nh Ä‘á»“ng bá»™ dá»¯ liá»‡u tá»« PBX láº§n Ä‘áº§u":"CÃ i Ä‘áº·t Ä‘á»“ng bá»™ dá»¯ liá»‡u tá»« PBX"})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(l.Label,{htmlFor:"isActive",children:"KÃ­ch hoáº¡t"}),(0,b.jsx)(o.Switch,{id:"isActive",checked:i.isActive,onCheckedChange:a=>j({...i,isActive:a})})]}),!i.isActive&&(0,b.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,b.jsx)("p",{className:"text-sm text-yellow-800",children:'âš ï¸ Báº­t "KÃ­ch hoáº¡t" Ä‘á»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng Ä‘á»“ng bá»™'})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Cháº¿ Ä‘á»™ Ä‘á»“ng bá»™"}),(0,b.jsxs)(m.Select,{value:i.syncMode,onValueChange:a=>j({...i,syncMode:a}),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{})}),(0,b.jsxs)(m.SelectContent,{children:[(0,b.jsx)(m.SelectItem,{value:"MANUAL",children:"Manual"}),(0,b.jsx)(m.SelectItem,{value:"SCHEDULED",children:"Scheduled (Cron)"})]})]})]}),"SCHEDULED"===i.syncMode&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Cron Expression"}),(0,b.jsx)(k.Input,{placeholder:"0 */5 * * * * (Every 5 minutes)",value:i.cronExpression,onChange:a=>j({...i,cronExpression:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:'Example: "0 */5 * * * *" = Every 5 minutes'})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Sá»‘ ngÃ y láº¥y dá»¯ liá»‡u"}),(0,b.jsx)(k.Input,{type:"number",value:i.defaultDaysBack,onChange:a=>j({...i,defaultDaysBack:parseInt(a.target.value)})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{children:"Batch Size (records/request)"}),(0,b.jsx)(k.Input,{type:"number",value:i.batchSize,onChange:a=>j({...i,batchSize:parseInt(a.target.value)})})]})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:d,children:"Há»§y"}),(0,b.jsxs)(h.Button,{onClick:()=>{f(i)},disabled:g,children:[g&&(0,b.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),p?"Táº¡o":"LÆ°u"]})]})]})})}a.s(["default",()=>Q],164558)}];

//# sourceMappingURL=frontend_src_app_admin_callcenter_page_tsx_67147011._.js.map