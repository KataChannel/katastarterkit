module.exports=[809548,111398,315431,530312,608659,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(975780),e=a.i(293470),f=a.i(202979),g=a.i(951369),h=a.i(976762),i=a.i(359379),j=a.i(653107),k=a.i(323577),l=a.i(57597),m=a.i(358054),n=a.i(231910),o=a.i(891026),p=a.i(723593),q=a.i(12979),r=a.i(128348),s=a.i(395992),t=a.i(235746);function u({className:a=""}){let[u,v]=(0,c.useState)("30d"),{data:w,loading:x,error:y}=(0,t.useFindUnique)("affiliateUser",{where:{userId:"CURRENT_USER_ID"}}),{data:z=[],loading:A}=(0,t.useFindMany)("affiliateLink",{where:{userId:"CURRENT_USER_ID"},take:10,orderBy:{createdAt:"desc"},include:{campaign:!0}}),{data:B=[],loading:C}=(0,t.useFindMany)("affiliateCampaign",{where:{status:"ACTIVE"},take:10,orderBy:{createdAt:"desc"}});if(!x&&!w)return(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsxs)(d.Card,{className:"max-w-2xl mx-auto",children:[(0,b.jsxs)(d.CardHeader,{className:"text-center",children:[(0,b.jsx)(d.CardTitle,{className:"text-2xl",children:"Chào mừng đến Chương Trình Affiliate"}),(0,b.jsx)(d.CardDescription,{children:"Tham gia chương trình affiliate và bắt đầu kiếm hoa hồng bằng cách quảng bá sản phẩm của chúng tôi."})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(j.DollarSign,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Kiếm Hoa Hồng"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Lên đến 30% mỗi đơn hàng"})]}),(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(o.BarChart3,{className:"h-8 w-8 mx-auto mb-2 text-blue-500"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Phân Tích Thời Gian Thực"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Theo dõi hiệu suất của bạn"})]}),(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsx)(s.Target,{className:"h-8 w-8 mx-auto mb-2 text-purple-500"}),(0,b.jsx)("h3",{className:"font-semibold",children:"Nhiều Chiến Dịch"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chọn những gì quảng bá"})]})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsxs)(f.Button,{size:"lg",className:"w-full max-w-xs",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tham Gia Chương Trình Affiliate"]})})]})]})});if(x)return(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"animate-pulse",children:[(0,b.jsx)("div",{className:"h-4 bg-muted rounded w-1/2 mb-2"}),(0,b.jsx)("div",{className:"h-8 bg-muted rounded w-3/4"})]})})},c))})});if(y)return(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsx)(i.Alert,{children:(0,b.jsx)(i.AlertDescription,{children:"Không thể tải dữ liệu affiliate. Vui lòng thử lại."})})});let D={totalEarnings:w?.totalEarnings||0,totalClicks:w?.totalClicks||0,totalConversions:w?.totalConversions||0,conversionRate:w?.conversionRate||0,activeLinks:z.filter(a=>a.isActive).length,activeCampaigns:B.length,averageOrderValue:w?.averageOrderValue||0,pendingCommissions:z.reduce((a,b)=>a+(b.commission||0),0)};return(0,b.jsxs)("div",{className:`p-6 ${a}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Bảng Điều Khiển Affiliate"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[w?.businessName||"Chào mừng trở lại"," • ",w?.role]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Badge,{variant:w?.status==="ACTIVE"?"default":"secondary",children:w?.status}),w?.isVerified&&(0,b.jsx)(e.Badge,{variant:"outline",className:"text-green-600 border-green-600",children:"Đã xác minh"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Thu Nhập"}),(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",D.totalEarnings.toFixed(2)]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"+12% so với tháng trước"})]}),(0,b.jsx)(j.DollarSign,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Lượt Click"}),(0,b.jsx)("div",{className:"text-2xl font-bold",children:D.totalClicks.toLocaleString()}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"+8% so với tháng trước"})]}),(0,b.jsx)(k.MousePointer,{className:"h-8 w-8 text-blue-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Chuyển Đổi"}),(0,b.jsx)("div",{className:"text-2xl font-bold",children:D.totalConversions}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Tỷ lệ ",D.conversionRate.toFixed(1),"%"]})]}),(0,b.jsx)(l.TrendingUp,{className:"h-8 w-8 text-purple-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Links Hoạt Động"}),(0,b.jsx)("div",{className:"text-2xl font-bold",children:D.activeLinks}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[D.activeCampaigns," chiến dịch"]})]}),(0,b.jsx)(n.Link2,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,b.jsxs)(g.Tabs,{defaultValue:"overview",className:"space-y-6",children:[(0,b.jsxs)(g.TabsList,{className:"grid w-full grid-cols-4",children:[(0,b.jsx)(g.TabsTrigger,{value:"overview",children:"Tổng Quan"}),(0,b.jsx)(g.TabsTrigger,{value:"links",children:"Links Của Tôi"}),(0,b.jsx)(g.TabsTrigger,{value:"campaigns",children:"Chiến Dịch"}),(0,b.jsx)(g.TabsTrigger,{value:"performance",children:"Hiệu Suất"})]}),(0,b.jsx)(g.TabsContent,{value:"overview",className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Hiệu Suất Gần Đây"}),(0,b.jsx)(d.CardDescription,{children:"Hiệu suất của bạn trong 30 ngày qua"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Tỷ Lệ Chuyển Đổi"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[D.conversionRate.toFixed(1),"%"]})]}),(0,b.jsx)(h.Progress,{value:D.conversionRate,className:"h-2"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Giá Trị Đơn Hàng Trung Bình"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["$",D.averageOrderValue.toFixed(2)]})]}),(0,b.jsx)(h.Progress,{value:D.averageOrderValue/200*100,className:"h-2"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-sm",children:"Tỷ Lệ Hoa Hồng"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"15-30%"})]}),(0,b.jsx)(h.Progress,{value:75,className:"h-2"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Thao Tác Nhanh"}),(0,b.jsx)(d.CardDescription,{children:"Các tác vụ và phím tắt thông dụng"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-3",children:[(0,b.jsxs)(f.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(n.Link2,{className:"h-4 w-4 mr-2"}),"Tạo Link Mới"]}),(0,b.jsxs)(f.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(o.BarChart3,{className:"h-4 w-4 mr-2"}),"Xem Phân Tích"]}),(0,b.jsxs)(f.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(j.DollarSign,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán"]}),(0,b.jsxs)(f.Button,{className:"w-full justify-start",variant:"outline",children:[(0,b.jsx)(m.Users,{className:"h-4 w-4 mr-2"}),"Duyệt Chiến Dịch"]})]})]})]})}),(0,b.jsxs)(g.TabsContent,{value:"links",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Links Affiliate Của Tôi"}),(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})]}),(0,b.jsx)("div",{className:"grid gap-4",children:0===z.length?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-10",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(n.Link2,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Chưa tạo link nào"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Tạo link affiliate đầu tiên của bạn để bắt đầu kiếm hoa hồng."}),(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link Đầu Tiên"]})]})})}):z.map(a=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h4",{className:"font-semibold truncate",children:a.title||a.campaign?.name}),(0,b.jsx)(e.Badge,{variant:a.isActive?"default":"secondary",children:a.isActive?"Đang hoạt động":"Không hoạt động"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:[a.totalClicks||0," lượt click"]}),(0,b.jsxs)("span",{children:[a.totalConversions||0," chuyển đổi"]}),(0,b.jsxs)("span",{children:["$",(a.commission||0).toFixed(2)," kiếm được"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(q.ExternalLink,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:"Sao chép Link"})]})]})})},a.id))})]}),(0,b.jsxs)(g.TabsContent,{value:"campaigns",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Chiến Dịch Có Sẵn"}),(0,b.jsxs)(f.Button,{variant:"outline",children:[(0,b.jsx)(r.Calendar,{className:"h-4 w-4 mr-2"}),"Lọc"]})]}),(0,b.jsx)("div",{className:"grid gap-4",children:B.map(a=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h4",{className:"font-semibold",children:a.name}),(0,b.jsx)(e.Badge,{variant:"ACTIVE"===a.status?"default":"secondary",children:a.status}),(0,b.jsx)(e.Badge,{variant:"outline",children:"PERCENTAGE"===a.commissionType?`${a.commissionRate}%`:`$${a.fixedAmount}`})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,b.jsxs)("span",{children:[a.totalClicks.toLocaleString()," lượt click"]}),(0,b.jsxs)("span",{children:[a.totalConversions," chuyển đổi"]}),(0,b.jsxs)("span",{children:["Tỷ lệ ",a.conversionRate.toFixed(1),"%"]}),(0,b.jsxs)("span",{children:["$",a.totalRevenue.toFixed(2)," doanh thu"]})]})]}),(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(n.Link2,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})]})})},a.id))})]}),(0,b.jsx)(g.TabsContent,{value:"performance",className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Xu Hướng Thu Nhập"}),(0,b.jsx)(d.CardDescription,{children:"Thu nhập của bạn theo thời gian"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(o.BarChart3,{className:"h-12 w-12 mx-auto mb-4"}),(0,b.jsx)("p",{children:"Biểu đồ sẽ được triển khai"})]})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Hiệu Suất Click"}),(0,b.jsx)(d.CardDescription,{children:"Lượt click và chuyển đổi theo nguồn"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(k.MousePointer,{className:"h-12 w-12 mx-auto mb-4"}),(0,b.jsx)("p",{children:"Biểu đồ hiệu suất sẽ được triển khai"})]})})})]})]})})]})]})}a.s(["default",()=>u],111398);var v=a.i(168918),w=a.i(8912),x=a.i(478184),y=a.i(441405),z=a.i(466577),A=a.i(144932),B=a.i(755820),C=a.i(687649),D=a.i(785903),E=a.i(681768),F=a.i(629432),G=a.i(229371);function H({className:a="",userRole:h="AFFILIATE"}){let[i,k]=(0,c.useState)("active"),[n,q]=(0,c.useState)(!1),[r,t]=(0,c.useState)(null),[u,H]=(0,c.useState)(""),[I,J]=(0,c.useState)({name:"",description:"",type:"PUBLIC",commissionType:"PERCENTAGE",commissionRate:10,cookieDuration:30,minPayoutAmount:50,categories:[],targetCountries:["US"]}),{data:K,loading:L,error:M,refetch:N}=(0,v.useQuery)(G.GET_AFFILIATE_CAMPAIGNS,{variables:{search:{status:"active"===i?"ACTIVE":"draft"===i?"DRAFT":void 0,page:1,size:20}}}),[O,{loading:P}]=(0,w.useMutation)(G.CREATE_AFFILIATE_CAMPAIGN,{onCompleted:()=>{q(!1),J({name:"",description:"",type:"PUBLIC",commissionType:"PERCENTAGE",commissionRate:10,cookieDuration:30,minPayoutAmount:50,categories:[],targetCountries:["US"]}),N()}}),[Q,{loading:R}]=(0,w.useMutation)(G.UPDATE_AFFILIATE_CAMPAIGN,{onCompleted:()=>{t(null),N()}}),S=(K?.affiliateCampaigns||[]).filter(a=>a.name.toLowerCase().includes(u.toLowerCase())||a.description.toLowerCase().includes(u.toLowerCase())),T=async()=>{try{await O({variables:{input:I}})}catch(a){console.error("Error creating campaign:",a)}},U=async()=>{if(r)try{await Q({variables:{id:r.id,input:I}})}catch(a){console.error("Error updating campaign:",a)}},V=({campaign:a})=>(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg",children:a.name}),(0,b.jsx)(e.Badge,{variant:"ACTIVE"===a.status?"default":"secondary",children:a.status}),(0,b.jsx)(e.Badge,{variant:"outline",children:a.type})]}),(0,b.jsx)("p",{className:"text-muted-foreground mb-3",children:a.description})]}),"MERCHANT"===h&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>window.location.href=`/admin/affiliate/campaigns/${a.id}/applications`,title:"View Applications",children:(0,b.jsx)(m.Users,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>{t(a),J({name:a.name,description:a.description,type:a.type,commissionType:a.commissionType,commissionRate:a.commissionRate,fixedAmount:a.fixedAmount,cookieDuration:a.cookieDuration,minPayoutAmount:a.minPayoutAmount,maxPayoutAmount:a.maxPayoutAmount,categories:a.categories,targetCountries:a.targetCountries,terms:a.terms})},children:(0,b.jsx)(C.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(D.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(j.DollarSign,{className:"h-4 w-4 text-green-500"})}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:"PERCENTAGE"===a.commissionType?`${a.commissionRate}%`:`$${a.fixedAmount}`}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Hoa hồng"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(m.Users,{className:"h-4 w-4 text-blue-500"})}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.totalClicks.toLocaleString()}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lượt click"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(l.TrendingUp,{className:"h-4 w-4 text-purple-500"})}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.totalConversions}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Chuyển đổi"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(s.Target,{className:"h-4 w-4 text-orange-500"})}),(0,b.jsxs)("div",{className:"text-sm font-semibold",children:[a.conversionRate.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Tỷ lệ"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("span",{children:["Doanh thu: $",a.totalRevenue.toFixed(2)]}),(0,b.jsxs)("span",{children:["Hoa hồng: $",a.totalCommission.toFixed(2)]}),a.endDate&&(0,b.jsxs)("span",{children:["Kết thúc: ",new Date(a.endDate).toLocaleDateString()]})]}),"AFFILIATE"===h&&(0,b.jsx)(f.Button,{size:"sm",children:"Tạo Link"})]})]})},a.id),W=()=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"name",children:"Tên Chiến Dịch"}),(0,b.jsx)(x.Input,{id:"name",value:I.name||"",onChange:a=>J({...I,name:a.target.value}),placeholder:"Nhập tên chiến dịch"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"type",children:"Loại Chiến Dịch"}),(0,b.jsxs)(A.Select,{value:I.type,onValueChange:a=>J({...I,type:a}),children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"PUBLIC",children:"Công khai"}),(0,b.jsx)(A.SelectItem,{value:"PRIVATE",children:"Riêng tư"}),(0,b.jsx)(A.SelectItem,{value:"INVITE_ONLY",children:"Chỉ theo mời"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"description",children:"Mô Tả"}),(0,b.jsx)(z.Textarea,{id:"description",value:I.description||"",onChange:a=>J({...I,description:a.target.value}),placeholder:"Mô tả chiến dịch của bạn",rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"commissionType",children:"Loại Hoa Hồng"}),(0,b.jsxs)(A.Select,{value:I.commissionType,onValueChange:a=>J({...I,commissionType:a}),children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"PERCENTAGE",children:"Phần trăm"}),(0,b.jsx)(A.SelectItem,{value:"FIXED",children:"Số tiền cố định"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"commission",children:"PERCENTAGE"===I.commissionType?"Tỷ Lệ Hoa Hồng (%)":"Số Tiền Cố Định ($)"}),(0,b.jsx)(x.Input,{id:"commission",type:"number",value:"PERCENTAGE"===I.commissionType?I.commissionRate:I.fixedAmount,onChange:a=>{let b=parseFloat(a.target.value);"PERCENTAGE"===I.commissionType?J({...I,commissionRate:b}):J({...I,fixedAmount:b})},placeholder:"PERCENTAGE"===I.commissionType?"10":"25.00"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"cookieDuration",children:"Thời Gian Cookie (ngày)"}),(0,b.jsx)(x.Input,{id:"cookieDuration",type:"number",value:I.cookieDuration||30,onChange:a=>J({...I,cookieDuration:parseInt(a.target.value)})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"minPayout",children:"Số Tiền Thanh Toán Tối Thiểu ($)"}),(0,b.jsx)(x.Input,{id:"minPayout",type:"number",value:I.minPayoutAmount||50,onChange:a=>J({...I,minPayoutAmount:parseFloat(a.target.value)})})]})]})]});return L?(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,b.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-12 bg-muted rounded"},c))})]})})},c))})}):(0,b.jsxs)("div",{className:`p-6 ${a}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"MERCHANT"===h?"Chiến Dịch Của Tôi":"Chiến Dịch Có Sẵn"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"MERCHANT"===h?"Quản lý các chiến dịch tiếp thị affiliate của bạn":"Duyệt và tham gia chiến dịch để bắt đầu kiếm tiền"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["AFFILIATE"===h&&(0,b.jsxs)(f.Button,{onClick:()=>window.location.href="/admin/affiliate/browse",children:[(0,b.jsx)(F.Search,{className:"h-4 w-4 mr-2"}),"Duyệt Tất Cả Chiến Dịch"]}),"MERCHANT"===h&&(0,b.jsxs)(B.Dialog,{open:n,onOpenChange:q,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Chiến Dịch"]})}),(0,b.jsxs)(B.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Tạo Chiến Dịch Mới"})}),(0,b.jsx)(W,{}),(0,b.jsxs)(B.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>q(!1),children:"Hủy"}),(0,b.jsx)(f.Button,{onClick:T,disabled:P,children:P?"Đang tạo...":"Tạo Chiến Dịch"})]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)(g.Tabs,{value:i,onValueChange:k,children:(0,b.jsxs)(g.TabsList,{children:[(0,b.jsx)(g.TabsTrigger,{value:"active",children:"Đang hoạt động"}),(0,b.jsx)(g.TabsTrigger,{value:"draft",children:"Bản nháp"}),(0,b.jsx)(g.TabsTrigger,{value:"ended",children:"Đã kết thúc"}),(0,b.jsx)(g.TabsTrigger,{value:"all",children:"Tất cả"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(x.Input,{placeholder:"Tìm kiếm chiến dịch...",value:u,onChange:a=>H(a.target.value),className:"w-64"}),(0,b.jsx)(f.Button,{variant:"outline",size:"icon",children:(0,b.jsx)(E.Filter,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"space-y-4",children:0===S.length?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(o.BarChart3,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Không tìm thấy chiến dịch"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"MERCHANT"===h?"Bạn chưa tạo chiến dịch nào.":"Không có chiến dịch nào phù hợp với tiêu chí tìm kiếm."}),"MERCHANT"===h&&(0,b.jsxs)(f.Button,{onClick:()=>q(!0),children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Chiến Dịch Đầu Tiên"]})]})})}):S.map(a=>(0,b.jsx)(V,{campaign:a},a.id))}),(0,b.jsx)(B.Dialog,{open:!!r,onOpenChange:a=>!a&&t(null),children:(0,b.jsxs)(B.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Chỉnh Sửa Chiến Dịch"})}),(0,b.jsx)(W,{}),(0,b.jsxs)(B.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>t(null),children:"Hủy"}),(0,b.jsx)(f.Button,{onClick:U,disabled:R,children:R?"Đang cập nhật...":"Cập Nhật Chiến Dịch"})]})]})})]})}a.s(["default",()=>H],315431);var I=a.i(652878),J=a.i(468587),J=J;function K({className:a=""}){let[h,i]=(0,c.useState)("active"),[j,m]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("all"),[D,E]=(0,c.useState)({campaignId:"",originalUrl:"",customAlias:"",title:"",description:""}),{data:F,loading:H,error:K,refetch:L}=(0,v.useQuery)(G.GET_AFFILIATE_LINKS,{variables:{search:{isActive:"active"===h||"inactive"!==h&&void 0,pagination:{page:1,size:20}}}}),{data:M,loading:N}=(0,v.useQuery)(G.GET_AFFILIATE_CAMPAIGNS,{variables:{search:{status:"ACTIVE",page:1,size:100}}}),[O,{loading:P}]=(0,w.useMutation)(G.CREATE_AFFILIATE_LINK,{onCompleted:()=>{m(!1),E({campaignId:"",originalUrl:"",customAlias:"",title:"",description:""}),L()}}),Q=F?.affiliateLinks||[],R=M?.affiliateCampaigns||[],S=Q.filter(a=>{let b=a.title?.toLowerCase().includes(r.toLowerCase())||a.description?.toLowerCase().includes(r.toLowerCase())||a.campaign.name.toLowerCase().includes(r.toLowerCase()),c="all"===t||a.campaignId===t;return b&&c}),T=async()=>{try{await O({variables:{input:D}})}catch(a){console.error("Error creating link:",a)}},U=({link:a})=>(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold truncate",children:a.title||a.campaign.name}),(0,b.jsx)(e.Badge,{variant:a.isActive?"default":"secondary",children:a.isActive?"Đang hoạt động":"Không hoạt động"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:a.description||"Chưa có mô tả"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mb-3",children:["Chiến dịch: ",(0,b.jsx)("span",{className:"font-medium",children:a.campaign.name})]})]})}),(0,b.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(y.Label,{className:"text-xs",children:"URL rút gọn:"}),(0,b.jsx)("code",{className:"flex-1 text-sm bg-muted px-2 py-1 rounded truncate",children:a.shortUrl}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>{var b;return b=a.shortUrl,void navigator.clipboard.writeText(b)},children:(0,b.jsx)(I.Copy,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",asChild:!0,children:(0,b.jsx)("a",{href:a.shortUrl,target:"_blank",rel:"noopener noreferrer",children:(0,b.jsx)(q.ExternalLink,{className:"h-4 w-4"})})})]}),a.customAlias&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Alias: ",a.customAlias]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(k.MousePointer,{className:"h-4 w-4 text-blue-500"})}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:(a.totalClicks||0).toLocaleString()}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Lượt click"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(l.TrendingUp,{className:"h-4 w-4 text-green-500"})}),(0,b.jsx)("div",{className:"text-sm font-semibold",children:a.totalConversions||0}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Chuyển đổi"})]}),(0,b.jsxs)("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,b.jsx)(o.BarChart3,{className:"h-4 w-4 text-purple-500"})}),(0,b.jsxs)("div",{className:"text-sm font-semibold",children:[(a.conversionRate||0).toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Tỷ lệ"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Doanh thu: ",(0,b.jsxs)("span",{className:"font-medium text-foreground",children:["$",(a.revenue||0).toFixed(2)]})," • ","Hoa hồng: ",(0,b.jsxs)("span",{className:"font-medium text-green-600",children:["$",(a.commission||0).toFixed(2)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(J.default,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(o.BarChart3,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(C.Edit,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:["Tạo lúc: ",new Date(a.createdAt).toLocaleDateString()]})]})});return H||N?(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,b.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,b.jsx)("div",{className:"h-10 bg-muted rounded"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"h-12 bg-muted rounded"},c))})]})})},c))})}):(0,b.jsxs)("div",{className:`p-6 ${a}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Links Affiliate"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Tạo và quản lý các links theo dõi affiliate của bạn"})]}),(0,b.jsxs)(B.Dialog,{open:j,onOpenChange:m,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link"]})}),(0,b.jsxs)(B.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Tạo Link Affiliate Mới"})}),(0,b.jsx)(()=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"campaign",children:"Chiến Dịch"}),(0,b.jsxs)(A.Select,{value:D.campaignId,onValueChange:a=>E({...D,campaignId:a}),children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{placeholder:"Chọn chiến dịch"})}),(0,b.jsx)(A.SelectContent,{children:R.map(a=>(0,b.jsx)(A.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsx)("span",{children:a.name}),(0,b.jsx)(e.Badge,{variant:"outline",className:"ml-2",children:"PERCENTAGE"===a.commissionType?`${a.commissionRate}%`:`$${a.fixedAmount}`})]})},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"originalUrl",children:"URL Đích"}),(0,b.jsx)(x.Input,{id:"originalUrl",value:D.originalUrl,onChange:a=>E({...D,originalUrl:a.target.value}),placeholder:"https://example.com/product"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"customAlias",children:"Biệt danh tùy chỉnh (tùy chọn)"}),(0,b.jsx)(x.Input,{id:"customAlias",value:D.customAlias||"",onChange:a=>E({...D,customAlias:a.target.value}),placeholder:"link-đặc-biệt"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"title",children:"Tiêu Đề Link"}),(0,b.jsx)(x.Input,{id:"title",value:D.title||"",onChange:a=>E({...D,title:a.target.value}),placeholder:"Tiêu đề mô tả cho link của bạn"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"description",children:"Mô Tả (tùy chọn)"}),(0,b.jsx)(z.Textarea,{id:"description",value:D.description||"",onChange:a=>E({...D,description:a.target.value}),placeholder:"Ghi chú bổ sung về link này",rows:3})]})]}),{}),(0,b.jsxs)(B.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>m(!1),children:"Hủy"}),(0,b.jsx)(f.Button,{onClick:T,disabled:P||!D.campaignId||!D.originalUrl,children:P?"Đang tạo...":"Tạo Link"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)(g.Tabs,{value:h,onValueChange:i,children:(0,b.jsxs)(g.TabsList,{children:[(0,b.jsx)(g.TabsTrigger,{value:"active",children:"Đang hoạt động"}),(0,b.jsx)(g.TabsTrigger,{value:"inactive",children:"Không hoạt động"}),(0,b.jsx)(g.TabsTrigger,{value:"all",children:"Tất cả"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(x.Input,{placeholder:"Tìm kiếm links...",value:r,onChange:a=>s(a.target.value),className:"w-64"}),(0,b.jsxs)(A.Select,{value:t,onValueChange:u,children:[(0,b.jsx)(A.SelectTrigger,{className:"w-48",children:(0,b.jsx)(A.SelectValue,{placeholder:"Tất cả chiến dịch"})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"all",children:"Tất cả chiến dịch"}),R.map(a=>(0,b.jsx)(A.SelectItem,{value:a.id,children:a.name},a.id))]})]})]})]}),(0,b.jsx)("div",{className:"space-y-4",children:0===S.length?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(n.Link2,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Không tìm thấy links"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:r||t?"Không có links nào phù hợp với tiêu chí tìm kiếm.":"Bạn chưa tạo links affiliate nào."}),(0,b.jsxs)(f.Button,{onClick:()=>m(!0),children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Tạo Link Đầu Tiên"]})]})})}):(0,b.jsx)("div",{className:"grid gap-4",children:S.map(a=>(0,b.jsx)(U,{link:a},a.id))})}),S.length>0&&(0,b.jsxs)(d.Card,{className:"mt-6",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Thống Kê Tổng Hợp"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:S.length}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Links"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:S.reduce((a,b)=>a+(b.totalClicks||0),0).toLocaleString()}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Lượt Click"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:S.reduce((a,b)=>a+(b.totalConversions||0),0)}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Chuyển Đổi"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",S.reduce((a,b)=>a+(b.commission||0),0).toFixed(2)]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Tổng Kiếm Được"})]})]})})]})]})}a.s(["default",()=>K],530312);var L=a.i(188030),M=a.i(661990),M=M,N=a.i(499236),N=N,O=a.i(508335),P=a.i(411185),Q=a.i(390874),R=a.i(327987),S=a.i(515678);function T({className:a=""}){let[h,i]=(0,c.useState)("requests"),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)("30d"),[o,q]=(0,c.useState)({amount:0,paymentMethod:"PAYPAL",accountDetails:"",notes:"",periodStart:new Date(Date.now()-2592e6).toISOString(),periodEnd:new Date().toISOString()}),s=(0,c.useMemo)(()=>{let a=new Date;return{startDate:new Date(Date.now()-2592e6).toISOString(),endDate:a.toISOString()}},[]),{data:t,loading:u,refetch:z}=(0,v.useQuery)(G.GET_AFFILIATE_PAYMENT_REQUESTS,{variables:{search:{page:1,size:20}},fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!1}),{data:C,loading:D}=(0,v.useQuery)(G.GET_AFFILIATE_EARNINGS_REPORT,{variables:s,fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!1,nextFetchPolicy:"cache-first"}),[F,{loading:H}]=(0,w.useMutation)(G.CREATE_PAYMENT_REQUEST,{onCompleted:()=>{l(!1),q({amount:0,paymentMethod:"PAYPAL",accountDetails:"",notes:"",periodStart:new Date(Date.now()-2592e6).toISOString(),periodEnd:new Date().toISOString()}),z()}}),I=t?.affiliatePaymentRequests||[],J=C?.affiliateEarningsReport||{totalEarnings:0,availableForPayout:0,pendingPayments:0,paidThisMonth:0,minimumPayout:50},K=async()=>{try{await F({variables:{input:o}})}catch(a){console.error("Error creating payment request:",a)}},T=({request:a})=>{var c;return(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(a=>{switch(a){case"PENDING":return(0,b.jsx)(P.Clock,{className:"h-4 w-4 text-yellow-500"});case"PROCESSING":return(0,b.jsx)(R.AlertCircle,{className:"h-4 w-4 text-blue-500"});case"COMPLETED":return(0,b.jsx)(O.CheckCircle,{className:"h-4 w-4 text-green-500"});case"CANCELLED":return(0,b.jsx)(Q.XCircle,{className:"h-4 w-4 text-red-500"});default:return(0,b.jsx)(P.Clock,{className:"h-4 w-4 text-gray-500"})}})(a.status),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsxs)("h3",{className:"font-semibold",children:["$",a.amount.toFixed(2)]}),(c=a.status,(0,b.jsx)(e.Badge,{variant:{PENDING:"secondary",PROCESSING:"default",COMPLETED:"default",CANCELLED:"destructive"}[c]||"secondary",children:{PENDING:"Đang chờ",PROCESSING:"Đang xử lý",COMPLETED:"Hoàn thành",CANCELLED:"Đã hủy"}[c]||c}))]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(a=>{switch(a){case"PAYPAL":return(0,b.jsx)(L.CreditCard,{className:"h-4 w-4"});case"BANK_TRANSFER":return(0,b.jsx)(M.default,{className:"h-4 w-4"});case"CRYPTO":return(0,b.jsx)(N.default,{className:"h-4 w-4"});default:return(0,b.jsx)(j.DollarSign,{className:"h-4 w-4"})}})(a.paymentMethod),(0,b.jsx)("span",{children:a.paymentMethod.replace("_"," ")}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:new Date(a.requestedAt).toLocaleDateString()})]})]})]}),(0,b.jsxs)("div",{className:"text-right text-sm text-muted-foreground",children:["Mã yêu cầu: ",(0,b.jsx)("code",{className:"text-xs",children:a.id.slice(-8)})]})]}),"COMPLETED"===a.status&&a.processedAt&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Đã xử lý:"}),(0,b.jsx)("span",{children:new Date(a.processedAt).toLocaleDateString()})]}),a.transactionId&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Mã giao dịch:"}),(0,b.jsx)("code",{className:"text-xs",children:a.transactionId})]})]}),a.adminNotes&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-sm font-medium mb-1",children:"Ghi chú quản trị:"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.adminNotes})]})]})})};return u||D?(0,b.jsx)("div",{className:`p-6 ${a}`,children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-4 bg-muted rounded w-1/2"}),(0,b.jsx)("div",{className:"h-3 bg-muted rounded w-3/4"}),(0,b.jsx)("div",{className:"h-8 bg-muted rounded"})]})})},c))})}):(0,b.jsxs)("div",{className:`p-6 ${a}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Thanh Toán"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Quản lý thu nhập và yêu cầu thanh toán của bạn"})]}),(0,b.jsxs)(B.Dialog,{open:k,onOpenChange:l,children:[(0,b.jsx)(B.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{disabled:!J.availableForPayout||J.availableForPayout<(J.minimumPayout||50),children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán"]})}),(0,b.jsxs)(B.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(B.DialogHeader,{children:(0,b.jsx)(B.DialogTitle,{children:"Yêu Cầu Thanh Toán"})}),(0,b.jsx)(()=>(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,b.jsx)("div",{className:"text-sm font-medium mb-2",children:"Số Dư Có Sẵn"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",J.availableForPayout?.toFixed(2)||"0.00"]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Số tiền tối thiểu: $",J.minimumPayout||50]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"amount",children:"Số Tiền"}),(0,b.jsx)(x.Input,{id:"amount",type:"number",step:"0.01",max:J.availableForPayout||0,value:o.amount||"",onChange:a=>q({...o,amount:parseFloat(a.target.value)||0}),placeholder:"0.00"}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Tối đa: $",J.availableForPayout?.toFixed(2)||"0.00"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"method",children:"Phương Thức Thanh Toán"}),(0,b.jsxs)(A.Select,{value:o.paymentMethod,onValueChange:a=>q({...o,paymentMethod:a}),children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"PAYPAL",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(L.CreditCard,{className:"h-4 w-4"}),"PayPal"]})}),(0,b.jsx)(A.SelectItem,{value:"BANK_TRANSFER",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(M.default,{className:"h-4 w-4"}),"Chuyển khoản ngân hàng"]})}),(0,b.jsx)(A.SelectItem,{value:"CRYPTO",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.default,{className:"h-4 w-4"}),"Tiền điện tử"]})})]})]})]}),"PAYPAL"===o.paymentMethod&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"paypalEmail",children:"Email PayPal"}),(0,b.jsx)(x.Input,{id:"paypalEmail",type:"email",value:o.accountDetails&&JSON.parse(o.accountDetails).email||"",onChange:a=>q({...o,accountDetails:JSON.stringify({email:a.target.value})}),placeholder:"paypal-cua-ban@email.com"})]}),"BANK_TRANSFER"===o.paymentMethod&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"accountName",children:"Tên Tài Khoản"}),(0,b.jsx)(x.Input,{id:"accountName",value:o.accountDetails&&JSON.parse(o.accountDetails).accountName||"",onChange:a=>{let b=o.accountDetails?JSON.parse(o.accountDetails):{};q({...o,accountDetails:JSON.stringify({...b,accountName:a.target.value})})},placeholder:"Tên chủ tài khoản"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"accountNumber",children:"Số Tài Khoản"}),(0,b.jsx)(x.Input,{id:"accountNumber",value:o.accountDetails&&JSON.parse(o.accountDetails).accountNumber||"",onChange:a=>{let b=o.accountDetails?JSON.parse(o.accountDetails):{};q({...o,accountDetails:JSON.stringify({...b,accountNumber:a.target.value})})},placeholder:"Số tài khoản của bạn"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"routingNumber",children:"Số Định Tuyến"}),(0,b.jsx)(x.Input,{id:"routingNumber",value:o.accountDetails&&JSON.parse(o.accountDetails).routingNumber||"",onChange:a=>{let b=o.accountDetails?JSON.parse(o.accountDetails):{};q({...o,accountDetails:JSON.stringify({...b,routingNumber:a.target.value})})},placeholder:"Số định tuyến ngân hàng"})]})]}),"CRYPTO"===o.paymentMethod&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"cryptoType",children:"Tiền Điện Tử"}),(0,b.jsxs)(A.Select,{value:o.accountDetails&&JSON.parse(o.accountDetails).cryptoType||"BTC",onValueChange:a=>{let b=o.accountDetails?JSON.parse(o.accountDetails):{};q({...o,accountDetails:JSON.stringify({...b,cryptoType:a})})},children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"BTC",children:"Bitcoin (BTC)"}),(0,b.jsx)(A.SelectItem,{value:"ETH",children:"Ethereum (ETH)"}),(0,b.jsx)(A.SelectItem,{value:"USDT",children:"Tether (USDT)"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{htmlFor:"walletAddress",children:"Địa Chỉ Ví"}),(0,b.jsx)(x.Input,{id:"walletAddress",value:o.accountDetails&&JSON.parse(o.accountDetails).walletAddress||"",onChange:a=>{let b=o.accountDetails?JSON.parse(o.accountDetails):{};q({...o,accountDetails:JSON.stringify({...b,walletAddress:a.target.value})})},placeholder:"Địa chỉ ví của bạn"})]})]})]}),{}),(0,b.jsxs)(B.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>l(!1),children:"Hủy"}),(0,b.jsx)(f.Button,{onClick:K,disabled:H||o.amount<(J.minimumPayout||50)||o.amount>(J.availableForPayout||0),children:H?"Đang gửi...":"Gửi Yêu Cầu"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tổng Thu Nhập"}),(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",J.totalEarnings?.toFixed(2)||"0.00"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toàn thời gian"})]}),(0,b.jsx)(j.DollarSign,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Có Sẵn"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",J.availableForPayout?.toFixed(2)||"0.00"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sẵn sàng thanh toán"})]}),(0,b.jsx)(O.CheckCircle,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Đang Chờ"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:["$",J.pendingPayments?.toFixed(2)||"0.00"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Đang xử lý"})]}),(0,b.jsx)(P.Clock,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tháng Này"}),(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",J.paidThisMonth?.toFixed(2)||"0.00"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Đã thanh toán"})]}),(0,b.jsx)(r.Calendar,{className:"h-8 w-8 text-blue-500"})]})})})]}),(0,b.jsxs)(g.Tabs,{value:h,onValueChange:i,className:"space-y-6",children:[(0,b.jsxs)(g.TabsList,{className:"grid w-full grid-cols-3",children:[(0,b.jsx)(g.TabsTrigger,{value:"requests",children:"Yêu Cầu Thanh Toán"}),(0,b.jsx)(g.TabsTrigger,{value:"history",children:"Lịch Sử Thanh Toán"}),(0,b.jsx)(g.TabsTrigger,{value:"settings",children:"Cài Đặt Thanh Toán"})]}),(0,b.jsxs)(g.TabsContent,{value:"requests",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Yêu Cầu Thanh Toán"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(E.Filter,{className:"h-4 w-4 mr-2"}),"Lọc"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(S.Download,{className:"h-4 w-4 mr-2"}),"Xuất"]})]})]}),(0,b.jsx)("div",{className:"space-y-4",children:0===I.length?(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(j.DollarSign,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Chưa có yêu cầu thanh toán"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa thực hiện yêu cầu thanh toán nào."}),J.availableForPayout>=(J.minimumPayout||50)&&(0,b.jsxs)(f.Button,{onClick:()=>l(!0),children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Yêu Cầu Thanh Toán Đầu Tiên"]})]})})}):I.map(a=>(0,b.jsx)(T,{request:a},a.id))})]}),(0,b.jsxs)(g.TabsContent,{value:"history",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Lịch Sử Thanh Toán"}),(0,b.jsxs)(A.Select,{value:m,onValueChange:n,children:[(0,b.jsx)(A.SelectTrigger,{className:"w-48",children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"7d",children:"7 ngày qua"}),(0,b.jsx)(A.SelectItem,{value:"30d",children:"30 ngày qua"}),(0,b.jsx)(A.SelectItem,{value:"90d",children:"90 ngày qua"}),(0,b.jsx)(A.SelectItem,{value:"1y",children:"Năm qua"})]})]})]}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(r.Calendar,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Biểu đồ lịch sử thanh toán"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Trực quan hóa lịch sử thanh toán chi tiết sẽ được triển khai ở đây."})]})})})]}),(0,b.jsx)(g.TabsContent,{value:"settings",className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Tùy Chọn Thanh Toán"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{children:"Phương Thức Thanh Toán Ưu Tiên"}),(0,b.jsxs)(A.Select,{defaultValue:"PAYPAL",children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"PAYPAL",children:"PayPal"}),(0,b.jsx)(A.SelectItem,{value:"BANK_TRANSFER",children:"Chuyển khoản ngân hàng"}),(0,b.jsx)(A.SelectItem,{value:"CRYPTO",children:"Tiền điện tử"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{children:"Ngưỡng Thanh Toán Tự Động"}),(0,b.jsxs)(A.Select,{defaultValue:"100",children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"50",children:"$50"}),(0,b.jsx)(A.SelectItem,{value:"100",children:"$100"}),(0,b.jsx)(A.SelectItem,{value:"250",children:"$250"}),(0,b.jsx)(A.SelectItem,{value:"500",children:"$500"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tự động yêu cầu thanh toán khi đạt đến số tiền này"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Thông Tin Thuế"})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{children:"Mã số thuế"}),(0,b.jsx)(x.Input,{placeholder:"XXX-XX-XXXX"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(y.Label,{children:"Quốc Gia Thuế"}),(0,b.jsxs)(A.Select,{defaultValue:"US",children:[(0,b.jsx)(A.SelectTrigger,{children:(0,b.jsx)(A.SelectValue,{})}),(0,b.jsxs)(A.SelectContent,{children:[(0,b.jsx)(A.SelectItem,{value:"US",children:"Hoa Kỳ"}),(0,b.jsx)(A.SelectItem,{value:"CA",children:"Canada"}),(0,b.jsx)(A.SelectItem,{value:"UK",children:"Vương Quốc Anh"}),(0,b.jsx)(A.SelectItem,{value:"DE",children:"Đức"}),(0,b.jsx)(A.SelectItem,{value:"VN",children:"Việt Nam"})]})]})]}),(0,b.jsx)(f.Button,{variant:"outline",children:"Tải Lên Tài Liệu Thuế"})]})]})]})})]})]})}a.s(["default",()=>T],608659),a.s([],809548)}];

//# sourceMappingURL=frontend_src_components_affiliate_index_ts_75adca0c._.js.map