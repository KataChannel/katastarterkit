module.exports=[22188,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(53627),e=a.i(285439),f=a.i(400438),g=a.i(975780),h=a.i(202979),i=a.i(293470),j=a.i(772451),k=a.i(478184),l=a.i(441405),m=a.i(466577),n=a.i(144932),o=a.i(755820),p=a.i(730705),q=a.i(751075),r=a.i(785694),s=a.i(234211),t=a.i(473515),u=a.i(147745),v=a.i(515678),w=a.i(558767),x=a.i(723989),y=a.i(508335),z=a.i(390874),A=a.i(128348),B=a.i(779149),C=a.i(571698),D=a.i(878931),E=a.i(516482),F=a.i(681768),G=a.i(629432),H=a.i(778775);function I(){let a=(0,d.useParams)(),I=(0,d.useRouter)(),{toast:J}=(0,s.useToast)(),K=a.id,{employeeProfile:L,loading:M}=(0,e.useEmployeeProfile)(K),{documents:N,loading:O,refetch:P}=(0,e.useEmployeeDocuments)(K),{createDocument:Q}=(0,e.useCreateEmployeeDocument)(),{updateDocument:R}=(0,e.useUpdateEmployeeDocument)(),{deleteDocument:S}=(0,e.useDeleteEmployeeDocument)(),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)("ALL"),[ab,ac]=(0,c.useState)(""),[ad,ae]=(0,c.useState)({documentType:f.DocumentType.OTHER,title:"",description:"",documentNumber:"",issueDate:"",expiryDate:"",issuingAuthority:""}),[af,ag]=(0,c.useState)(null),[ah,ai]=(0,c.useState)(!1),aj=async()=>{if(!af)return void J({title:"Lỗi",description:"Vui lòng chọn tệp tin để tải lên.",type:"error"});ai(!0);try{let a=new FormData;a.append("files",af);let b=process.env.NEXT_PUBLIC_API_URL||"http://localhost:14000",c=await fetch(`${b}/api/files/upload/bulk`,{method:"POST",headers:{},body:a,credentials:"include"});if(!c.ok)throw Error("Upload failed");let d=await c.json(),e=d.data?.[0];if(!e)throw Error("No file returned from upload");await Q({employeeProfileId:K,documentType:ad.documentType,title:ad.title,description:ad.description,fileId:e.id,fileName:e.name,fileUrl:e.url,fileSize:e.size,fileMimeType:e.mimeType,documentNumber:ad.documentNumber||void 0,issueDate:ad.issueDate||void 0,expiryDate:ad.expiryDate||void 0,issuingAuthority:ad.issuingAuthority||void 0}),J({title:"Thành công",description:"Tài liệu đã được tải lên.",type:"success"}),U(!1),ak(),P()}catch(a){J({title:"Lỗi",description:"Không thể tải lên tài liệu.",type:"error"})}finally{ai(!1)}},ak=()=>{ae({documentType:f.DocumentType.OTHER,title:"",description:"",documentNumber:"",issueDate:"",expiryDate:"",issuingAuthority:""}),ag(null)},al=async()=>{if(Z)try{await R(Z,{isVerified:!0}),J({title:"Thành công",description:"Tài liệu đã được xác minh.",type:"success"}),W(!1),$(null),P()}catch(a){J({title:"Lỗi",description:"Không thể xác minh tài liệu.",type:"error"})}},am=async()=>{if(Z)try{await S(Z),J({title:"Thành công",description:"Tài liệu đã được xóa.",type:"success"}),Y(!1),$(null),P()}catch(a){J({title:"Lỗi",description:"Không thể xóa tài liệu.",type:"error"})}},an=a=>({[f.DocumentType.CV]:"Hồ sơ xin việc",[f.DocumentType.CONTRACT]:"Hợp đồng",[f.DocumentType.ID_CARD]:"CMND/CCCD",[f.DocumentType.PASSPORT]:"Hộ chiếu",[f.DocumentType.DEGREE]:"Bằng cấp",[f.DocumentType.CERTIFICATE]:"Chứng chỉ",[f.DocumentType.PHOTO]:"Ảnh",[f.DocumentType.BANK_INFO]:"Thông tin ngân hàng",[f.DocumentType.HEALTH_CERTIFICATE]:"Giấy khám sức khỏe",[f.DocumentType.OTHER]:"Khác"})[a],ao=(0,c.useMemo)(()=>{let a=N;return"ALL"!==_&&(a=a.filter(a=>a.documentType===_)),ab&&(a=a.filter(a=>a.title.toLowerCase().includes(ab.toLowerCase())||a.description?.toLowerCase().includes(ab.toLowerCase()))),a},[N,_,ab]),ap=(0,c.useMemo)(()=>{let a=new Map;return N.forEach(b=>{a.set(b.documentType,(a.get(b.documentType)||0)+1)}),a},[N]);return M||O?(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsx)(j.Skeleton,{className:"h-10 w-64"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(a=>(0,b.jsx)(j.Skeleton,{className:"h-32"},a))})]}):(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",onClick:()=>I.back(),children:(0,b.jsx)(E.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("h1",{className:"text-3xl font-bold tracking-tight flex items-center",children:[(0,b.jsx)(t.FileText,{className:"mr-3 h-8 w-8"}),"Tài liệu nhân viên"]})]}),L&&(0,b.jsxs)("p",{className:"text-muted-foreground ml-12",children:[L.fullName," (",L.employeeCode,")"]})]}),(0,b.jsxs)(h.Button,{onClick:()=>U(!0),children:[(0,b.jsx)(u.Upload,{className:"mr-2 h-4 w-4"}),"Tải lên tài liệu"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Tổng tài liệu"}),(0,b.jsx)(t.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:N.length})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Đã xác minh"}),(0,b.jsx)(y.CheckCircle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:N.filter(a=>a.isVerified).length})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Chưa xác minh"}),(0,b.jsx)(z.XCircle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:N.filter(a=>!a.isVerified).length})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Loại tài liệu"}),(0,b.jsx)(F.Filter,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:ap.size})})]})]}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(G.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(k.Input,{placeholder:"Tìm kiếm tài liệu...",value:ab,onChange:a=>ac(a.target.value),className:"pl-10"})]})}),(0,b.jsxs)(n.Select,{value:_,onValueChange:a=>aa(a),children:[(0,b.jsx)(n.SelectTrigger,{className:"w-full md:w-[250px]",children:(0,b.jsx)(n.SelectValue,{placeholder:"Lọc theo loại"})}),(0,b.jsxs)(n.SelectContent,{children:[(0,b.jsx)(n.SelectItem,{value:"ALL",children:"Tất cả loại"}),Object.values(f.DocumentType).map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:an(a)},a))]})]})]})})}),0===ao.length?(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(t.FileText,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:ab||"ALL"!==_?"Không tìm thấy tài liệu phù hợp.":'Chưa có tài liệu nào. Nhấn "Tải lên tài liệu" để thêm.'})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ao.map(a=>{var c;let d=(c=a.fileMimeType,c?.startsWith("image/")?C.Image:c?.startsWith("application/pdf")?t.FileText:D.File);return(0,b.jsxs)(g.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,b.jsx)(d,{className:"h-6 w-6 text-primary"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.CardTitle,{className:"text-base line-clamp-1",children:a.title}),(0,b.jsx)(g.CardDescription,{className:"text-xs",children:an(a.documentType)})]})]}),(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(x.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(q.DropdownMenuLabel,{children:"Thao tác"}),(0,b.jsx)(q.DropdownMenuSeparator,{}),(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{var b,c;let d;return b=a.fileUrl,c=a.fileName,void((d=document.createElement("a")).href=b,d.download=c,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d))},children:[(0,b.jsx)(v.Download,{className:"mr-2 h-4 w-4"}),"Tải xuống"]}),!a.isVerified&&(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{$(a.id),W(!0)},children:[(0,b.jsx)(H.Shield,{className:"mr-2 h-4 w-4"}),"Xác minh"]}),(0,b.jsx)(q.DropdownMenuSeparator,{}),(0,b.jsxs)(q.DropdownMenuItem,{className:"text-red-600",onClick:()=>{$(a.id),Y(!0)},children:[(0,b.jsx)(w.Trash2,{className:"mr-2 h-4 w-4"}),"Xóa"]})]})]})]})}),(0,b.jsxs)(g.CardContent,{className:"space-y-3",children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(i.Badge,{variant:a.isVerified?"default":"secondary",className:a.isVerified?"bg-green-500":"",children:a.isVerified?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.CheckCircle,{className:"mr-1 h-3 w-3"}),"Đã xác minh"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z.XCircle,{className:"mr-1 h-3 w-3"}),"Chưa xác minh"]})}),a.fileSize&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(a.fileSize/1024).toFixed(1)," KB"]})]}),a.documentNumber&&(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Số:"})," ",a.documentNumber]}),(a.issueDate||a.expiryDate)&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,b.jsx)(A.Calendar,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[a.issueDate&&new Date(a.issueDate).toLocaleDateString("vi-VN"),a.issueDate&&a.expiryDate&&" - ",a.expiryDate&&new Date(a.expiryDate).toLocaleDateString("vi-VN")]})]}),a.verifiedBy&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-green-600",children:[(0,b.jsx)(B.User,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:["Xác minh bởi: ",a.verifiedBy]})]})]})]},a.id)})}),(0,b.jsx)(o.Dialog,{open:T,onOpenChange:U,children:(0,b.jsxs)(o.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Tải lên tài liệu mới"}),(0,b.jsx)(o.DialogDescription,{children:"Thêm tài liệu cho nhân viên này"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(l.Label,{htmlFor:"documentType",children:["Loại tài liệu ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(n.Select,{value:ad.documentType,onValueChange:a=>ae({...ad,documentType:a}),children:[(0,b.jsx)(n.SelectTrigger,{children:(0,b.jsx)(n.SelectValue,{})}),(0,b.jsx)(n.SelectContent,{children:Object.values(f.DocumentType).map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:an(a)},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(l.Label,{htmlFor:"title",children:["Tiêu đề ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(k.Input,{id:"title",value:ad.title,onChange:a=>ae({...ad,title:a.target.value}),placeholder:"Nhập tiêu đề tài liệu"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"description",children:"Mô tả"}),(0,b.jsx)(m.Textarea,{id:"description",value:ad.description,onChange:a=>ae({...ad,description:a.target.value}),placeholder:"Mô tả chi tiết về tài liệu",rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"documentNumber",children:"Số tài liệu"}),(0,b.jsx)(k.Input,{id:"documentNumber",value:ad.documentNumber,onChange:a=>ae({...ad,documentNumber:a.target.value}),placeholder:"VD: 123456789"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"issuingAuthority",children:"Cơ quan cấp"}),(0,b.jsx)(k.Input,{id:"issuingAuthority",value:ad.issuingAuthority,onChange:a=>ae({...ad,issuingAuthority:a.target.value}),placeholder:"VD: Công an TP.HCM"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"issueDate",children:"Ngày cấp"}),(0,b.jsx)(k.Input,{id:"issueDate",type:"date",value:ad.issueDate,onChange:a=>ae({...ad,issueDate:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"expiryDate",children:"Ngày hết hạn"}),(0,b.jsx)(k.Input,{id:"expiryDate",type:"date",value:ad.expiryDate,onChange:a=>ae({...ad,expiryDate:a.target.value})})]})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(l.Label,{htmlFor:"file",children:["Tệp tin ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(k.Input,{id:"file",type:"file",onChange:a=>{a.target.files&&a.target.files[0]&&ag(a.target.files[0])}}),af&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Đã chọn: ",af.name," (",(af.size/1024).toFixed(1)," KB)"]})]})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>U(!1),disabled:ah,children:"Hủy"}),(0,b.jsx)(h.Button,{onClick:aj,disabled:ah||!af||!ad.title,children:ah?"Đang tải lên...":"Tải lên"})]})]})}),(0,b.jsx)(p.AlertDialog,{open:V,onOpenChange:W,children:(0,b.jsxs)(p.AlertDialogContent,{children:[(0,b.jsxs)(p.AlertDialogHeader,{children:[(0,b.jsx)(p.AlertDialogTitle,{children:"Xác minh tài liệu"}),(0,b.jsx)(p.AlertDialogDescription,{children:"Bạn có chắc chắn muốn xác minh tài liệu này? Hành động này sẽ đánh dấu tài liệu là đã được kiểm tra và xác nhận."})]}),(0,b.jsxs)(p.AlertDialogFooter,{children:[(0,b.jsx)(p.AlertDialogCancel,{children:"Hủy"}),(0,b.jsx)(p.AlertDialogAction,{onClick:al,children:"Xác minh"})]})]})}),(0,b.jsx)(p.AlertDialog,{open:X,onOpenChange:Y,children:(0,b.jsxs)(p.AlertDialogContent,{children:[(0,b.jsxs)(p.AlertDialogHeader,{children:[(0,b.jsx)(p.AlertDialogTitle,{children:"Xóa tài liệu"}),(0,b.jsx)(p.AlertDialogDescription,{children:"Bạn có chắc chắn muốn xóa tài liệu này? Hành động này không thể hoàn tác."})]}),(0,b.jsxs)(p.AlertDialogFooter,{children:[(0,b.jsx)(p.AlertDialogCancel,{children:"Hủy"}),(0,b.jsx)(p.AlertDialogAction,{onClick:am,className:"bg-red-600 hover:bg-red-700",children:"Xóa"})]})]})})]})}a.s(["default",()=>I])}];

//# sourceMappingURL=frontend_src_app_admin_hr_employee_%5Bid%5D_documents_page_tsx_5b3ac66b._.js.map