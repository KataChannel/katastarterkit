{"version":3,"sources":["turbopack:///[project]/frontend/src/app/admin/menu/page.tsx","turbopack:///[project]/frontend/src/components/menu/SortableMenuRow.tsx","turbopack:///[project]/frontend/src/components/menu/MenuFormDialog.tsx","turbopack:///[project]/frontend/src/lib/utils/menu-utils.ts"],"sourcesContent":["'use client';\n\nimport { useState, useMemo } from 'react';\nimport { toast } from 'sonner';\nimport {\n  useMenus,\n  useCreateMenu,\n  useUpdateMenu,\n  useDeleteMenu,\n} from '@/lib/hooks/useMenus';\nimport { Menu } from '@/lib/graphql/menu-dynamic-queries';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Plus, Search } from 'lucide-react';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n} from '@dnd-kit/core';\nimport {\n  arrayMove,\n  SortableContext,\n  sortableKeyboardCoordinates,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { SortableMenuRow } from '@/components/menu/SortableMenuRow';\nimport { MenuFormDialog } from '@/components/menu/MenuFormDialog';\nimport {\n  buildMenuTree,\n  flattenMenuTree,\n  getMenuTypeColor,\n} from '@/lib/utils/menu-utils';\n\n/**\n * Trang Quản Lý Menu\n * \n * Tính năng:\n * - Quản lý menu theo cấu trúc cây (parent/child)\n * - Kéo thả để sắp xếp lại menu\n * - Kéo thả để thay đổi cấp độ menu (cha <-> con)\n * - Sử dụng Universal Dynamic Query System\n */\n\nexport default function MenuManagementPage() {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedType, setSelectedType] = useState<string>('all');\n  const [isCreateOpen, setIsCreateOpen] = useState(false);\n  const [isEditOpen, setIsEditOpen] = useState(false);\n  const [selectedMenu, setSelectedMenu] = useState<Menu | null>(null);\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [expandedMenus, setExpandedMenus] = useState<Set<string>>(new Set());\n  const [formData, setFormData] = useState({\n    title: '',\n    slug: '',\n    description: '',\n    type: 'SIDEBAR',\n    route: '',\n    url: '',\n    icon: '',\n    order: 0,\n    parentId: '',\n    isActive: true,\n    isVisible: true,\n    isPublic: false,\n  });\n\n  // Drag and drop sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  // Use dynamic hooks\n  const where = useMemo(() => {\n    const filter: any = {};\n    if (selectedType !== 'all') {\n      filter.type = selectedType;\n    }\n    if (searchTerm) {\n      filter.OR = [\n        { title: { contains: searchTerm, mode: 'insensitive' } },\n        { slug: { contains: searchTerm, mode: 'insensitive' } },\n      ];\n    }\n    return filter;\n  }, [selectedType, searchTerm]);\n\n  const { menus: menusData, loading, refetch } = useMenus({\n    where,\n    orderBy: { order: 'asc' },\n  });\n\n  // Ensure menus is always Menu[] type\n  const menus = useMemo(() => {\n    return Array.isArray(menusData) ? (menusData as Menu[]) : [];\n  }, [menusData]);\n\n  // Build menu tree structure\n  const menuTree = useMemo(\n    () => buildMenuTree(menus, expandedMenus),\n    [menus, expandedMenus]\n  );\n\n  // Flatten tree for drag and drop\n  const flatMenus = useMemo(() => flattenMenuTree(menuTree), [menuTree]);\n  \n  const { createMenu: createMenuMutation } = useCreateMenu();\n  const { updateMenu: updateMenuMutation } = useUpdateMenu();\n  const { deleteMenu: deleteMenuMutation } = useDeleteMenu();\n\n  // Handlers\n  const handleDragStart = (event: DragStartEvent) => {\n    setActiveId(event.active.id as string);\n  };\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n\n    if (!over || active.id === over.id) return;\n\n    const oldIndex = flatMenus.findIndex((m) => m.id === active.id);\n    const newIndex = flatMenus.findIndex((m) => m.id === over.id);\n\n    if (oldIndex === -1 || newIndex === -1) return;\n\n    const moved = flatMenus[oldIndex];\n    const target = flatMenus[newIndex];\n\n    try {\n      // Update order\n      const newOrder = target.order;\n      await updateMenuMutation(moved.id, { order: newOrder });\n\n      // Update all affected menus' orders\n      const reordered = arrayMove(flatMenus, oldIndex, newIndex);\n      for (let i = 0; i < reordered.length; i++) {\n        if (reordered[i].order !== i) {\n          await updateMenuMutation(reordered[i].id, { order: i });\n        }\n      }\n\n      toast.success('Menu order updated');\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to update menu order');\n    }\n  };\n\n  const handleToggleExpand = (id: string) => {\n    setExpandedMenus((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) {\n        next.delete(id);\n      } else {\n        next.add(id);\n      }\n      return next;\n    });\n  };\n\n  const handleCreate = async () => {\n    try {\n      await createMenuMutation({\n        ...formData,\n        order: parseInt(formData.order.toString()),\n        parentId: formData.parentId && formData.parentId !== 'none' ? formData.parentId : undefined,\n      });\n      toast.success('Menu created successfully');\n      setIsCreateOpen(false);\n      resetForm();\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to create menu');\n    }\n  };\n\n  const handleEdit = async () => {\n    if (!selectedMenu) return;\n    try {\n      await updateMenuMutation(selectedMenu.id, {\n        ...formData,\n        order: parseInt(formData.order.toString()),\n        parentId: formData.parentId && formData.parentId !== 'none' ? formData.parentId : undefined,\n      });\n      toast.success('Menu updated successfully');\n      setIsEditOpen(false);\n      setSelectedMenu(null);\n      resetForm();\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to update menu');\n    }\n  };\n\n  const handleDelete = async (id: string, title: string) => {\n    if (!confirm(`Are you sure you want to delete menu \"${title}\"?`)) return;\n    try {\n      await deleteMenuMutation(id);\n      toast.success('Menu deleted successfully');\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to delete menu');\n    }\n  };\n\n  const handleToggleActive = async (id: string) => {\n    try {\n      // Get current menu to toggle isActive\n      const menu = menus.find((m) => m.id === id);\n      if (!menu) return;\n      await updateMenuMutation(id, { isActive: !menu.isActive });\n      toast.success('Menu status updated');\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to update menu status');\n    }\n  };\n\n  const handleToggleVisibility = async (id: string) => {\n    try {\n      // Get current menu to toggle isVisible\n      const menu = menus.find((m) => m.id === id);\n      if (!menu) return;\n      await updateMenuMutation(id, { isVisible: !menu.isVisible });\n      toast.success('Menu visibility updated');\n      refetch();\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to update menu visibility');\n    }\n  };\n\n  const openEditDialog = (menu: Menu) => {\n    setSelectedMenu(menu);\n    setFormData({\n      title: menu.title,\n      slug: menu.slug,\n      description: menu.description || '',\n      type: menu.type,\n      route: menu.route || '',\n      url: menu.url || '',\n      icon: menu.icon || '',\n      order: menu.order,\n      parentId: menu.parentId || 'none',\n      isActive: menu.isActive,\n      isVisible: menu.isVisible,\n      isPublic: menu.isPublic,\n    });\n    setIsEditOpen(true);\n  };\n\n  const resetForm = () => {\n    setFormData({\n      title: '',\n      slug: '',\n      description: '',\n      type: 'SIDEBAR',\n      route: '',\n      url: '',\n      icon: '',\n      order: 0,\n      parentId: 'none',\n      isActive: true,\n      isVisible: true,\n      isPublic: false,\n    });\n  };\n\n  return (\n    <div className=\"container mx-auto p-6 space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Quản Lý Menu</h1>\n          <p className=\"text-muted-foreground\">\n            Quản lý menu và điều hướng ứng dụng của bạn\n          </p>\n        </div>\n        <Button onClick={() => setIsCreateOpen(true)}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          Tạo Menu\n        </Button>\n      </div>\n\n      {/* Filters */}\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Tìm kiếm menu...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n            <Select value={selectedType} onValueChange={setSelectedType}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"Lọc theo loại\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">Tất cả</SelectItem>\n                <SelectItem value=\"SIDEBAR\">Thanh bên</SelectItem>\n                <SelectItem value=\"HEADER\">Đầu trang</SelectItem>\n                <SelectItem value=\"FOOTER\">Chân trang</SelectItem>\n                <SelectItem value=\"MOBILE\">Di động</SelectItem>\n                <SelectItem value=\"CUSTOM\">Tùy chỉnh</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Menu ({menus.length})</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <DndContext\n            sensors={sensors}\n            collisionDetection={closestCenter}\n            onDragStart={handleDragStart}\n            onDragEnd={handleDragEnd}\n          >\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Tiêu đề</TableHead>\n                  <TableHead>Loại</TableHead>\n                  <TableHead>Đường dẫn/URL</TableHead>\n                  <TableHead>Thứ tự</TableHead>\n                  <TableHead>Trạng thái</TableHead>\n                  <TableHead>Hiển thị</TableHead>\n                  <TableHead className=\"text-right\">Hành động</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {loading ? (\n                  <TableRow>\n                    <TableCell colSpan={7} className=\"text-center py-8\">\n                      Đang tải menu...\n                    </TableCell>\n                  </TableRow>\n                ) : menuTree.length === 0 ? (\n                  <TableRow>\n                    <TableCell colSpan={7} className=\"text-center py-8\">\n                      Không tìm thấy menu\n                    </TableCell>\n                  </TableRow>\n                ) : (\n                  <SortableContext\n                    items={flatMenus.map((m) => m.id)}\n                    strategy={verticalListSortingStrategy}\n                  >\n                    {menuTree.map((menu) => (\n                      <SortableMenuRow\n                        key={menu.id}\n                        menu={menu}\n                        level={0}\n                        allMenus={menus}\n                        onEdit={openEditDialog}\n                        onDelete={handleDelete}\n                        onToggleActive={handleToggleActive}\n                        onToggleVisibility={handleToggleVisibility}\n                        onToggleExpand={handleToggleExpand}\n                        getTypeColor={getMenuTypeColor}\n                        expanded={menu.expanded}\n                      />\n                    ))}\n                  </SortableContext>\n                )}\n              </TableBody>\n            </Table>\n            <DragOverlay>\n              {activeId ? (\n                <div className=\"bg-background border rounded-lg p-4 shadow-lg\">\n                  <div className=\"font-medium\">\n                    {flatMenus.find((m) => m.id === activeId)?.title}\n                  </div>\n                </div>\n              ) : null}\n            </DragOverlay>\n          </DndContext>\n        </CardContent>\n      </Card>\n\n      {/* Create Dialog */}\n      <MenuFormDialog\n        open={isCreateOpen}\n        onOpenChange={setIsCreateOpen}\n        mode=\"create\"\n        formData={formData}\n        onFormChange={setFormData}\n        onSubmit={handleCreate}\n        menus={menus}\n      />\n\n      {/* Edit Dialog */}\n      <MenuFormDialog\n        open={isEditOpen}\n        onOpenChange={setIsEditOpen}\n        mode=\"edit\"\n        formData={formData}\n        onFormChange={setFormData}\n        onSubmit={handleEdit}\n        menus={menus}\n        selectedMenuId={selectedMenu?.id}\n      />\n    </div>\n  );\n}\n","'use client';\n\nimport { Menu } from '@/lib/graphql/menu-dynamic-queries';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { TableCell, TableRow } from '@/components/ui/table';\nimport {\n  Pencil,\n  Trash2,\n  Eye,\n  EyeOff,\n  Power,\n  Menu as MenuIcon,\n  ExternalLink,\n  GripVertical,\n  ChevronRight,\n  ChevronDown,\n} from 'lucide-react';\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { cn } from '@/lib/utils';\n\nexport interface MenuTreeItem extends Menu {\n  children?: MenuTreeItem[];\n  expanded?: boolean;\n}\n\ninterface SortableMenuRowProps {\n  menu: MenuTreeItem;\n  level?: number;\n  allMenus: Menu[];\n  onEdit: (menu: Menu) => void;\n  onDelete: (id: string, title: string) => void;\n  onToggleActive: (id: string) => void;\n  onToggleVisibility: (id: string) => void;\n  onToggleExpand: (id: string) => void;\n  getTypeColor: (type: string) => string;\n  expanded?: boolean;\n}\n\nexport function SortableMenuRow({\n  menu,\n  level = 0,\n  allMenus,\n  onEdit,\n  onDelete,\n  onToggleActive,\n  onToggleVisibility,\n  onToggleExpand,\n  getTypeColor,\n  expanded = false,\n}: SortableMenuRowProps) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: menu.id });\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1,\n  };\n\n  const hasChildren = menu.children && menu.children.length > 0;\n\n  return (\n    <>\n      <TableRow ref={setNodeRef} style={style} className={cn(isDragging && 'bg-muted')}>\n        <TableCell style={{ paddingLeft: `${level * 2 + 1}rem` }}>\n          <div className=\"flex items-center gap-2\">\n            <div {...attributes} {...listeners} className=\"cursor-grab active:cursor-grabbing\">\n              <GripVertical className=\"h-4 w-4 text-muted-foreground\" />\n            </div>\n            {hasChildren && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-6 w-6\"\n                onClick={() => onToggleExpand(menu.id)}\n              >\n                {expanded ? (\n                  <ChevronDown className=\"h-4 w-4\" />\n                ) : (\n                  <ChevronRight className=\"h-4 w-4\" />\n                )}\n              </Button>\n            )}\n            {menu.icon && <MenuIcon className=\"h-4 w-4 text-muted-foreground\" />}\n            <div>\n              <div className=\"font-medium\">{menu.title}</div>\n              <div className=\"text-sm text-muted-foreground\">{menu.slug}</div>\n            </div>\n          </div>\n        </TableCell>\n        <TableCell>\n          <Badge className={getTypeColor(menu.type)}>{menu.type}</Badge>\n        </TableCell>\n        <TableCell>\n          <div className=\"flex items-center gap-1\">\n            {menu.route || menu.url || '-'}\n            {menu.url && <ExternalLink className=\"h-3 w-3 text-muted-foreground\" />}\n          </div>\n        </TableCell>\n        <TableCell>{menu.order}</TableCell>\n        <TableCell>\n          <Badge variant={menu.isActive ? 'default' : 'secondary'}>\n            {menu.isActive ? 'Hoạt động' : 'Tạm dừng'}\n          </Badge>\n        </TableCell>\n        <TableCell>\n          <Badge variant={menu.isVisible ? 'default' : 'outline'}>\n            {menu.isVisible ? 'Hiển thị' : 'Ẩn'}\n          </Badge>\n        </TableCell>\n        <TableCell className=\"text-right\">\n          <div className=\"flex justify-end gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => onToggleActive(menu.id)}\n              title={menu.isActive ? 'Tạm dừng' : 'Kích hoạt'}\n            >\n              <Power className=\"h-4 w-4\" />\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => onToggleVisibility(menu.id)}\n              title={menu.isVisible ? 'Ẩn' : 'Hiển thị'}\n            >\n              {menu.isVisible ? <Eye className=\"h-4 w-4\" /> : <EyeOff className=\"h-4 w-4\" />}\n            </Button>\n            <Button variant=\"ghost\" size=\"icon\" onClick={() => onEdit(menu)} title=\"Chỉnh sửa\">\n              <Pencil className=\"h-4 w-4\" />\n            </Button>\n            {!menu.isProtected && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => onDelete(menu.id, menu.title)}\n                title=\"Xóa\"\n              >\n                <Trash2 className=\"h-4 w-4 text-red-500\" />\n              </Button>\n            )}\n          </div>\n        </TableCell>\n      </TableRow>\n      {hasChildren &&\n        expanded &&\n        menu.children!.map((child) => (\n          <SortableMenuRow\n            key={child.id}\n            menu={child}\n            level={level + 1}\n            allMenus={allMenus}\n            onEdit={onEdit}\n            onDelete={onDelete}\n            onToggleActive={onToggleActive}\n            onToggleVisibility={onToggleVisibility}\n            onToggleExpand={onToggleExpand}\n            getTypeColor={getTypeColor}\n            expanded={child.expanded}\n          />\n        ))}\n    </>\n  );\n}\n","'use client';\n\nimport { Menu } from '@/lib/graphql/menu-dynamic-queries';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Switch } from '@/components/ui/switch';\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\n\ninterface MenuFormData {\n  title: string;\n  slug: string;\n  description: string;\n  type: string;\n  route: string;\n  url: string;\n  icon: string;\n  order: number;\n  parentId: string;\n  isActive: boolean;\n  isVisible: boolean;\n  isPublic: boolean;\n}\n\ninterface MenuFormDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  mode: 'create' | 'edit';\n  formData: MenuFormData;\n  onFormChange: (data: MenuFormData) => void;\n  onSubmit: () => void;\n  menus: Menu[];\n  selectedMenuId?: string;\n}\n\nexport function MenuFormDialog({\n  open,\n  onOpenChange,\n  mode,\n  formData,\n  onFormChange,\n  onSubmit,\n  menus,\n  selectedMenuId,\n}: MenuFormDialogProps) {\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {mode === 'create' ? 'Tạo Menu Mới' : 'Chỉnh Sửa Menu'}\n          </DialogTitle>\n          <p className=\"text-sm text-muted-foreground\">\n            {mode === 'create'\n              ? 'Thêm menu mới vào hệ thống'\n              : 'Cập nhật thông tin menu'}\n          </p>\n        </DialogHeader>\n        <form onSubmit={handleSubmit}>\n          <div className=\"grid gap-4 py-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"title\">\n                  Tiêu đề <span className=\"text-red-500\">*</span>\n                </Label>\n                <Input\n                  id=\"title\"\n                  value={formData.title}\n                  onChange={(e) =>\n                    onFormChange({ ...formData, title: e.target.value })\n                  }\n                  placeholder=\"Dashboard\"\n                  required\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"slug\">\n                  Slug <span className=\"text-red-500\">*</span>\n                </Label>\n                <Input\n                  id=\"slug\"\n                  value={formData.slug}\n                  onChange={(e) =>\n                    onFormChange({ ...formData, slug: e.target.value })\n                  }\n                  placeholder=\"dashboard\"\n                  required\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"description\">Mô tả</Label>\n              <Textarea\n                id=\"description\"\n                value={formData.description}\n                onChange={(e) =>\n                  onFormChange({ ...formData, description: e.target.value })\n                }\n                placeholder=\"Mô tả về menu...\"\n                rows={3}\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"type\">\n                  Loại <span className=\"text-red-500\">*</span>\n                </Label>\n                <Select\n                  value={formData.type}\n                  onValueChange={(value) =>\n                    onFormChange({ ...formData, type: value })\n                  }\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"SIDEBAR\">Thanh bên</SelectItem>\n                    <SelectItem value=\"HEADER\">Đầu trang</SelectItem>\n                    <SelectItem value=\"FOOTER\">Chân trang</SelectItem>\n                    <SelectItem value=\"MOBILE\">Di động</SelectItem>\n                    <SelectItem value=\"CUSTOM\">Tùy chỉnh</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"parentId\">Menu cha</Label>\n                <Select\n                  value={formData.parentId}\n                  onValueChange={(value) =>\n                    onFormChange({ ...formData, parentId: value })\n                  }\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Không có (Cấp gốc)\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"none\">Không có (Cấp gốc)</SelectItem>\n                    {menus\n                      .filter((m) => !m.parentId && m.id !== selectedMenuId)\n                      .map((menu) => (\n                        <SelectItem key={menu.id} value={menu.id}>\n                          {menu.title}\n                        </SelectItem>\n                      ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"order\">Thứ tự</Label>\n                <Input\n                  id=\"order\"\n                  type=\"number\"\n                  value={formData.order}\n                  onChange={(e) =>\n                    onFormChange({\n                      ...formData,\n                      order: parseInt(e.target.value) || 0,\n                    })\n                  }\n                  min=\"0\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"icon\">Icon (Tên Lucide)</Label>\n                <Input\n                  id=\"icon\"\n                  value={formData.icon}\n                  onChange={(e) =>\n                    onFormChange({ ...formData, icon: e.target.value })\n                  }\n                  placeholder=\"LayoutDashboard\"\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"route\">Đường dẫn nội bộ</Label>\n                <Input\n                  id=\"route\"\n                  value={formData.route}\n                  onChange={(e) =>\n                    onFormChange({ ...formData, route: e.target.value })\n                  }\n                  placeholder=\"/admin/dashboard\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"url\">URL bên ngoài</Label>\n                <Input\n                  id=\"url\"\n                  value={formData.url}\n                  onChange={(e) =>\n                    onFormChange({ ...formData, url: e.target.value })\n                  }\n                  placeholder=\"https://example.com\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-6\">\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"isActive\"\n                  checked={formData.isActive}\n                  onCheckedChange={(checked) =>\n                    onFormChange({ ...formData, isActive: checked })\n                  }\n                />\n                <Label htmlFor=\"isActive\">Hoạt động</Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"isVisible\"\n                  checked={formData.isVisible}\n                  onCheckedChange={(checked) =>\n                    onFormChange({ ...formData, isVisible: checked })\n                  }\n                />\n                <Label htmlFor=\"isVisible\">Hiển thị</Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  id=\"isPublic\"\n                  checked={formData.isPublic}\n                  onCheckedChange={(checked) =>\n                    onFormChange({ ...formData, isPublic: checked })\n                  }\n                />\n                <Label htmlFor=\"isPublic\">Công khai</Label>\n              </div>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n            >\n              Hủy\n            </Button>\n            <Button type=\"submit\">\n              {mode === 'create' ? 'Tạo Menu' : 'Cập Nhật'}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { MenuTreeItem } from '@/components/menu/SortableMenuRow';\nimport { Menu } from '@/lib/graphql/menu-dynamic-queries';\n\n/**\n * Build hierarchical menu tree from flat array\n */\nexport function buildMenuTree(items: Menu[], expandedMenus: Set<string>): MenuTreeItem[] {\n  const map = new Map<string, MenuTreeItem>();\n  const roots: MenuTreeItem[] = [];\n\n  // Create map of all items\n  items.forEach((item) => {\n    map.set(item.id, {\n      ...item,\n      children: [],\n      expanded: expandedMenus.has(item.id),\n    });\n  });\n\n  // Build tree structure\n  items.forEach((item) => {\n    const node = map.get(item.id)!;\n    if (item.parentId && map.has(item.parentId)) {\n      const parent = map.get(item.parentId)!;\n      if (!parent.children) parent.children = [];\n      parent.children.push(node);\n    } else {\n      roots.push(node);\n    }\n  });\n\n  // Sort by order recursively\n  const sortByOrder = (nodes: MenuTreeItem[]) => {\n    nodes.sort((a, b) => a.order - b.order);\n    nodes.forEach((node) => {\n      if (node.children) sortByOrder(node.children);\n    });\n  };\n  sortByOrder(roots);\n\n  return roots;\n}\n\n/**\n * Flatten tree structure for drag and drop\n */\nexport function flattenMenuTree(tree: MenuTreeItem[]): Menu[] {\n  const result: Menu[] = [];\n  const flatten = (items: MenuTreeItem[]) => {\n    items.forEach((item) => {\n      result.push(item);\n      if (item.children && item.expanded) {\n        flatten(item.children);\n      }\n    });\n  };\n  flatten(tree);\n  return result;\n}\n\n/**\n * Get menu type color\n */\nexport function getMenuTypeColor(type: string): string {\n  const colors: Record<string, string> = {\n    SIDEBAR: 'bg-blue-100 text-blue-800',\n    HEADER: 'bg-green-100 text-green-800',\n    FOOTER: 'bg-purple-100 text-purple-800',\n    MOBILE: 'bg-orange-100 text-orange-800',\n    CUSTOM: 'bg-gray-100 text-gray-800',\n  };\n  return colors[type] || colors.CUSTOM;\n}\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAOA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAQA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAOA,EAAA,EAAA,CAAA,CAAA,OAWA,EAAA,EAAA,CAAA,CAAA,QCrCA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,yBAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAaA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAoBO,SAAS,EAAgB,MAC9B,CAAI,OACJ,EAAQ,CAAC,UACT,CAAQ,CACR,QAAM,UACN,CAAQ,CACR,gBAAc,oBACd,CAAkB,gBAClB,CAAc,cACd,CAAY,UACZ,GAAW,CAAK,CACK,EACrB,GAAM,CACJ,YAAU,WACV,CAAS,YACT,CAAU,WACV,CAAS,YACT,CAAU,YACV,CAAU,CACX,CAAG,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,CAAE,GAAI,EAAK,EAAG,AAAD,GAEvB,EAAQ,CACZ,UAAW,EAAA,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,cAClC,EACA,QAAS,EAAa,GAAM,CAC9B,EAEM,EAAc,EAAK,QAAQ,EAAI,EAAK,QAAQ,CAAC,MAAM,CAAG,EAE5D,MACE,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,IAAK,EAAY,MAAO,EAAO,UAAW,CAAA,EAAA,EAAA,EAAE,AAAF,EAAG,GAAc,sBACnE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,MAAO,CAAE,YAAa,CAAA,EAAG,AAAQ,IAAI,EAAE,GAAG,CAAC,AAAC,WACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAK,GAAG,CAAU,CAAG,GAAG,CAAS,CAAE,UAAU,8CAC5C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,oCAEzB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,OACL,UAAU,UACV,QAAS,IAAM,EAAe,EAAK,EAAE,WAEpC,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,YAEvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,cAI7B,EAAK,IAAI,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAQ,CAAA,CAAC,UAAU,kCAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uBAAe,EAAK,KAAK,GACxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAiC,EAAK,IAAI,WAI/D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAW,EAAa,EAAK,IAAI,WAAI,EAAK,IAAI,KAEvD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACZ,EAAK,KAAK,EAAI,EAAK,GAAG,EAAI,IAC1B,EAAK,GAAG,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,uCAGzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,EAAK,KAAK,GACtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAK,QAAQ,CAAG,UAAY,qBACzC,EAAK,QAAQ,CAAG,YAAc,eAGnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAK,SAAS,CAAG,UAAY,mBAC1C,EAAK,SAAS,CAAG,WAAa,SAGnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,OACL,QAAS,IAAM,EAAe,EAAK,EAAE,EACrC,MAAO,EAAK,QAAQ,CAAG,WAAa,qBAEpC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CAAC,UAAU,cAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,OACL,QAAS,IAAM,EAAmB,EAAK,EAAE,EACzC,MAAO,EAAK,SAAS,CAAG,KAAO,oBAE9B,EAAK,SAAS,CAAG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,GAAG,CAAA,CAAC,UAAU,YAAe,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAEpE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,QAAQ,KAAK,OAAO,QAAS,IAAM,EAAO,GAAO,MAAM,qBACrE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,cAEnB,CAAC,EAAK,WAAW,EAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,QACR,KAAK,OACL,QAAS,IAAM,EAAS,EAAK,EAAE,CAAE,EAAK,KAAK,EAC3C,MAAM,eAEN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,mCAM3B,GACC,GACA,EAAK,QAAQ,CAAE,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAEC,KAAM,EACN,MAAO,EAAQ,EACf,SAAU,EACV,OAAQ,EACR,SAAU,EACV,eAAgB,EAChB,mBAAoB,EACpB,eAAgB,EAChB,aAAc,EACd,SAAU,EAAM,QAAQ,EAVnB,EAAM,EAAE,KAezB,CCtKA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAyCO,SAAS,EAAe,MAC7B,CAAI,cACJ,CAAY,MACZ,CAAI,UACJ,CAAQ,cACR,CAAY,CACZ,UAAQ,OACR,CAAK,gBACL,CAAc,CACM,EAMpB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAM,EAAM,aAAc,WAChC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,CAAC,UAAU,mDACvB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACA,WAAT,EAAoB,eAAiB,mBAExC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCACD,WAAT,EACG,6BACA,+BAGR,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAlBS,AAAC,CAkBA,GAjBpB,EAAE,cAAc,GAChB,GACF,YAgBQ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,kBAAQ,WACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACH,MAAO,EAAS,KAAK,CACrB,SAAU,AAAC,GACT,EAAa,CAAE,GAAG,CAAQ,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAEpD,YAAY,YACZ,QAAQ,CAAA,CAAA,OAGZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAO,QACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAEtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,OACH,MAAO,EAAS,IAAI,CACpB,SAAW,AAAD,GACR,EAAa,CAAE,GAAG,CAAQ,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAAC,GAEnD,YAAY,YACZ,QAAQ,CAAA,CAAA,UAKd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,uBAAc,UAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,GAAG,cACH,MAAO,EAAS,WAAW,CAC3B,SAAU,AAAC,GACT,EAAa,CAAE,GAAG,CAAQ,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAE1D,YAAY,mBACZ,KAAM,OAIV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAO,QACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,wBAAe,SAEtC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAS,IAAI,CACpB,cAAe,AAAC,GACd,EAAa,CAAE,GAAG,CAAQ,CAAE,KAAM,CAAM,aAG1C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAA,KAEd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,WACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,mBAAU,cAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,cAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,eAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,YAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,uBAIjC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,aAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAS,QAAQ,CACxB,cAAe,AAAC,GACd,EAAa,CAAE,GAAG,CAAQ,CAAE,SAAU,CAAM,aAG9C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,YAAY,yBAE3B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,WACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,gBAAO,uBACxB,EACE,MAAM,CAAC,AAAC,GAAM,CAAC,EAAE,QAAQ,EAAI,EAAE,EAAE,GAAK,GACtC,GAAG,CAAC,AAAC,GACJ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAe,MAAO,EAAK,EAAE,UACrC,EAAK,KAAK,EADI,EAAK,EAAE,eASpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAQ,WACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACH,KAAK,SACL,MAAO,EAAS,KAAK,CACrB,SAAU,AAAC,GACT,EAAa,CACX,GAAG,CAAQ,CACX,MAAO,SAAS,EAAE,MAAM,CAAC,KAAK,GAAK,CACrC,GAEF,IAAI,SAGR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,gBAAO,sBACtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,OACH,MAAO,EAAS,IAAI,CACpB,SAAU,AAAC,GACT,EAAa,CAAE,GAAG,CAAQ,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAAC,GAEnD,YAAY,0BAKlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAQ,qBACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACH,MAAO,EAAS,KAAK,CACrB,SAAU,AAAC,GACT,EAAa,CAAE,GAAG,CAAQ,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAEpD,YAAY,wBAGhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,eAAM,kBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,MACH,MAAO,EAAS,GAAG,CACnB,SAAU,AAAC,GACT,EAAa,CAAE,GAAG,CAAQ,CAAE,IAAK,EAAE,MAAM,CAAC,KAAK,AAAC,GAElD,YAAY,8BAKlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,GAAG,WACH,QAAS,EAAS,QAAQ,CAC1B,gBAAkB,AAAD,GACf,EAAa,CAAE,GAAG,CAAQ,CAAE,SAAU,CAAQ,KAGlD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,iBAE5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,GAAG,YACH,QAAS,EAAS,SAAS,CAC3B,gBAAiB,AAAC,GAChB,EAAa,CAAE,GAAG,CAAQ,CAAE,UAAW,CAAQ,KAGnD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,qBAAY,gBAE7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,GAAG,WACH,QAAS,EAAS,QAAQ,CAC1B,gBAAiB,AAAC,GAChB,EAAa,CAAE,GAAG,CAAQ,CAAE,SAAU,CAAQ,KAGlD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,uBAIhC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,YAAY,CAAA,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,QAAQ,UACR,QAAS,IAAM,EAAa,aAC7B,QAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,kBACD,AAAT,aAAoB,WAAa,uBAOhD,CCnNO,SAAS,EAAiB,CAAY,EAC3C,IAAM,EAAiC,CACrC,QAAS,4BACT,OAAQ,8BACR,OAAQ,gCACR,OAAQ,gCACR,OAAQ,2BACV,EACA,OAAO,CAAM,CAAC,EAAK,EAAI,EAAO,MAAM,AACtC,CHPe,SAAS,IACtB,GAAM,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACvC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,OACnD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MACxD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAwB,MAClD,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,IAAI,KAC9D,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACvC,MAAO,GACP,KAAM,GACN,YAAa,GACb,KAAM,UACN,MAAO,GACP,IAAK,GACL,KAAM,GACN,MAAO,EACP,SAAU,GACV,UAAU,EACV,UAAW,GACX,UAAU,CACZ,GAGM,EAAU,CAAA,EAAA,EAAA,UAAU,AAAV,EACd,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAA,aAAa,EACvB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAA,cAAc,CAAE,CACxB,iBAAkB,EAAA,2BAA2B,AAC/C,IAII,EAAQ,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACpB,IAAM,EAAc,CAAC,EAUrB,MATqB,OAAO,CAAxB,IACF,EAAO,IAAI,CAAG,CAAA,EAEZ,IACF,EAAO,EAAE,CAAG,CACV,CAAE,CAFU,KAEH,CAAE,SAAU,EAAY,KAAM,aAAc,CAAE,EACvD,CAAE,KAAM,CAAE,SAAU,EAAY,KAAM,aAAc,CAAE,EACvD,EAEI,CACT,EAAG,CAAC,EAAc,EAAW,EAEvB,CAAE,MAAO,CAAS,SAAE,CAAO,SAAE,CAAO,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACtD,QACA,QAAS,CAAE,MAAO,KAAM,CAC1B,GAGM,EAAQ,CAAA,EAAA,EAAA,OAAO,AAAP,EAAQ,IACb,MAAM,OAAO,CAAC,GAAc,EAAuB,EAAE,CAC3D,CAAC,EAAU,EAGR,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EACtB,IAAM,SG3FF,SAzBA,EAAM,IAAI,IACV,EAAwB,EAAE,CHmHV,AGhHtB,EAAM,OAAO,CAAC,AAAC,IACb,EAAI,GAAG,CAAC,EAAK,EAAE,CAAE,CACf,GAAG,CAAI,CACP,SAAU,EAAE,CACZ,SAAU,AH4Ge,EG5GD,GAAG,CAAC,EAAK,EAAE,CACrC,EACF,GAGA,EAAM,OAAO,CAAC,AAAC,IACb,IAAM,EAAO,EAAI,GAAG,CAAC,EAAK,EAAE,EAC5B,GAAI,EAAK,QAAQ,EAAI,EAAI,GAAG,CAAC,EAAK,QAAQ,EAAG,CAC3C,IAAM,EAAS,EAAI,GAAG,CAAC,EAAK,QAAQ,CAChC,CAAC,EAAO,QAAQ,GAAE,EAAO,QAAQ,CAAG,EAAA,AAAE,EAC1C,EAAO,QAAQ,CAAC,IAAI,CAAC,EACvB,MACE,CADK,CACC,IAAI,CAAC,EAEf,GASA,GANoB,AAAC,IACnB,EAAM,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,KAAK,CAAG,EAAE,KAAK,EACtC,EAAM,OAAO,CAAC,AAAC,IACT,EAAK,QAAQ,EAAE,EAAY,EAAK,QAAQ,CAC9C,EACF,GACY,GAEL,GHoFL,CAAC,EAAO,EAAc,EAIlB,EAAY,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,gBGjF1B,EAAiB,EAAE,CASzB,CARM,EAAU,AAAC,IACf,CAOM,CAPA,OAAO,CAAC,AAAC,IACb,EAAO,IAAI,CAAC,GACR,EAAK,QAAQ,EAAI,EAAK,QAAQ,EAAE,AAClC,EAAQ,EAAK,QAAQ,CAEzB,EACF,GHyEgD,GGvEzC,GHuEoD,CAAC,EAAS,EAE/D,CAAE,WAAY,CAAkB,CAAE,CAAG,CAAA,EAAA,EAAA,aAAA,AAAa,IAClD,CAAE,WAAY,CAAkB,CAAE,CAAG,CAAA,EAAA,EAAA,aAAA,AAAa,IAClD,CAAE,WAAY,CAAkB,CAAE,CAAG,CAAA,EAAA,EAAA,aAAA,AAAa,IAOlD,EAAgB,MAAO,IAC3B,GAAM,CAAE,QAAM,MAAE,CAAI,CAAE,CAAG,EAGzB,GAFA,EAAY,MAER,CAAC,GAAQ,EAAO,EAAE,GAAK,EAAK,EAAE,CAAE,OAEpC,IAAM,EAAW,EAAU,SAAS,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,EAAO,EAAE,EACxD,EAAW,EAAU,SAAS,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,EAAK,EAAE,EAE5D,GAAI,AAAa,CAAC,OAAK,AAAa,CAAC,MAAG,OAExC,IAAM,EAAQ,CAAS,CAAC,EAAS,CAC3B,EAAS,CAAS,CAAC,EAAS,CAElC,GAAI,CAEF,IAAM,EAAW,EAAO,KAAK,AAC7B,OAAM,EAAmB,EAAM,EAAE,CAAE,CAAE,MAAO,CAAS,GAGrD,IAAM,EAAY,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAW,EAAU,GACjD,IAAK,IAAI,EAAI,EAAG,EAAI,EAAU,MAAM,CAAE,IAAK,AACrC,CAAS,CAAC,EAAE,CAAC,KAAK,GAAK,GAAG,AAC5B,MAAM,EAAmB,CAAS,CAAC,EAAE,CAAC,EAAE,CAAE,CAAE,MAAO,CAAE,GAIzD,EAAA,KAAK,CAAC,OAAO,CAAC,sBACd,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,8BAC/B,CACF,EAEM,EAAqB,AAAC,IAC1B,EAAiB,AAAC,IAChB,IAAM,EAAO,IAAI,IAAI,GAMrB,OALI,EAAK,GAAG,CAAC,GACX,EAAK,AADW,MACL,CAAC,GAEZ,EAAK,GAAG,CAAC,GAEJ,CACT,EACF,EAEM,EAAe,UACnB,GAAI,CACF,MAAM,EAAmB,CACvB,GAAG,CAAQ,CACX,MAAO,SAAS,EAAS,KAAK,CAAC,QAAQ,IACvC,SAAU,EAAS,QAAQ,EAAI,AAAsB,WAAb,QAAQ,CAAc,EAAS,QAAQ,MAAG,CACpF,GACA,EAAA,KAAK,CAAC,OAAO,CAAC,6BACd,GAAgB,GAChB,IACA,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,wBAC/B,CACF,EAEM,EAAa,UACjB,GAAK,CAAD,CACJ,GAAI,CACF,MAAM,EAFW,AAEQ,EAAa,EAAE,CAAE,CACxC,GAAG,CAAQ,CACX,MAAO,SAAS,EAAS,KAAK,CAAC,QAAQ,IACvC,SAAU,EAAS,QAAQ,EAA0B,SAAtB,EAAS,QAAQ,CAAc,EAAS,QAAQ,MAAG,CACpF,GACA,EAAA,KAAK,CAAC,OAAO,CAAC,6BACd,GAAc,GACd,EAAgB,MAChB,IACA,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,wBAC/B,CACF,EAEM,EAAe,MAAO,EAAY,KACtC,GAAK,CAAD,OAAS,CAAC,sCAAsC,EAAE,EAAM,EAAE,CAAC,EAC/D,CADkE,EAC9D,CACF,MAAM,EAAmB,GACzB,EAAA,KAAK,CAAC,OAAO,CAAC,6BACd,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,wBAC/B,CACF,EAEM,EAAqB,MAAO,IAChC,GAAI,CAEF,IAAM,EAAO,EAAM,IAAI,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,GACxC,GAAI,CAAC,EAAM,MACX,OAAM,EAAmB,EAAI,CAAE,SAAU,CAAC,EAAK,QAAQ,AAAC,GACxD,EAAA,KAAK,CAAC,OAAO,CAAC,uBACd,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,+BAC/B,CACF,EAEM,EAAyB,MAAO,IACpC,GAAI,CAEF,IAAM,EAAO,EAAM,IAAI,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,GACxC,GAAI,CAAC,EAAM,MACX,OAAM,EAAmB,EAAI,CAAE,UAAW,CAAC,EAAK,SAAS,AAAC,GAC1D,EAAA,KAAK,CAAC,OAAO,CAAC,2BACd,GACF,CAAE,MAAO,EAAY,CACnB,EAAA,KAAK,CAAC,KAAK,CAAC,EAAM,OAAO,EAAI,mCAC/B,CACF,EAEM,EAAiB,AAAC,IACtB,EAAgB,GAChB,EAAY,CACV,MAAO,EAAK,KAAK,CACjB,KAAM,EAAK,IAAI,CACf,YAAa,EAAK,WAAW,EAAI,GACjC,KAAM,EAAK,IAAI,CACf,MAAO,EAAK,KAAK,EAAI,GACrB,IAAK,EAAK,GAAG,EAAI,GACjB,KAAM,EAAK,IAAI,EAAI,GACnB,MAAO,EAAK,KAAK,CACjB,SAAU,EAAK,QAAQ,EAAI,OAC3B,SAAU,EAAK,QAAQ,CACvB,UAAW,EAAK,SAAS,CACzB,SAAU,EAAK,QAAQ,AACzB,GACA,EAAc,GAChB,EAEM,EAAY,KAChB,EAAY,CACV,MAAO,GACP,KAAM,GACN,YAAa,GACb,KAAM,UACN,MAAO,GACP,IAAK,GACL,KAAM,GACN,MAAO,EACP,SAAU,OACV,UAAU,EACV,WAAW,EACX,UAAU,CACZ,EACF,EAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4CAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8BAAqB,iBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,mDAIvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,IAAM,GAAgB,aACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,iBAMrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,UACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,wDAClB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,YAAY,mBACZ,MAAO,EACP,SAAU,AAAC,GAAM,EAAc,EAAE,MAAM,CAAC,KAAK,EAC7C,UAAU,aAGd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAc,cAAe,YAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,UACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,YAAY,oBAE3B,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,aAAa,CAAA,WACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,eAAM,WACxB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,mBAAU,cAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,cAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,eAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,YAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,kBAAS,2BAQrC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,WAAC,SAAO,EAAM,MAAM,CAAC,SAEjC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,CACT,QAAS,EACT,mBAAoB,EAAA,aAAa,CACjC,YApNe,AAAD,CAoND,GAnNrB,EAAY,EAAM,MAAM,CAAC,EAAE,CAC7B,EAmNU,UAAW,YAEX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,WACJ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,YACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,SACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,kBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,WACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,eACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,aACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,sBAAa,mBAGtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UACP,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,UACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,QAAS,EAAG,UAAU,4BAAmB,uBAIhC,IAApB,EAAS,MAAM,CACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,UACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,QAAS,EAAG,UAAU,4BAAmB,0BAKtD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CACd,MAAO,EAAU,GAAG,CAAE,AAAD,GAAO,EAAE,EAAE,EAChC,SAAU,EAAA,2BAA2B,UAEpC,EAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAEC,KAAM,EACN,MAAO,EACP,SAAU,EACV,OAAQ,EACR,SAAU,EACV,eAAgB,EAChB,mBAAoB,EACpB,eAAgB,EAChB,aAAc,EACd,SAAU,EAAK,QAAQ,EAVlB,EAAK,EAAE,UAiBxB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACT,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uBACZ,EAAU,IAAI,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,IAAW,UAG7C,eAOZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,KAAM,EACN,aAAc,EACd,KAAK,SACL,SAAU,EACV,aAAc,EACd,SAAU,EACV,MAAO,IAIT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,KAAM,EACN,aAAc,EACd,KAAK,OACL,SAAU,EACV,aAAc,EACd,SAAU,EACV,MAAO,EACP,eAAgB,GAAc,OAItC"}