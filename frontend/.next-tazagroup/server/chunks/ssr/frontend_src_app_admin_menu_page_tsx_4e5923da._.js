module.exports=[334800,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(189101),e=a.i(801839),f=a.i(202979),g=a.i(478184),h=a.i(975780),i=a.i(920283),j=a.i(723593),k=a.i(629432),l=a.i(144932),m=a.i(44445),n=a.i(243277),o=a.i(293470),p=a.i(797945),q=a.i(558767),r=a.i(785903),s=a.i(174110),t=a.i(42953),t=t,u=a.i(239329),v=a.i(12979),w=a.i(340449),x=a.i(300827),y=a.i(669055),z=a.i(187290),A=a.i(422171);function B({menu:a,level:c=0,allMenus:d,onEdit:e,onDelete:g,onToggleActive:h,onToggleVisibility:j,onToggleExpand:k,getTypeColor:l,expanded:m=!1}){let{attributes:C,listeners:D,setNodeRef:E,transform:F,transition:G,isDragging:H}=(0,n.useSortable)({id:a.id}),I={transform:z.CSS.Transform.toString(F),transition:G,opacity:H?.5:1},J=a.children&&a.children.length>0;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(i.TableRow,{ref:E,style:I,className:(0,A.cn)(H&&"bg-muted"),children:[(0,b.jsx)(i.TableCell,{style:{paddingLeft:`${2*c+1}rem`},children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{...C,...D,className:"cursor-grab active:cursor-grabbing",children:(0,b.jsx)(w.GripVertical,{className:"h-4 w-4 text-muted-foreground"})}),J&&(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>k(a.id),children:m?(0,b.jsx)(y.ChevronDown,{className:"h-4 w-4"}):(0,b.jsx)(x.ChevronRight,{className:"h-4 w-4"})}),a.icon&&(0,b.jsx)(u.Menu,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.title}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.slug})]})]})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(o.Badge,{className:l(a.type),children:a.type})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[a.route||a.url||"-",a.url&&(0,b.jsx)(v.ExternalLink,{className:"h-3 w-3 text-muted-foreground"})]})}),(0,b.jsx)(i.TableCell,{children:a.order}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(o.Badge,{variant:a.isActive?"default":"secondary",children:a.isActive?"Hoạt động":"Tạm dừng"})}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(o.Badge,{variant:a.isVisible?"default":"outline",children:a.isVisible?"Hiển thị":"Ẩn"})}),(0,b.jsx)(i.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>h(a.id),title:a.isActive?"Tạm dừng":"Kích hoạt",children:(0,b.jsx)(t.default,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>j(a.id),title:a.isVisible?"Ẩn":"Hiển thị",children:a.isVisible?(0,b.jsx)(r.Eye,{className:"h-4 w-4"}):(0,b.jsx)(s.EyeOff,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>e(a),title:"Chỉnh sửa",children:(0,b.jsx)(p.Pencil,{className:"h-4 w-4"})}),!a.isProtected&&(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>g(a.id,a.title),title:"Xóa",children:(0,b.jsx)(q.Trash2,{className:"h-4 w-4 text-red-500"})})]})})]}),J&&m&&a.children.map(a=>(0,b.jsx)(B,{menu:a,level:c+1,allMenus:d,onEdit:e,onDelete:g,onToggleActive:h,onToggleVisibility:j,onToggleExpand:k,getTypeColor:l,expanded:a.expanded},a.id))]})}var C=a.i(441405),D=a.i(466577),E=a.i(650661),F=a.i(755820);function G({open:a,onOpenChange:c,mode:d,formData:e,onFormChange:h,onSubmit:i,menus:j,selectedMenuId:k}){return(0,b.jsx)(F.Dialog,{open:a,onOpenChange:c,children:(0,b.jsxs)(F.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(F.DialogHeader,{children:[(0,b.jsx)(F.DialogTitle,{children:"create"===d?"Tạo Menu Mới":"Chỉnh Sửa Menu"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"create"===d?"Thêm menu mới vào hệ thống":"Cập nhật thông tin menu"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),i()},children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(C.Label,{htmlFor:"title",children:["Tiêu đề ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(g.Input,{id:"title",value:e.title,onChange:a=>h({...e,title:a.target.value}),placeholder:"Dashboard",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(C.Label,{htmlFor:"slug",children:["Slug ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(g.Input,{id:"slug",value:e.slug,onChange:a=>h({...e,slug:a.target.value}),placeholder:"dashboard",required:!0})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"description",children:"Mô tả"}),(0,b.jsx)(D.Textarea,{id:"description",value:e.description,onChange:a=>h({...e,description:a.target.value}),placeholder:"Mô tả về menu...",rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(C.Label,{htmlFor:"type",children:["Loại ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(l.Select,{value:e.type,onValueChange:a=>h({...e,type:a}),children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"SIDEBAR",children:"Thanh bên"}),(0,b.jsx)(l.SelectItem,{value:"HEADER",children:"Đầu trang"}),(0,b.jsx)(l.SelectItem,{value:"FOOTER",children:"Chân trang"}),(0,b.jsx)(l.SelectItem,{value:"MOBILE",children:"Di động"}),(0,b.jsx)(l.SelectItem,{value:"CUSTOM",children:"Tùy chỉnh"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"parentId",children:"Menu cha"}),(0,b.jsxs)(l.Select,{value:e.parentId,onValueChange:a=>h({...e,parentId:a}),children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Không có (Cấp gốc)"})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"none",children:"Không có (Cấp gốc)"}),j.filter(a=>!a.parentId&&a.id!==k).map(a=>(0,b.jsx)(l.SelectItem,{value:a.id,children:a.title},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"order",children:"Thứ tự"}),(0,b.jsx)(g.Input,{id:"order",type:"number",value:e.order,onChange:a=>h({...e,order:parseInt(a.target.value)||0}),min:"0"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"icon",children:"Icon (Tên Lucide)"}),(0,b.jsx)(g.Input,{id:"icon",value:e.icon,onChange:a=>h({...e,icon:a.target.value}),placeholder:"LayoutDashboard"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"route",children:"Đường dẫn nội bộ"}),(0,b.jsx)(g.Input,{id:"route",value:e.route,onChange:a=>h({...e,route:a.target.value}),placeholder:"/admin/dashboard"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(C.Label,{htmlFor:"url",children:"URL bên ngoài"}),(0,b.jsx)(g.Input,{id:"url",value:e.url,onChange:a=>h({...e,url:a.target.value}),placeholder:"https://example.com"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(E.Switch,{id:"isActive",checked:e.isActive,onCheckedChange:a=>h({...e,isActive:a})}),(0,b.jsx)(C.Label,{htmlFor:"isActive",children:"Hoạt động"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(E.Switch,{id:"isVisible",checked:e.isVisible,onCheckedChange:a=>h({...e,isVisible:a})}),(0,b.jsx)(C.Label,{htmlFor:"isVisible",children:"Hiển thị"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(E.Switch,{id:"isPublic",checked:e.isPublic,onCheckedChange:a=>h({...e,isPublic:a})}),(0,b.jsx)(C.Label,{htmlFor:"isPublic",children:"Công khai"})]})]})]}),(0,b.jsxs)(F.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Hủy"}),(0,b.jsx)(f.Button,{type:"submit",children:"create"===d?"Tạo Menu":"Cập Nhật"})]})]})]})})}function H(a){let b={SIDEBAR:"bg-blue-100 text-blue-800",HEADER:"bg-green-100 text-green-800",FOOTER:"bg-purple-100 text-purple-800",MOBILE:"bg-orange-100 text-orange-800",CUSTOM:"bg-gray-100 text-gray-800"};return b[a]||b.CUSTOM}function I(){let[a,o]=(0,c.useState)(""),[p,q]=(0,c.useState)("all"),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(new Set),[C,D]=(0,c.useState)({title:"",slug:"",description:"",type:"SIDEBAR",route:"",url:"",icon:"",order:0,parentId:"",isActive:!0,isVisible:!0,isPublic:!1}),E=(0,m.useSensors)((0,m.useSensor)(m.PointerSensor),(0,m.useSensor)(m.KeyboardSensor,{coordinateGetter:n.sortableKeyboardCoordinates})),F=(0,c.useMemo)(()=>{let b={};return"all"!==p&&(b.type=p),a&&(b.OR=[{title:{contains:a,mode:"insensitive"}},{slug:{contains:a,mode:"insensitive"}}]),b},[p,a]),{menus:I,loading:J,refetch:K}=(0,e.useMenus)({where:F,orderBy:{order:"asc"}}),L=(0,c.useMemo)(()=>Array.isArray(I)?I:[],[I]),M=(0,c.useMemo)(()=>{let a,b,c;return a=new Map,b=[],L.forEach(b=>{a.set(b.id,{...b,children:[],expanded:z.has(b.id)})}),L.forEach(c=>{let d=a.get(c.id);if(c.parentId&&a.has(c.parentId)){let b=a.get(c.parentId);b.children||(b.children=[]),b.children.push(d)}else b.push(d)}),(c=a=>{a.sort((a,b)=>a.order-b.order),a.forEach(a=>{a.children&&c(a.children)})})(b),b},[L,z]),N=(0,c.useMemo)(()=>{let a,b;return a=[],(b=c=>{c.forEach(c=>{a.push(c),c.children&&c.expanded&&b(c.children)})})(M),a},[M]),{createMenu:O}=(0,e.useCreateMenu)(),{updateMenu:P}=(0,e.useUpdateMenu)(),{deleteMenu:Q}=(0,e.useDeleteMenu)(),R=async a=>{let{active:b,over:c}=a;if(y(null),!c||b.id===c.id)return;let e=N.findIndex(a=>a.id===b.id),f=N.findIndex(a=>a.id===c.id);if(-1===e||-1===f)return;let g=N[e],h=N[f];try{let a=h.order;await P(g.id,{order:a});let b=(0,n.arrayMove)(N,e,f);for(let a=0;a<b.length;a++)b[a].order!==a&&await P(b[a].id,{order:a});d.toast.success("Menu order updated"),K()}catch(a){d.toast.error(a.message||"Failed to update menu order")}},S=a=>{A(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},T=async()=>{try{await O({...C,order:parseInt(C.order.toString()),parentId:C.parentId&&"none"!==C.parentId?C.parentId:void 0}),d.toast.success("Menu created successfully"),s(!1),Z(),K()}catch(a){d.toast.error(a.message||"Failed to create menu")}},U=async()=>{if(v)try{await P(v.id,{...C,order:parseInt(C.order.toString()),parentId:C.parentId&&"none"!==C.parentId?C.parentId:void 0}),d.toast.success("Menu updated successfully"),u(!1),w(null),Z(),K()}catch(a){d.toast.error(a.message||"Failed to update menu")}},V=async(a,b)=>{if(confirm(`Are you sure you want to delete menu "${b}"?`))try{await Q(a),d.toast.success("Menu deleted successfully"),K()}catch(a){d.toast.error(a.message||"Failed to delete menu")}},W=async a=>{try{let b=L.find(b=>b.id===a);if(!b)return;await P(a,{isActive:!b.isActive}),d.toast.success("Menu status updated"),K()}catch(a){d.toast.error(a.message||"Failed to update menu status")}},X=async a=>{try{let b=L.find(b=>b.id===a);if(!b)return;await P(a,{isVisible:!b.isVisible}),d.toast.success("Menu visibility updated"),K()}catch(a){d.toast.error(a.message||"Failed to update menu visibility")}},Y=a=>{w(a),D({title:a.title,slug:a.slug,description:a.description||"",type:a.type,route:a.route||"",url:a.url||"",icon:a.icon||"",order:a.order,parentId:a.parentId||"none",isActive:a.isActive,isVisible:a.isVisible,isPublic:a.isPublic}),u(!0)},Z=()=>{D({title:"",slug:"",description:"",type:"SIDEBAR",route:"",url:"",icon:"",order:0,parentId:"none",isActive:!0,isVisible:!0,isPublic:!1})};return(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Quản Lý Menu"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Quản lý menu và điều hướng ứng dụng của bạn"})]}),(0,b.jsxs)(f.Button,{onClick:()=>s(!0),children:[(0,b.jsx)(j.Plus,{className:"mr-2 h-4 w-4"}),"Tạo Menu"]})]}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"Tìm kiếm menu...",value:a,onChange:a=>o(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(l.Select,{value:p,onValueChange:q,children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Lọc theo loại"})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"all",children:"Tất cả"}),(0,b.jsx)(l.SelectItem,{value:"SIDEBAR",children:"Thanh bên"}),(0,b.jsx)(l.SelectItem,{value:"HEADER",children:"Đầu trang"}),(0,b.jsx)(l.SelectItem,{value:"FOOTER",children:"Chân trang"}),(0,b.jsx)(l.SelectItem,{value:"MOBILE",children:"Di động"}),(0,b.jsx)(l.SelectItem,{value:"CUSTOM",children:"Tùy chỉnh"})]})]})]})})}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)(h.CardTitle,{children:["Menu (",L.length,")"]})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsxs)(m.DndContext,{sensors:E,collisionDetection:m.closestCenter,onDragStart:a=>{y(a.active.id)},onDragEnd:R,children:[(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{children:[(0,b.jsx)(i.TableHead,{children:"Tiêu đề"}),(0,b.jsx)(i.TableHead,{children:"Loại"}),(0,b.jsx)(i.TableHead,{children:"Đường dẫn/URL"}),(0,b.jsx)(i.TableHead,{children:"Thứ tự"}),(0,b.jsx)(i.TableHead,{children:"Trạng thái"}),(0,b.jsx)(i.TableHead,{children:"Hiển thị"}),(0,b.jsx)(i.TableHead,{className:"text-right",children:"Hành động"})]})}),(0,b.jsx)(i.TableBody,{children:J?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:7,className:"text-center py-8",children:"Đang tải menu..."})}):0===M.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsx)(i.TableCell,{colSpan:7,className:"text-center py-8",children:"Không tìm thấy menu"})}):(0,b.jsx)(n.SortableContext,{items:N.map(a=>a.id),strategy:n.verticalListSortingStrategy,children:M.map(a=>(0,b.jsx)(B,{menu:a,level:0,allMenus:L,onEdit:Y,onDelete:V,onToggleActive:W,onToggleVisibility:X,onToggleExpand:S,getTypeColor:H,expanded:a.expanded},a.id))})})]}),(0,b.jsx)(m.DragOverlay,{children:x?(0,b.jsx)("div",{className:"bg-background border rounded-lg p-4 shadow-lg",children:(0,b.jsx)("div",{className:"font-medium",children:N.find(a=>a.id===x)?.title})}):null})]})})]}),(0,b.jsx)(G,{open:r,onOpenChange:s,mode:"create",formData:C,onFormChange:D,onSubmit:T,menus:L}),(0,b.jsx)(G,{open:t,onOpenChange:u,mode:"edit",formData:C,onFormChange:D,onSubmit:U,menus:L,selectedMenuId:v?.id})]})}a.s(["default",()=>I],334800)}];

//# sourceMappingURL=frontend_src_app_admin_menu_page_tsx_4e5923da._.js.map