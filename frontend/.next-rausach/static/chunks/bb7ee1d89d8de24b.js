(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,874061,e=>{"use strict";let t=(0,e.i(930702).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["default",()=>t])},138227,e=>{"use strict";var t=e.i(874061);e.s(["Trash2",()=>t.default])},591353,e=>{"use strict";let t=(0,e.i(930702).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["default",()=>t])},404210,e=>{"use strict";var t=e.i(591353);e.s(["Eye",()=>t.default])},565977,e=>{"use strict";let t=(0,e.i(930702).default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["default",()=>t])},421329,e=>{"use strict";var t=e.i(565977);e.s(["FileText",()=>t.default])},645030,e=>{"use strict";var t=e.i(44990),a=e.i(403055),s=e.i(316618),l=e.i(873273),r="Progress",[i,n]=(0,s.createContextScope)(r),[d,o]=i(r),c=a.forwardRef((e,a)=>{var s,r;let{__scopeProgress:i,value:n=null,max:o,getValueLabel:c=p,...u}=e;(o||0===o)&&!g(o)&&console.error((s=`${o}`,`Invalid prop \`max\` of value \`${s}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let h=g(o)?o:100;null===n||f(n,h)||console.error((r=`${n}`,`Invalid prop \`value\` of value \`${r}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let v=f(n,h)?n:null,y=x(v)?c(v,h):void 0;return(0,t.jsx)(d,{scope:i,value:v,max:h,children:(0,t.jsx)(l.Primitive.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":x(v)?v:void 0,"aria-valuetext":y,role:"progressbar","data-state":m(v,h),"data-value":v??void 0,"data-max":h,...u,ref:a})})});c.displayName=r;var u="ProgressIndicator",h=a.forwardRef((e,a)=>{let{__scopeProgress:s,...r}=e,i=o(u,s);return(0,t.jsx)(l.Primitive.div,{"data-state":m(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:a})});function p(e,t){return`${Math.round(e/t*100)}%`}function m(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function x(e){return"number"==typeof e}function g(e){return x(e)&&!isNaN(e)&&e>0}function f(e,t){return x(e)&&!isNaN(e)&&e<=t&&e>=0}h.displayName=u;var v=e.i(541428);let y=a.forwardRef(({className:e,value:a,indicatorClassName:s,...l},r)=>(0,t.jsx)(c,{ref:r,className:(0,v.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...l,children:(0,t.jsx)(h,{className:(0,v.cn)("h-full w-full flex-1 bg-primary transition-all",s),style:{transform:`translateX(-${100-(a||0)}%)`}})}));y.displayName=c.displayName,e.s(["Progress",()=>y],645030)},833350,e=>{"use strict";let t=(0,e.i(930702).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["default",()=>t])},791174,e=>{"use strict";var t=e.i(833350);e.s(["RefreshCw",()=>t.default])},621924,e=>{"use strict";let t=(0,e.i(930702).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t])},822390,e=>{"use strict";var t=e.i(621924);e.s(["CheckCircle",()=>t.default])},980295,e=>{"use strict";let t=(0,e.i(930702).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["default",()=>t])},897711,e=>{"use strict";var t=e.i(980295);e.s(["Download",()=>t.default])},217696,e=>{"use strict";let t=(0,e.i(930702).default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["default",()=>t])},495043,e=>{"use strict";var t=e.i(217696);e.s(["MoreVertical",()=>t.default])},979426,e=>{"use strict";let t=(0,e.i(930702).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["default",()=>t])},455461,e=>{"use strict";var t=e.i(979426);e.s(["Upload",()=>t.default])},909181,e=>{"use strict";let t=(0,e.i(930702).default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);e.s(["default",()=>t])},742049,e=>{"use strict";var t=e.i(909181);e.s(["Archive",()=>t.default])},672974,e=>{"use strict";let t=(0,e.i(930702).default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["default",()=>t])},125282,e=>{"use strict";var t=e.i(672974);e.s(["Edit3",()=>t.default])},133523,e=>{"use strict";let t=(0,e.i(930702).default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);e.s(["default",()=>t])},711798,e=>{"use strict";var t=e.i(133523);e.s(["List",()=>t.default])},983551,e=>{"use strict";var t=e.i(27737);e.s(["Link",()=>t.default])},126795,e=>{"use strict";var t=e.i(124790);e.s(["Image",()=>t.default])},27737,e=>{"use strict";let t=(0,e.i(930702).default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["default",()=>t])},124790,e=>{"use strict";let t=(0,e.i(930702).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>t])},240243,e=>{"use strict";var t=e.i(840041);e.s(["Grid3x3",()=>t.default])},823186,e=>{"use strict";var t=e.i(978803);e.s(["Video",()=>t.default])},275206,e=>{"use strict";let t=(0,e.i(930702).default)("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);e.s(["default",()=>t])},392636,e=>{"use strict";let t=(0,e.i(930702).default)("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);e.s(["default",()=>t])},840041,e=>{"use strict";let t=(0,e.i(930702).default)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);e.s(["default",()=>t])},978803,e=>{"use strict";let t=(0,e.i(930702).default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);e.s(["default",()=>t])},746969,e=>{"use strict";var t=e.i(392636);e.s(["File",()=>t.default])},350856,10691,524262,351845,508195,e=>{"use strict";var t,a,s=e.i(44990),l=e.i(403055);e.i(308140);var r=e.i(950988),i=e.i(429105),n=e.i(984804);let d=n.gql`
  fragment FileFields on File {
    id
    filename
    originalName
    mimeType
    size
    fileType
    url
    bucket
    path
    folderId
    userId
    visibility
    title
    description
    alt
    tags
    metadata
    width
    height
    thumbnailUrl
    downloadCount
    viewCount
    createdAt
    updatedAt
  }
`,o=n.gql`
  fragment FolderFields on FileFolder {
    id
    name
    description
    parentId
    path
    userId
    color
    icon
    isSystem
    createdAt
    updatedAt
  }
`;n.gql`
  ${d}
  query GetFile($id: ID!) {
    file(id: $id) {
      ...FileFields
      folder {
        id
        name
        path
      }
    }
  }
`;let c=n.gql`
  ${d}
  query GetFiles($input: GetFilesInput) {
    files(input: $input) {
      items {
        ...FileFields
        folder {
          id
          name
          path
        }
      }
      total
      page
      limit
      totalPages
      hasNextPage
      hasPreviousPage
    }
  }
`;n.gql`
  ${o}
  query GetFolder($id: ID!) {
    folder(id: $id) {
      ...FolderFields
      parent {
        id
        name
        path
      }
      children {
        id
        name
        path
      }
      files {
        id
        filename
        originalName
        url
        fileType
        size
      }
    }
  }
`,n.gql`
  ${o}
  query GetFolders {
    folders {
      ...FolderFields
      children {
        id
        name
        path
      }
    }
  }
`;let u=n.gql`
  query GetStorageStats {
    fileStorageStats {
      totalFiles
      totalSize
      totalFolders
      filesByType {
        type
        count
        totalSize
      }
      filesByVisibility {
        visibility
        count
      }
    }
  }
`;n.gql`
  ${d}
  mutation UpdateFile($input: UpdateFileInput!) {
    updateFile(input: $input) {
      ...FileFields
    }
  }
`;let h=n.gql`
  mutation DeleteFile($id: ID!) {
    deleteFile(id: $id)
  }
`;n.gql`
  ${d}
  mutation MoveFiles($input: MoveFilesInput!) {
    moveFiles(input: $input) {
      ...FileFields
    }
  }
`;let p=n.gql`
  mutation BulkDeleteFiles($input: BulkDeleteFilesInput!) {
    bulkDeleteFiles(input: $input)
  }
`;function m(e){let{data:t,loading:a,error:s,refetch:l}=(0,i.useQuery)(c,{variables:{input:e},fetchPolicy:"cache-and-network"});return{files:t?.files,loading:a,error:s,refetch:l}}function x(){let{data:e,loading:t,error:a,refetch:s}=(0,i.useQuery)(u,{fetchPolicy:"cache-and-network"});return{stats:e?.fileStorageStats,loading:t,error:a,refetch:s}}function g(){let[e,t]=(0,l.useState)(!1),[a,s]=(0,l.useState)(0);return{uploadFile:async(e,a,l)=>{t(!0),s(0);try{let t=new FormData;t.append("file",e),a&&t.append("folderId",a),l&&t.append("metadata",JSON.stringify(l));let r=await fetch("https://api.rausachtrangia.com/api/files/upload",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:t});if(!r.ok)throw Error("Upload failed");let i=await r.json();return s(100),i}catch(e){throw e}finally{t(!1)}},uploadFiles:async(e,a)=>{t(!0),s(0);try{let t=new FormData;e.forEach(e=>t.append("files",e)),a&&t.append("folderId",a);let l=await fetch("https://api.rausachtrangia.com/api/files/upload/bulk",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:t});if(!l.ok)throw Error("Upload failed");let r=await l.json();return s(100),r}catch(e){throw e}finally{t(!1)}},uploading:e,progress:a}}function f(){let[e,{loading:t,error:a}]=(0,r.useMutation)(h,{refetchQueries:[{query:c}]});return{deleteFile:async t=>{let a=await e({variables:{id:t}});return a.data?.deleteFile},loading:t,error:a}}function v(){let[e,{loading:t,error:a}]=(0,r.useMutation)(p,{refetchQueries:[{query:c}]});return{bulkDeleteFiles:async t=>{let a=await e({variables:{input:t}});return a.data?.bulkDeleteFiles},loading:t,error:a}}n.gql`
  ${d}
  mutation BulkUpdateFiles($input: BulkUpdateFilesInput!) {
    bulkUpdateFiles(input: $input) {
      ...FileFields
    }
  }
`,n.gql`
  ${o}
  mutation CreateFolder($input: CreateFolderInput!) {
    createFolder(input: $input) {
      ...FolderFields
    }
  }
`,n.gql`
  ${o}
  mutation UpdateFolder($input: UpdateFolderInput!) {
    updateFolder(input: $input) {
      ...FolderFields
    }
  }
`,n.gql`
  mutation DeleteFolder($id: ID!) {
    deleteFolder(id: $id)
  }
`,n.gql`
  mutation CreateFileShare($input: CreateFileShareInput!) {
    createFileShare(input: $input) {
      id
      fileId
      token
      sharedBy
      sharedWith
      expiresAt
      canDownload
      canView
      createdAt
    }
  }
`,e.s(["useBulkDeleteFiles",()=>v,"useDeleteFile",()=>f,"useFileUpload",()=>g,"useFiles",()=>m,"useStorageStats",()=>x],10691);var y=((t={}).IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT",t.ARCHIVE="ARCHIVE",t.OTHER="OTHER",t);(a={}).PUBLIC="PUBLIC",a.PRIVATE="PRIVATE",a.SHARED="SHARED",e.s(["FileType",()=>y],524262);var j=e.i(775680),b=e.i(885205),N=e.i(696134),w=e.i(702470),k=e.i(137651),C=e.i(645030),F=e.i(455461),M=e.i(888540),D=e.i(392636),D=D,I=e.i(822390),S=e.i(198513),T=e.i(541428);let $=({open:e,onOpenChange:t,onUpload:a,onUploadSuccess:r,folderId:i})=>{let n=(0,l.useRef)(null),[d,o]=(0,l.useState)([]),[c,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1),m=(0,l.useCallback)(e=>{let t=Array.from(e).map(e=>({file:e,id:`${e.name}-${Date.now()}-${Math.random()}`,status:"pending",progress:0}));o(e=>[...e,...t])},[]),x=(0,l.useCallback)(e=>{e.preventDefault(),u(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&m(e.dataTransfer.files)},[m]),g=(0,l.useCallback)(e=>{e.preventDefault(),u(!0)},[]),f=(0,l.useCallback)(e=>{e.preventDefault(),u(!1)},[]),v=async()=>{if(0!==d.length){p(!0);try{let e=d.map(e=>e.file);await a(e),o(e=>e.map(e=>({...e,status:"success",progress:100}))),r&&r(),setTimeout(()=>{t(!1),o([])},1500)}catch(e){o(t=>t.map(t=>({...t,status:"error",error:e.message||"Upload failed"})))}finally{p(!1)}}};return(0,s.jsx)(k.Dialog,{open:e,onOpenChange:t,children:(0,s.jsxs)(k.DialogContent,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[(0,s.jsx)(k.DialogHeader,{children:(0,s.jsxs)(k.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(F.Upload,{className:"h-5 w-5"}),"Upload Files",d.length>0&&(0,s.jsxs)(w.Badge,{variant:"secondary",className:"ml-2",children:[d.length," file",d.length>1?"s":""]})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 py-4",children:[(0,s.jsxs)("div",{onDrop:x,onDragOver:g,onDragLeave:f,className:(0,T.cn)("border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",c?"border-blue-500 bg-blue-50 dark:bg-blue-950":"border-gray-300 hover:border-gray-400 dark:border-gray-700"),onClick:()=>n.current?.click(),children:[(0,s.jsx)(F.Upload,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"Drop files here or click to browse"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Support for multiple files upload"}),(0,s.jsx)("input",{ref:n,type:"file",multiple:!0,className:"hidden",onChange:e=>{e.target.files&&e.target.files.length>0&&m(e.target.files)}})]}),d.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium",children:"Files to upload:"}),(0,s.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:d.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[(e=>{switch(e){case"success":return(0,s.jsx)(I.CheckCircle,{className:"h-4 w-4 text-green-500"});case"error":return(0,s.jsx)(S.AlertCircle,{className:"h-4 w-4 text-red-500"});case"uploading":return(0,s.jsx)("div",{className:"h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"});default:return(0,s.jsx)(D.default,{className:"h-4 w-4 text-gray-400"})}})(e.status),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium truncate",children:e.file.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]})(e.file.size)}),"uploading"===e.status&&(0,s.jsx)(C.Progress,{value:e.progress,className:"h-1 mt-2"}),e.error&&(0,s.jsx)("p",{className:"text-xs text-red-500 mt-1",children:e.error})]}),(e=>{switch(e){case"success":return(0,s.jsx)(w.Badge,{variant:"default",className:"bg-green-500",children:"Success"});case"error":return(0,s.jsx)(w.Badge,{variant:"destructive",children:"Error"});case"uploading":return(0,s.jsx)(w.Badge,{variant:"secondary",children:"Uploading..."});default:return(0,s.jsx)(w.Badge,{variant:"outline",children:"Pending"})}})(e.status),"pending"===e.status&&!h&&(0,s.jsx)(b.Button,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void o(e=>e.filter(e=>e.id!==t))},className:"h-8 w-8 p-0",children:(0,s.jsx)(M.X,{className:"h-4 w-4"})})]},e.id))})]})]}),(0,s.jsxs)(k.DialogFooter,{className:"gap-2",children:[(0,s.jsx)(b.Button,{variant:"outline",onClick:()=>{t(!1),o([])},disabled:h,children:"Cancel"}),(0,s.jsx)(b.Button,{onClick:v,disabled:0===d.length||h,children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Uploading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.Upload,{className:"h-4 w-4 mr-2"}),"Upload ",d.length," file",d.length>1?"s":""]})})]})]})})};e.s(["UploadDialog",0,$],351845);var B=e.i(240243),U=e.i(711798),P=e.i(850384),z=e.i(746969),A=e.i(126795),E=e.i(823186),q=e.i(275206);e.s(["Music",()=>q.default],508195);var q=q,V=e.i(421329),O=e.i(742049),R=e.i(138227),H=e.i(897711),L=e.i(404210),G=e.i(495043),K=e.i(791174),Q=e.i(135369),_=e.i(4993);function W({onSelect:e,allowMultiple:t=!1,folderId:a,fileTypes:r,viewMode:i,sortBy:n,searchQuery:d,filter:o,limit:c=20}){let[u,h]=(0,l.useState)("grid"),[p,x]=(0,l.useState)(""),[k,C]=(0,l.useState)(new Set),[M,D]=(0,l.useState)(1),[I,S]=(0,l.useState)(!1),{toast:T}=(0,_.useToast)(),W=i||u,X=void 0!==d?d:p,Z=n||{field:"date",order:"desc"},{files:J,loading:Y,refetch:ee}=m({page:M,limit:c,filters:{...a&&{folderId:a},...X&&{search:X},...o?.type&&{fileType:o.type},...r&&r.length>0&&!o?.type&&{fileType:r[0]}},sortBy:"name"===Z.field?"filename":"date"===Z.field?"createdAt":"size",sortOrder:Z.order}),{uploadFile:et,uploadFiles:ea,uploading:es}=g(),{deleteFile:el}=f(),{bulkDeleteFiles:er}=v(),ei=(0,l.useCallback)(async e=>{try{let t=Array.from(e);1===t.length?await et(t[0],a):await ea(t,a),T({type:"success",title:"Success",description:`${t.length} file(s) uploaded successfully`}),ee(),S(!1)}catch(e){T({type:"error",title:"Error",description:e.message||"Failed to upload files",variant:"destructive"})}},[et,ea,a,ee,T]),en=(0,l.useCallback)(e=>{e.preventDefault();let t=e.dataTransfer.files;t.length>0&&ei(t)},[ei]),ed=(0,l.useCallback)(e=>{e.preventDefault()},[]),eo=e=>{let a=new Set(k);a.has(e)?a.delete(e):(t||a.clear(),a.add(e)),C(a)},ec=async e=>{if(confirm("Are you sure you want to delete this file?"))try{await el(e),T({type:"success",title:"Success",description:"File deleted successfully"}),ee()}catch(e){T({type:"error",title:"Error",description:e.message||"Failed to delete file",variant:"destructive"})}},eu=async()=>{if(0!==k.size&&confirm(`Delete ${k.size} selected file(s)?`))try{await er({fileIds:Array.from(k)}),T({type:"success",title:"Success",description:`${k.size} file(s) deleted successfully`}),C(new Set),ee()}catch(e){T({type:"error",title:"Error",description:e.message||"Failed to delete files",variant:"destructive"})}},eh=e=>{switch(e){case y.IMAGE:return(0,s.jsx)(A.Image,{className:"w-5 h-5"});case y.VIDEO:return(0,s.jsx)(E.Video,{className:"w-5 h-5"});case y.AUDIO:return(0,s.jsx)(q.default,{className:"w-5 h-5"});case y.DOCUMENT:return(0,s.jsx)(V.FileText,{className:"w-5 h-5"});case y.ARCHIVE:return(0,s.jsx)(O.Archive,{className:"w-5 h-5"});default:return(0,s.jsx)(z.File,{className:"w-5 h-5"})}},ep=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]};return(0,s.jsxs)("div",{className:"w-full h-full flex flex-col",children:[void 0===i&&void 0===d&&(0,s.jsx)(j.Card,{className:"mb-4",children:(0,s.jsx)(j.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsx)("div",{className:"flex-1 max-w-md",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(P.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,s.jsx)(N.Input,{placeholder:"Search files...",value:p,onChange:e=>x(e.target.value),className:"pl-10"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(b.Button,{variant:"default",size:"sm",disabled:es,onClick:()=>S(!0),children:[(0,s.jsx)(F.Upload,{className:"w-4 h-4 mr-2"}),"Upload"]}),k.size>0&&(0,s.jsxs)(b.Button,{variant:"destructive",size:"sm",onClick:eu,children:[(0,s.jsx)(R.Trash2,{className:"w-4 h-4 mr-2"}),"Delete (",k.size,")"]}),(0,s.jsx)(b.Button,{variant:"outline",size:"sm",onClick:()=>ee(),children:(0,s.jsx)(K.RefreshCw,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"flex border rounded-md",children:[(0,s.jsx)(b.Button,{variant:"grid"===W?"default":"ghost",size:"sm",onClick:()=>h("grid"),className:"rounded-r-none",children:(0,s.jsx)(B.Grid3x3,{className:"w-4 h-4"})}),(0,s.jsx)(b.Button,{variant:"list"===W?"default":"ghost",size:"sm",onClick:()=>h("list"),className:"rounded-l-none",children:(0,s.jsx)(U.List,{className:"w-4 h-4"})})]})]})]})})}),(0,s.jsx)($,{open:I,onOpenChange:S,onUpload:ei,onUploadSuccess:()=>{ee(),S(!1)},folderId:a}),(0,s.jsx)("div",{onDrop:en,onDragOver:ed,className:"flex-1 border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 dark:bg-gray-900",children:Y?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):J&&J.items.length>0?(0,s.jsxs)(s.Fragment,{children:["grid"===W&&(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:J.items.map(e=>(0,s.jsx)(j.Card,{className:`cursor-pointer hover:shadow-lg transition-shadow ${k.has(e.id)?"ring-2 ring-blue-500":""}`,onClick:()=>eo(e.id),children:(0,s.jsxs)(j.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"aspect-square bg-gray-100 dark:bg-gray-800 rounded-md mb-3 flex items-center justify-center overflow-hidden",children:e.fileType===y.IMAGE?(0,s.jsx)("img",{src:e.url,alt:e.originalName,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"text-gray-400",children:eh(e.fileType)})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium truncate",title:e.originalName,children:e.originalName}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:ep(e.size)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,s.jsx)(w.Badge,{variant:"secondary",className:"text-xs",children:e.fileType}),(0,s.jsxs)(Q.DropdownMenu,{children:[(0,s.jsx)(Q.DropdownMenuTrigger,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,s.jsx)(b.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,s.jsx)(G.MoreVertical,{className:"w-4 h-4"})})}),(0,s.jsxs)(Q.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),window.open(e.url,"_blank")},children:[(0,s.jsx)(L.Eye,{className:"w-4 h-4 mr-2"}),"View"]}),(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),window.open(e.url,"_blank")},children:[(0,s.jsx)(H.Download,{className:"w-4 h-4 mr-2"}),"Download"]}),(0,s.jsx)(Q.DropdownMenuSeparator,{}),(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),ec(e.id)},className:"text-red-600",children:[(0,s.jsx)(R.Trash2,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})},e.id))}),"list"===W&&(0,s.jsx)("div",{className:"space-y-2",children:J.items.map(e=>(0,s.jsx)(j.Card,{className:`cursor-pointer hover:shadow-md transition-shadow ${k.has(e.id)?"ring-2 ring-blue-500":""}`,onClick:()=>eo(e.id),children:(0,s.jsx)(j.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,s.jsx)("div",{className:"text-gray-400",children:eh(e.fileType)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium truncate",children:e.originalName}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,s.jsx)("span",{children:ep(e.size)}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)(w.Badge,{variant:"secondary",children:e.fileType})]})]})]}),(0,s.jsxs)(Q.DropdownMenu,{children:[(0,s.jsx)(Q.DropdownMenuTrigger,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,s.jsx)(b.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(G.MoreVertical,{className:"w-4 h-4"})})}),(0,s.jsxs)(Q.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),window.open(e.url,"_blank")},children:[(0,s.jsx)(L.Eye,{className:"w-4 h-4 mr-2"}),"View"]}),(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),window.open(e.url,"_blank")},children:[(0,s.jsx)(H.Download,{className:"w-4 h-4 mr-2"}),"Download"]}),(0,s.jsx)(Q.DropdownMenuSeparator,{}),(0,s.jsxs)(Q.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),ec(e.id)},className:"text-red-600",children:[(0,s.jsx)(R.Trash2,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})})},e.id))}),J.totalPages>1&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-6",children:[(0,s.jsx)(b.Button,{variant:"outline",size:"sm",disabled:!J.hasPreviousPage,onClick:()=>D(M-1),children:"Previous"}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Page ",J.page," of ",J.totalPages]}),(0,s.jsx)(b.Button,{variant:"outline",size:"sm",disabled:!J.hasNextPage,onClick:()=>D(M+1),children:"Next"})]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[(0,s.jsx)(F.Upload,{className:"w-16 h-16 mb-4"}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"No files yet"}),(0,s.jsx)("p",{className:"text-sm mb-4",children:"Drop files here or click upload button"})]})})]})}e.s(["FileManager",()=>W],350856)},297562,e=>{"use strict";var t=e.i(44990),a=e.i(403055),s=e.i(125282),l=e.i(138227),r=e.i(455461),i=e.i(126795),n=e.i(350856),d=e.i(137651),o=e.i(885205),c=e.i(996517),u=e.i(696134),h=e.i(165429),p=e.i(983551);function m({open:e,onOpenChange:s,onSelect:l,allowMultiple:r=!1,fileTypes:i,allowUrl:m=!0}){let[x,g]=(0,a.useState)(null),[f,v]=(0,a.useState)(""),[y,j]=(0,a.useState)("browse");return(0,t.jsx)(d.Dialog,{open:e,onOpenChange:s,children:(0,t.jsxs)(d.DialogContent,{className:"max-w-5xl h-[80vh] flex flex-col",children:[(0,t.jsx)(d.DialogHeader,{children:(0,t.jsx)(d.DialogTitle,{children:"Select File"})}),(0,t.jsxs)(c.Tabs,{value:y,onValueChange:e=>j(e),className:"flex-1 flex flex-col",children:[(0,t.jsxs)(c.TabsList,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(c.TabsTrigger,{value:"browse",children:"Browse Files"}),m&&(0,t.jsx)(c.TabsTrigger,{value:"url",children:"Enter URL"})]}),(0,t.jsx)(c.TabsContent,{value:"browse",className:"flex-1 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full",children:(0,t.jsx)(n.FileManager,{onSelect:e=>{g(e)},allowMultiple:r,fileTypes:i})})}),m&&(0,t.jsx)(c.TabsContent,{value:"url",className:"flex-1",children:(0,t.jsxs)("div",{className:"space-y-4 p-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"url-input",children:"Image URL"}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(p.Link,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)(u.Input,{id:"url-input",placeholder:"https://example.com/image.jpg",value:f,onChange:e=>v(e.target.value),className:"pl-10"})]})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Enter a direct URL to an image file"})]}),f&&(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium mb-2",children:"Preview:"}),(0,t.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-md aspect-video flex items-center justify-center overflow-hidden",children:(0,t.jsx)("img",{src:f,alt:"Preview",className:"max-w-full max-h-full object-contain",onError:e=>{e.target.style.display="none"}})})]})]})})]}),(0,t.jsxs)(d.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>{s(!1),g(null),v("")},children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:()=>{"browse"===y&&x?(l(x),s(!1),g(null)):"url"===y&&f.trim()&&(l(f.trim()),s(!1),v(""))},disabled:"browse"===y&&!x||"url"===y&&!f.trim(),children:"Select"})]})]})})}var x=e.i(524262);e.s(["ImageBlock",0,({block:e,isEditable:n=!1,onUpdate:d,onDelete:c})=>{let[u,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(e.content),[f,v]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1);return u&&n?(0,t.jsx)("div",{className:"relative border-2 border-blue-500 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Chọn Hình Ảnh"}),(0,t.jsxs)(o.Button,{type:"button",variant:"outline",onClick:()=>j(!0),className:"w-full",children:[(0,t.jsx)(i.Image,{className:"w-4 h-4 mr-2"}),"Chọn từ thư viện hoặc nhập URL"]}),p.src&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)("img",{src:p.src,alt:"Preview",className:"max-w-full h-32 object-contain rounded border"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Hoặc nhập trực tiếp URL hình ảnh"}),(0,t.jsx)("input",{type:"url",value:p.src||"",onChange:e=>g(t=>({...t,src:e.target.value})),className:"w-full p-2 border rounded",placeholder:"https://example.com/image.jpg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Alt Text"}),(0,t.jsx)("input",{type:"text",value:p.alt||"",onChange:e=>g(t=>({...t,alt:e.target.value})),className:"w-full p-2 border rounded",placeholder:"Mô tả hình ảnh..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Caption (Tùy chọn)"}),(0,t.jsx)("input",{type:"text",value:p.caption||"",onChange:e=>g(t=>({...t,caption:e.target.value})),className:"w-full p-2 border rounded",placeholder:"Chú thích hình ảnh..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Kích Thước Hình Ảnh"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Chiều rộng (px)"}),(0,t.jsx)("input",{type:"number",value:p.width||"",onChange:e=>g(t=>({...t,width:parseInt(e.target.value)||void 0})),className:"w-full p-2 border rounded text-sm",placeholder:"Auto",min:"1",max:"2000"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Chiều cao (px)"}),(0,t.jsx)("input",{type:"number",value:p.height||"",onChange:e=>g(t=>({...t,height:parseInt(e.target.value)||void 0})),className:"w-full p-2 border rounded text-sm",placeholder:"Auto",min:"1",max:"2000"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Object Fit"}),(0,t.jsxs)("select",{value:p.objectFit||"cover",onChange:e=>g(t=>({...t,objectFit:e.target.value})),className:"w-full p-2 border rounded text-sm",children:[(0,t.jsx)("option",{value:"cover",children:"Cover"}),(0,t.jsx)("option",{value:"contain",children:"Contain"}),(0,t.jsx)("option",{value:"fill",children:"Fill"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{d?.(p,e.style),h(!1)},className:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600",children:"Save"}),(0,t.jsx)("button",{onClick:()=>{g(e.content),h(!1)},className:"px-3 py-1 bg-gray-500 text-white rounded text-sm hover:bg-gray-600",children:"Cancel"})]})]})}):p.src?(0,t.jsxs)("div",{className:`relative group ${n?"hover:ring-2 hover:ring-blue-300":""}`,children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("img",{src:p.src,alt:p.alt||"",style:{width:p.width?`${p.width}px`:"auto",height:p.height?`${p.height}px`:"auto",objectFit:p.objectFit||"cover",maxWidth:"100%"},className:"mx-auto rounded-lg"}),p.caption&&(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600 italic",children:p.caption})]}),n&&(0,t.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>h(!0),className:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600",title:"Edit",children:(0,t.jsx)(s.Edit3,{size:12})}),(0,t.jsx)("button",{onClick:c,className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Delete",children:(0,t.jsx)(l.Trash2,{size:12})})]})}),(0,t.jsx)(m,{open:y,onOpenChange:j,onSelect:e=>{"string"==typeof e?g(t=>({...t,src:e})):g(t=>({...t,src:e.url,alt:e.originalName}))},fileTypes:[x.FileType.IMAGE],allowUrl:!0})]}):(0,t.jsxs)("div",{className:`relative group border-2 border-dashed border-gray-300 rounded-lg p-8 text-center ${n?"hover:ring-2 hover:ring-blue-300 cursor-pointer":""}`,onClick:()=>n&&h(!0),children:[(0,t.jsx)(r.Upload,{className:"mx-auto mb-2 text-gray-400",size:48}),(0,t.jsx)("p",{className:"text-gray-500",children:"Click to add an image"}),n&&(0,t.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),c?.()},className:"p-1 bg-red-500 text-white rounded hover:bg-red-600",title:"Delete",children:(0,t.jsx)(l.Trash2,{size:12})})})]})}],297562)}]);