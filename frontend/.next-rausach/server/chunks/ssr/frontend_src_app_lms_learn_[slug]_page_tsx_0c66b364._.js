module.exports=[134392,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(168918),e=a.i(53627),f=a.i(852854),g=a.i(235746);let h=(0,a.i(633315).default)(async()=>{},{loadableGenerated:{modules:[233025]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"w-full aspect-video bg-gray-900 flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-white",children:"Loading player..."})})});function i({src:a,poster:d,onProgress:e,onComplete:f,autoPlay:g=!1,startTime:i=0}){let j=(0,c.useRef)(null),k=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let a=j.current?.plyr;if(!a||"function"!=typeof a.on)return;i>0&&(a.currentTime=i);let b=()=>{if(a&&a.duration){let b=a.currentTime/a.duration*100;e?.(b)}},c=()=>{b()},d=()=>{e?.(100),f?.(),k.current&&clearInterval(k.current)};return a.on("timeupdate",c),a.on("ended",d),k.current=setInterval(b,5e3),()=>{try{a&&"function"==typeof a.off&&(a.off("timeupdate",c),a.off("ended",d))}catch(a){console.warn("Error removing player event listeners:",a)}k.current&&clearInterval(k.current)}},[e,f,i]),(0,b.jsx)("div",{className:"w-full rounded-lg overflow-hidden bg-black",children:(0,b.jsx)(h,{ref:j,source:{type:"video",sources:[{src:a,type:"video/mp4"}],poster:d},options:{controls:["play-large","restart","rewind","play","fast-forward","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2]},quality:{default:720,options:[4320,2880,2160,1440,1080,720,576,480,360,240]},autoplay:g,keyboard:{focused:!0,global:!0}}})})}var j=a.i(8912),k=a.i(772213);k.gql`
  query GetQuiz($id: ID!) {
    quiz(id: $id) {
      id
      title
      description
      passingScore
      timeLimit
      questions {
        id
        type
        question
        points
        order
        explanation
        answers {
          id
          text
          order
        }
      }
    }
  }
`,k.gql`
  query GetQuizzesByLesson($lessonId: ID!) {
    quizzesByLesson(lessonId: $lessonId) {
      id
      title
      description
      passingScore
      timeLimit
    }
  }
`;let l=k.gql`
  mutation SubmitQuiz($input: SubmitQuizInput!) {
    submitQuiz(input: $input) {
      id
      score
      passed
      timeSpent
      completedAt
      quiz {
        id
        title
        passingScore
        questions {
          id
          question
          type
          points
          explanation
          answers {
            id
            text
            isCorrect
          }
        }
      }
    }
  }
`;k.gql`
  query GetQuizAttempts($quizId: ID!) {
    quizAttempts(quizId: $quizId) {
      id
      score
      passed
      timeSpent
      startedAt
      completedAt
    }
  }
`,k.gql`
  query GetQuizAttempt($id: ID!) {
    quizAttempt(id: $id) {
      id
      score
      passed
      answers
      timeSpent
      startedAt
      completedAt
      quiz {
        id
        title
        description
        passingScore
        questions {
          id
          question
          type
          points
          order
          explanation
          answers {
            id
            text
            isCorrect
            order
          }
        }
      }
    }
  }
`;var m=a.i(411185),n=a.i(508335),o=a.i(390874),p=a.i(327987);function q({quizId:a,enrollmentId:d,onComplete:e}){let f,[h,i]=(0,c.useState)(0),[k,q]=(0,c.useState)({}),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!1),[v]=(0,c.useState)(Date.now()),{data:w,loading:x,error:y}=(0,g.useFindUnique)("quiz",a,{include:{questions:{include:{answers:!0},orderBy:{order:"asc"}}}}),[z]=(0,j.useMutation)(l);(0,c.useEffect)(()=>{w?.timeLimit&&s(60*w.timeLimit)},[w]),(0,c.useEffect)(()=>{if(null===r||r<=0)return;let a=setInterval(()=>{s(a=>null===a||a<=1?(A(),0):a-1)},1e3);return()=>clearInterval(a)},[r]);let A=async()=>{if(!t){u(!0);try{let b=Math.floor((Date.now()-v)/1e3),c=Object.entries(k).map(([a,b])=>({questionId:a,selectedAnswerIds:b})),{data:f}=await z({variables:{input:{quizId:a,enrollmentId:d,answers:c,timeSpent:b}}});f?.submitQuiz?.id&&e(f.submitQuiz.id)}catch(a){console.error("Error submitting quiz:",a),alert("Failed to submit quiz. Please try again."),u(!1)}}};if(x)return(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(y||!w)return(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,b.jsx)(o.XCircle,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Failed to load quiz"}),(0,b.jsx)("p",{className:"text-red-700",children:y?.message||"Quiz not found"})]});if(!w.questions||0===w.questions.length)return(0,b.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[(0,b.jsx)(p.AlertCircle,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"No Questions Available"}),(0,b.jsx)("p",{className:"text-yellow-700",children:"This quiz does not have any questions yet."})]});let B=w.questions[h],C=Object.keys(k).length,D=w.questions.length,E=h===D-1,F=C===D;return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:w.title}),w.description&&(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:w.description})]}),null!==r&&(0,b.jsxs)("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg ${r<60?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:[(0,b.jsx)(m.Clock,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-lg font-semibold",children:(f=Math.floor(r/60),`${f}:${(r%60).toString().padStart(2,"0")}`)})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${C/D*100}%`}})}),(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[C,"/",D]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Questions"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:w.questions.map((a,c)=>{let d=k[a.id]?.length>0,e=c===h;return(0,b.jsx)("button",{onClick:()=>{i(c)},className:`w-10 h-10 rounded-lg font-semibold transition-colors ${e?"bg-blue-600 text-white":d?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:c+1},a.id)})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 mb-6",children:[(0,b.jsx)("div",{className:"flex items-start justify-between mb-6",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["Question ",h+1," of ",D]}),(0,b.jsxs)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:[B.points," ",1===B.points?"point":"points"]})]}),(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:B.question})]})}),(0,b.jsx)("div",{className:"space-y-3",children:[...B.answers].sort((a,b)=>a.order-b.order).map(a=>{let c=k[B.id]?.includes(a.id),d="MULTIPLE_CHOICE"===B.type&&B.answers.filter(a=>a.isCorrect).length>1;return(0,b.jsx)("button",{onClick:()=>{var b,c;return b=B.id,c=a.id,void q(a=>{let e=a[b]||[];return d?e.includes(c)?{...a,[b]:e.filter(a=>a!==c)}:{...a,[b]:[...e,c]}:{...a,[b]:[c]}})},className:`w-full text-left p-4 rounded-lg border-2 transition-all ${c?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${c?"border-blue-600 bg-blue-600":"border-gray-300"}`,children:c&&(0,b.jsx)("div",{className:"w-2 h-2 bg-white rounded-full"})}),(0,b.jsx)("span",{className:"text-gray-900 font-medium",children:a.text})]})},a.id)})}),"MULTIPLE_CHOICE"===B.type&&B.answers.filter(a=>a.isCorrect).length>1&&(0,b.jsxs)("div",{className:"mt-4 flex items-center gap-2 text-sm text-blue-600",children:[(0,b.jsx)(p.AlertCircle,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Select all correct answers"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)("button",{onClick:()=>{h>0&&i(h-1)},disabled:0===h,className:"px-6 py-3 bg-gray-100 hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 text-gray-700 font-semibold rounded-lg transition-colors",children:"Previous"}),(0,b.jsx)("div",{className:"flex gap-3",children:E?(0,b.jsx)("button",{onClick:A,disabled:!F||t,className:"px-8 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors flex items-center gap-2",children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Submitting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.CheckCircle,{className:"w-5 h-5"}),"Submit Quiz"]})}):(0,b.jsx)("button",{onClick:()=>{w&&h<w.questions.length-1&&i(h+1)},className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"Next Question"})})]}),!F&&E&&(0,b.jsxs)("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3",children:[(0,b.jsx)(p.AlertCircle,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),(0,b.jsxs)("p",{className:"text-sm text-yellow-800",children:["Please answer all questions before submitting. Unanswered: ",D-C]})]})]})}var r=a.i(388339),s=a.i(395992);function t({attemptId:a,onRetake:c,onContinue:d}){let{data:e,loading:f,error:h}=(0,g.useFindUnique)("quizAttempt",a,{include:{quiz:{include:{questions:{include:{answers:!0},orderBy:{order:"asc"}}}}}});if(f)return(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(h||!e)return(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,b.jsx)(o.XCircle,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Failed to load results"}),(0,b.jsx)("p",{className:"text-red-700",children:h?.message||"Results not found"})]});if(!e.quiz||!e.quiz.questions)return(0,b.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[(0,b.jsx)(p.AlertCircle,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"Incomplete Data"}),(0,b.jsx)("p",{className:"text-yellow-700",children:"Quiz data is not available for this attempt"})]});let i=JSON.parse(e.answers||"{}"),j=e.quiz.questions.length,k=0;return e.quiz.questions.forEach(a=>{let b=i[a.id]||[],c=a.answers.filter(a=>a.isCorrect).map(a=>a.id);b.length===c.length&&b.every(a=>c.includes(a))&&c.every(a=>b.includes(a))&&k++}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("div",{className:`rounded-xl shadow-lg border-2 p-8 mb-8 ${e.passed?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-r from-red-50 to-orange-50 border-red-200"}`,children:(0,b.jsxs)("div",{className:"text-center",children:[e.passed?(0,b.jsx)(r.Trophy,{className:"w-20 h-20 text-green-600 mx-auto mb-4"}):(0,b.jsx)(o.XCircle,{className:"w-20 h-20 text-red-600 mx-auto mb-4"}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e.passed?"Congratulations!":"Keep Trying!"}),(0,b.jsx)("p",{className:"text-lg text-gray-700 mb-6",children:e.passed?`You passed the quiz with ${e.score.toFixed(1)}%`:`You scored ${e.score.toFixed(1)}%. You need ${e.quiz.passingScore}% to pass.`}),(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-32 h-32 rounded-full bg-white shadow-lg mb-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:`text-4xl font-bold ${e.passed?"text-green-600":"text-red-600"}`,children:[e.score.toFixed(0),"%"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Score"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4 max-w-2xl mx-auto",children:[(0,b.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,b.jsx)(n.CheckCircle,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:k})]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Correct"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,b.jsx)(o.XCircle,{className:"w-5 h-5 text-red-600"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:j-k})]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Incorrect"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,b.jsx)(m.Clock,{className:"w-5 h-5 text-blue-600"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:(a=>{if(!a)return"N/A";let b=Math.floor(a/60);return`${b}m ${a%60}s`})(e.timeSpent)})]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Time"})]})]})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[(0,b.jsx)(s.Target,{className:"w-6 h-6 text-blue-600"}),"Question Review"]}),(0,b.jsx)("div",{className:"space-y-6",children:[...e.quiz.questions].sort((a,b)=>a.order-b.order).map((a,c)=>{let d=i[a.id]||[],e=a.answers.filter(a=>a.isCorrect).map(a=>a.id),f=d.length===e.length&&d.every(a=>e.includes(a))&&e.every(a=>d.includes(a));return(0,b.jsx)("div",{className:`border-2 rounded-lg p-6 ${f?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[f?(0,b.jsx)(n.CheckCircle,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}):(0,b.jsx)(o.XCircle,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-1"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("span",{className:"text-sm font-semibold text-gray-600",children:["Question ",c+1]}),(0,b.jsxs)("span",{className:"px-2 py-1 bg-white text-gray-700 text-xs font-medium rounded",children:[a.points," pts"]})]}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:a.question}),(0,b.jsx)("div",{className:"space-y-2",children:[...a.answers].sort((a,b)=>a.order-b.order).map(a=>{let c=d.includes(a.id),e=a.isCorrect;return(0,b.jsx)("div",{className:`p-3 rounded-lg border-2 ${e&&c?"border-green-500 bg-green-100":e?"border-green-300 bg-green-50":c?"border-red-500 bg-red-100":"border-gray-200 bg-white"}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[e&&(0,b.jsx)(n.CheckCircle,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),c&&!e&&(0,b.jsx)(o.XCircle,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),(0,b.jsx)("span",{className:`flex-1 ${e?"font-semibold text-green-900":"text-gray-700"}`,children:a.text}),e&&(0,b.jsx)("span",{className:"text-xs font-semibold text-green-700 bg-green-200 px-2 py-1 rounded",children:"Correct"}),c&&(0,b.jsx)("span",{className:"text-xs font-semibold text-gray-700 bg-gray-200 px-2 py-1 rounded",children:"Your answer"})]})},a.id)})}),a.explanation&&(0,b.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg flex gap-3",children:[(0,b.jsx)(p.AlertCircle,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-semibold text-blue-900 mb-1",children:"Explanation"}),(0,b.jsx)("p",{className:"text-blue-800 text-sm",children:a.explanation})]})]})]})]})},a.id)})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[c&&(0,b.jsx)("button",{onClick:c,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors",children:"Retake Quiz"}),d&&(0,b.jsx)("button",{onClick:d,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-colors",children:"Continue Learning"})]})]})}var u=a.i(187145),v=a.i(473515);function w({lesson:a,enrollmentId:d,isCompleted:e=!1,onComplete:f,nextLesson:h,onNextLesson:j}){let[k,l]=(0,c.useState)(0),[o,p]=(0,c.useState)(e),[r,s]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y]=(0,g.useCreateOne)("lessonProgress"),[z]=(0,g.useUpdateOne)("lessonProgress"),{data:A,loading:B}=(0,g.useFindMany)("quiz",{where:{lessonId:a.id,..."QUIZ"===a.type?{}:{id:"never-match"}}}),{data:C,refetch:D}=(0,g.useFindMany)("lessonProgress",{where:{enrollmentId:d||"skip",lessonId:a.id},take:1}),E=C?.[0],F=a=>{l(a),a>=90&&!o&&d&&H()},G=()=>{!o&&d&&H()},H=async()=>{if(d&&!w){x(!0);try{if(await D(),E?.id)await z({where:{id:E.id},data:{completed:!0,completedAt:new Date().toISOString()}});else try{await y({data:{enrollmentId:d,lessonId:a.id,completed:!0,completedAt:new Date().toISOString()}})}catch(a){if(a?.message?.includes("unique constraint")||a?.message?.includes("already exists")){await D();let a=C?.[0];a?.id&&await z({where:{id:a.id},data:{completed:!0,completedAt:new Date().toISOString()}})}else throw a}p(!0),await D(),f?.()}catch(a){console.error("Failed to mark lesson complete:",a)}finally{x(!1)}}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:["VIDEO"===a.type&&(0,b.jsx)(u.PlayCircle,{className:"w-5 h-5 text-blue-600"}),"TEXT"===a.type&&(0,b.jsx)(v.FileText,{className:"w-5 h-5 text-green-600"}),"QUIZ"===a.type&&(0,b.jsx)(v.FileText,{className:"w-5 h-5 text-purple-600"}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:a.title})]}),a.description&&(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.duration&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Clock,{className:"w-4 h-4"}),(0,b.jsxs)("span",{children:[a.duration," minutes"]})]}),o&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-green-600",children:[(0,b.jsx)(n.CheckCircle,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"font-medium",children:"Completed"})]})]})]})})}),(()=>{switch(a.type){case"VIDEO":return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(i,{src:a.content||"",onProgress:F,onComplete:G}),(0,b.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Video Progress"}),(0,b.jsxs)("span",{className:"text-sm font-bold text-blue-600",children:[Math.round(k),"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${k}%`}})})]})]});case"TEXT":return(0,b.jsxs)("div",{className:"bg-white rounded-lg p-8 shadow-sm",children:[(0,b.jsx)("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:a.content||""}}),!o&&d&&(0,b.jsx)("button",{onClick:H,disabled:w,className:"mt-8 w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white py-3 px-6 rounded-lg font-medium transition-colors",children:w?"Marking Complete...":"Mark as Complete"})]});case"QUIZ":let c=A?.[0];if(!c)return(0,b.jsxs)("div",{className:"bg-white rounded-lg p-8 shadow-sm text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(v.FileText,{className:"w-8 h-8 text-purple-600"})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Quiz Available"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"This lesson does not have a quiz yet"})]});if(r)return(0,b.jsx)(t,{attemptId:r,onRetake:()=>s(null),onContinue:j});if(!d)return(0,b.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:(0,b.jsx)("p",{className:"text-yellow-800",children:"You must be enrolled to take this quiz"})});return(0,b.jsx)(q,{quizId:c.id,enrollmentId:d,onComplete:a=>{s(a),H(),f?.()}});case"ASSIGNMENT":return(0,b.jsxs)("div",{className:"bg-white rounded-lg p-8 shadow-sm text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(v.FileText,{className:"w-8 h-8 text-orange-600"})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Assignment Coming Soon"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Assignment submission will be available in the next update"})]});default:return null}})(),o&&h&&j&&(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-100",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:"Ready for the next lesson?"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:h.title})]}),(0,b.jsxs)("button",{onClick:j,className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-lg font-medium transition-colors flex items-center gap-2",children:["Next Lesson",(0,b.jsx)(u.PlayCircle,{className:"w-4 h-4"})]})]})})]})}var x=a.i(300827),y=a.i(516482),z=a.i(733554),A=a.i(439889),B=a.i(975780),C=a.i(202979),D=a.i(976762),E=a.i(335558),F=a.i(422171);function G(){let a=(0,e.useParams)(),g=(0,e.useSearchParams)(),h=a?.slug,i=g?.get("lesson"),{data:j,loading:k}=(0,d.useQuery)(f.GET_COURSE_BY_SLUG,{variables:{slug:h},skip:!h}),{data:l,loading:m,refetch:o}=(0,d.useQuery)(f.GET_ENROLLMENT,{variables:{courseId:j?.courseBySlug?.id||""},skip:!j?.courseBySlug?.id}),p=j?.courseBySlug,q=l?.enrollment,r=p?.modules?.flatMap(a=>a.lessons.map(b=>({...b,moduleName:a.title,moduleOrder:a.order}))).sort((a,b)=>a.moduleOrder!==b.moduleOrder?a.moduleOrder-b.moduleOrder:a.order-b.order)||[],[s,t]=(0,c.useState)(()=>i?r.findIndex(a=>a.id===i):0),G=r[s],H=r[s+1],I=a=>q?.lessonProgress?.some(b=>b.lessonId===a&&b.completed);return k||m?(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(B.Card,{className:"w-full max-w-md",children:(0,b.jsxs)(B.CardContent,{className:"pt-6 text-center",children:[(0,b.jsx)(z.Loader2,{className:"w-12 h-12 animate-spin text-primary mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Đang tải khóa học..."})]})})}):p&&q?(0,b.jsx)("div",{className:"min-h-screen bg-background",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,b.jsx)("aside",{className:"w-full lg:w-96 bg-card border-b lg:border-r lg:border-b-0 lg:h-screen lg:sticky lg:top-0",children:(0,b.jsxs)(E.ScrollArea,{className:"h-[400px] lg:h-screen",children:[(0,b.jsxs)("div",{className:"p-4 md:p-6 border-b",children:[(0,b.jsx)(C.Button,{variant:"ghost",size:"sm",asChild:!0,className:"mb-3 -ml-2",children:(0,b.jsxs)(A.default,{href:`/lms/courses/${h}`,children:[(0,b.jsx)(y.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Quay lại"]})}),(0,b.jsx)("h2",{className:"text-lg font-bold mb-4",children:p.title}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Tiến độ của bạn"}),(0,b.jsxs)("span",{className:"text-sm font-bold text-primary",children:[q.progress,"%"]})]}),(0,b.jsx)(D.Progress,{value:q.progress,className:"h-2"})]})]}),(0,b.jsx)("div",{className:"p-4",children:p.modules?.map((a,c)=>(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold mb-3 px-2",children:[c+1,". ",a.title]}),(0,b.jsx)("div",{className:"space-y-1",children:a.lessons.map((a,c)=>{let d=r.findIndex(b=>b.id===a.id),e=I(a.id),f=d===s;return(0,b.jsx)(C.Button,{onClick:()=>{t(d)},variant:f?"default":"ghost",className:(0,F.cn)("w-full justify-start h-auto py-3 px-3",f&&"bg-primary text-primary-foreground"),children:(0,b.jsxs)("div",{className:"flex items-start gap-3 w-full",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:e?(0,b.jsx)(n.CheckCircle,{className:"w-5 h-5 text-green-600"}):"VIDEO"===a.type?(0,b.jsx)(u.PlayCircle,{className:(0,F.cn)("w-5 h-5",f?"text-primary-foreground":"text-muted-foreground")}):(0,b.jsx)(v.FileText,{className:(0,F.cn)("w-5 h-5",f?"text-primary-foreground":"text-muted-foreground")})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0 text-left",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.title}),a.duration&&(0,b.jsxs)("p",{className:(0,F.cn)("text-xs mt-1",f?"text-primary-foreground/70":"text-muted-foreground"),children:[a.duration," phút"]})]}),f&&(0,b.jsx)(x.ChevronRight,{className:"w-5 h-5 flex-shrink-0"})]})},a.id)})})]},a.id))})]})}),(0,b.jsx)("main",{className:"flex-1 p-4 md:p-6 lg:p-8 max-w-5xl mx-auto w-full",children:G?(0,b.jsx)(w,{lesson:G,enrollmentId:q.id,isCompleted:I(G.id),onComplete:()=>o(),nextLesson:H,onNextLesson:()=>{s<r.length-1&&t(s+1)}}):(0,b.jsx)(B.Card,{children:(0,b.jsx)(B.CardContent,{className:"text-center py-16",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Chưa có bài học nào"})})})})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,b.jsx)(B.Card,{className:"w-full max-w-md",children:(0,b.jsxs)(B.CardContent,{className:"pt-6 text-center space-y-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Không tìm thấy khóa học"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Bạn có thể chưa đăng ký khóa học này"}),(0,b.jsx)(C.Button,{asChild:!0,children:(0,b.jsx)(A.default,{href:"/lms/courses",children:"Khám phá khóa học"})})]})})})}a.s(["default",()=>G],134392)}];

//# sourceMappingURL=frontend_src_app_lms_learn_%5Bslug%5D_page_tsx_0c66b364._.js.map