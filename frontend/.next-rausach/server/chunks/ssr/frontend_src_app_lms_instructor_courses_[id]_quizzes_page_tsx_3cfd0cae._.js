module.exports=[814535,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(53627),e=a.i(439889),f=a.i(516482),g=a.i(723593),h=a.i(558767),i=a.i(445192),j=a.i(508335),k=a.i(390874),l=a.i(235746);function m(){let a=(0,d.useParams)(),m=a?.id,[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({title:"",description:"",passingScore:70,timeLimit:30}),[z,A]=(0,c.useState)({type:"MULTIPLE_CHOICE",question:"",points:10,explanation:"",answers:[{text:"",isCorrect:!0,order:0},{text:"",isCorrect:!1,order:1}]}),{data:B,refetch:C}=(0,l.useFindUnique)("course",m,{include:{modules:{include:{lessons:{where:{type:"QUIZ"},include:{quizzes:{include:{questions:{include:{answers:{orderBy:{order:"asc"}}},orderBy:{order:"asc"}}}}},orderBy:{order:"asc"}}},orderBy:{order:"asc"}}}}),[D]=(0,l.useCreateOne)("quiz"),[E]=(0,l.useUpdateOne)("quiz"),[F]=(0,l.useDeleteOne)("quiz"),[G]=(0,l.useCreateOne)("question"),[H]=(0,l.useDeleteOne)("question"),I=(B?.modules||[]).flatMap(a=>(a.lessons||[]).map(b=>({...b,moduleName:a.title}))),J=()=>{y({title:"",description:"",passingScore:70,timeLimit:30}),o(""),u(null)},K=()=>{A({type:"MULTIPLE_CHOICE",question:"",points:10,explanation:"",answers:[{text:"",isCorrect:!0,order:0},{text:"",isCorrect:!1,order:1}]})},L=async a=>{a.preventDefault(),await D({data:{lessonId:n,...x}}),q(!1),J(),C()},M=async a=>{confirm("Bạn có chắc muốn xóa quiz này? Tất cả câu hỏi sẽ bị xóa!")&&(await F({where:{id:a}}),C())},N=async a=>{a.preventDefault(),v&&(await G({data:{quizId:v.id,type:z.type,question:z.question,points:z.points,explanation:z.explanation,order:v.questions?.length||0,answers:{create:z.answers.map((a,b)=>({text:a.text,isCorrect:a.isCorrect,order:b}))}}}),s(!1),K(),C())},O=async a=>{confirm("Bạn có chắc muốn xóa câu hỏi này?")&&(await H({where:{id:a}}),C())},P=(a,b,c)=>{let d=[...z.answers];d[a]={...d[a],[b]:c},"isCorrect"===b&&!0===c&&"MULTIPLE_CHOICE"!==z.type&&d.forEach((b,c)=>{c!==a&&(b.isCorrect=!1)}),A({...z,answers:d})};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b sticky top-0 z-10",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(e.default,{href:"/lms/instructor/dashboard",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,b.jsx)(f.ArrowLeft,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"font-medium",children:"Quay lại Dashboard"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(e.default,{href:`/lms/instructor/courses/${m}/manage`,className:"text-purple-600 hover:text-purple-700 font-medium",children:"Quản lý Module"}),(0,b.jsx)(e.default,{href:`/lms/instructor/courses/${m}/lessons`,className:"text-green-600 hover:text-green-700 font-medium",children:"Quản lý Bài học"})]})]})})}),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Quản Lý Quiz"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Tạo và quản lý câu hỏi cho các bài kiểm tra"})]}),0===I.length?(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[(0,b.jsx)(i.HelpCircle,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Chưa có Lesson loại Quiz"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Bạn cần tạo lesson type QUIZ trước khi thêm câu hỏi"}),(0,b.jsx)(e.default,{href:`/lms/instructor/courses/${m}/lessons`,className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Tạo Lesson Quiz"})]}):(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-1 space-y-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Danh Sách Quiz"}),I.map(a=>(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:a.moduleName}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:a.title}),a.quizzes&&a.quizzes.length>0?a.quizzes.map(a=>(0,b.jsx)("div",{className:"border-t border-gray-200 pt-3 mt-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"font-medium text-gray-900",children:a.title}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[a.questions?.length||0," câu hỏi • Điểm đạt: ",a.passingScore,"%"]})]}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{onClick:()=>{w(a),s(!1)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Xem chi tiết",children:(0,b.jsx)(i.HelpCircle,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>M(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Xóa",children:(0,b.jsx)(h.Trash2,{className:"w-4 h-4"})})]})]})},a.id)):(0,b.jsx)("button",{onClick:()=>{o(a.id),q(!0)},className:"w-full mt-2 p-2 border-2 border-dashed border-gray-300 rounded text-sm text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors",children:"+ Tạo Quiz"})]})]},a.id))]})}),(0,b.jsx)("div",{className:"lg:col-span-2",children:v?(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:v.title}),v.description&&(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:v.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[(0,b.jsxs)("span",{children:["Điểm đạt: ",v.passingScore,"%"]}),v.timeLimit&&(0,b.jsxs)("span",{children:["Thời gian: ",v.timeLimit," phút"]})]})]}),(0,b.jsxs)("button",{onClick:()=>s(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:[(0,b.jsx)(g.Plus,{className:"w-5 h-5"}),"Thêm Câu Hỏi"]})]}),(0,b.jsx)("div",{className:"space-y-4",children:v.questions&&v.questions.length>0?v.questions.map((a,c)=>(0,b.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("span",{className:"text-sm font-semibold text-gray-500",children:["Câu ",c+1]}),(0,b.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded",children:a.type}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:[a.points," điểm"]})]}),(0,b.jsx)("h4",{className:"font-medium text-gray-900",children:a.question})]}),(0,b.jsx)("button",{onClick:()=>O(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",children:(0,b.jsx)(h.Trash2,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"space-y-2 pl-4",children:a.answers?.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.isCorrect?(0,b.jsx)(j.CheckCircle,{className:"w-5 h-5 text-green-600"}):(0,b.jsx)(k.XCircle,{className:"w-5 h-5 text-red-400"}),(0,b.jsx)("span",{className:a.isCorrect?"text-green-900 font-medium":"text-gray-600",children:a.text})]},a.id))}),a.explanation&&(0,b.jsxs)("div",{className:"mt-3 pl-4 text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[(0,b.jsx)("strong",{children:"Giải thích:"})," ",a.explanation]})]},a.id)):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(i.HelpCircle,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Chưa có câu hỏi nào"}),(0,b.jsx)("button",{onClick:()=>s(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Thêm câu hỏi đầu tiên"})]})})]}):(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[(0,b.jsx)(i.HelpCircle,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Chọn Quiz"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Chọn một quiz từ danh sách bên trái để quản lý câu hỏi"})]})})]}),p&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Tạo Quiz Mới"})}),(0,b.jsxs)("form",{onSubmit:L,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiêu đề Quiz *"}),(0,b.jsx)("input",{type:"text",value:x.title,onChange:a=>y({...x,title:a.target.value}),placeholder:"VD: Quiz: Kiểm tra Module 1",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),(0,b.jsx)("textarea",{value:x.description,onChange:a=>y({...x,description:a.target.value}),placeholder:"Mô tả về quiz...",rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Điểm đạt (%)"}),(0,b.jsx)("input",{type:"number",value:x.passingScore,onChange:a=>y({...x,passingScore:parseInt(a.target.value)}),min:"0",max:"100",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Thời gian (phút)"}),(0,b.jsx)("input",{type:"number",value:x.timeLimit,onChange:a=>y({...x,timeLimit:parseInt(a.target.value)}),min:"1",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Tạo Quiz"}),(0,b.jsx)("button",{type:"button",onClick:()=>{q(!1),J()},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hủy"})]})]})]})}),r&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full my-8",children:[(0,b.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Thêm Câu Hỏi Mới"})}),(0,b.jsxs)("form",{onSubmit:N,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại câu hỏi *"}),(0,b.jsxs)("select",{value:z.type,onChange:a=>A({...z,type:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"MULTIPLE_CHOICE",children:"Multiple Choice (Nhiều đáp án)"}),(0,b.jsx)("option",{value:"TRUE_FALSE",children:"True/False"}),(0,b.jsx)("option",{value:"SHORT_ANSWER",children:"Short Answer"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Câu hỏi *"}),(0,b.jsx)("textarea",{value:z.question,onChange:a=>A({...z,question:a.target.value}),placeholder:"VD: React là gì?",required:!0,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Điểm số"}),(0,b.jsx)("input",{type:"number",value:z.points,onChange:a=>A({...z,points:parseInt(a.target.value)}),min:"1",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Đáp án *"}),(0,b.jsx)("div",{className:"space-y-2",children:z.answers.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:a.isCorrect,onChange:a=>P(c,"isCorrect",a.target.checked),className:"w-5 h-5 text-blue-600"}),(0,b.jsx)("input",{type:"text",value:a.text,onChange:a=>P(c,"text",a.target.value),placeholder:`Đ\xe1p \xe1n ${c+1}`,required:!0,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),z.answers.length>2&&(0,b.jsx)("button",{type:"button",onClick:()=>{A({...z,answers:z.answers.filter((a,b)=>b!==c)})},className:"p-2 text-red-600 hover:bg-red-50 rounded",children:(0,b.jsx)(h.Trash2,{className:"w-4 h-4"})})]},c))}),(0,b.jsx)("button",{type:"button",onClick:()=>{A({...z,answers:[...z.answers,{text:"",isCorrect:!1,order:z.answers.length}]})},className:"mt-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Thêm đáp án"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Giải thích (tùy chọn)"}),(0,b.jsx)("textarea",{value:z.explanation,onChange:a=>A({...z,explanation:a.target.value}),placeholder:"Giải thích đáp án đúng...",rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,b.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Thêm Câu Hỏi"}),(0,b.jsx)("button",{type:"button",onClick:()=>{s(!1),K()},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hủy"})]})]})]})})]})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=frontend_src_app_lms_instructor_courses_%5Bid%5D_quizzes_page_tsx_3cfd0cae._.js.map