{"version":3,"sources":["turbopack:///[project]/frontend/src/hooks/usePWA.ts","turbopack:///[project]/frontend/src/components/pwa/PWAInstallPrompt.tsx","turbopack:///[project]/frontend/src/services/offlineDataService.ts","turbopack:///[project]/frontend/src/components/pwa/OfflineStatus.tsx","turbopack:///[project]/frontend/src/components/pwa/PWAProvider.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\n\nexport interface PWAInstallPrompt {\n  prompt: () => Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nexport interface PWACapabilities {\n  isStandalone: boolean;\n  canInstall: boolean;\n  hasNotificationSupport: boolean;\n  hasBackgroundSync: boolean;\n  hasPushSupport: boolean;\n  isOnline: boolean;\n  serviceWorkerReady: boolean;\n}\n\nexport interface PWAHookReturn {\n  capabilities: PWACapabilities;\n  installPrompt: PWAInstallPrompt | null;\n  install: () => Promise<void>;\n  requestNotificationPermission: () => Promise<NotificationPermission>;\n  showNotification: (title: string, options?: NotificationOptions) => Promise<void>;\n  registerBackgroundSync: (tag: string) => Promise<void>;\n  clearCache: () => Promise<void>;\n  updateAvailable: boolean;\n  updateApp: () => Promise<void>;\n}\n\nexport function usePWA(): PWAHookReturn {\n  const [installPrompt, setInstallPrompt] = useState<PWAInstallPrompt | null>(null);\n  const [capabilities, setCapabilities] = useState<PWACapabilities>({\n    isStandalone: false,\n    canInstall: false,\n    hasNotificationSupport: false,\n    hasBackgroundSync: false,\n    hasPushSupport: false,\n    isOnline: typeof window !== 'undefined' ? navigator.onLine : true,\n    serviceWorkerReady: false,\n  });\n  const [updateAvailable, setUpdateAvailable] = useState(false);\n  const [serviceWorkerRegistration, setServiceWorkerRegistration] = useState<ServiceWorkerRegistration | null>(null);\n\n  // Initialize PWA capabilities\n  useEffect(() => {\n    // Only run on client side\n    if (typeof window === 'undefined') return;\n    \n    const updateCapabilities = () => {\n      setCapabilities(prev => ({\n        ...prev,\n        isStandalone: window.matchMedia('(display-mode: standalone)').matches || \n                      (window.navigator as any).standalone === true,\n        canInstall: installPrompt !== null,\n        hasNotificationSupport: 'Notification' in window,\n        hasBackgroundSync: 'serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype,\n        hasPushSupport: 'serviceWorker' in navigator && 'PushManager' in window,\n        isOnline: navigator.onLine,\n      }));\n    };\n\n    updateCapabilities();\n\n    // Listen for online/offline changes\n    const handleOnline = () => setCapabilities(prev => ({ ...prev, isOnline: true }));\n    const handleOffline = () => setCapabilities(prev => ({ ...prev, isOnline: false }));\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, [installPrompt]);\n\n  // Register service worker\n  useEffect(() => {\n    // Only run on client side\n    if (typeof window === 'undefined' || !('serviceWorker' in navigator)) return;\n    \n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker\n        .register('/sw.js', { scope: '/' })\n        .then((registration) => {\n          // console.log('Service Worker registered successfully:', registration);\n          setServiceWorkerRegistration(registration);\n          setCapabilities(prev => ({ ...prev, serviceWorkerReady: true }));\n\n          // Check for updates\n          registration.addEventListener('updatefound', () => {\n            const newWorker = registration.installing;\n            if (newWorker) {\n              newWorker.addEventListener('statechange', () => {\n                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                  setUpdateAvailable(true);\n                }\n              });\n            }\n          });\n\n          // Listen for messages from service worker\n          navigator.serviceWorker.addEventListener('message', (event) => {\n            if (event.data.type === 'SYNC_SUCCESS') {\n              // Handle successful background sync\n              console.log('Background sync completed:', event.data.action);\n            }\n          });\n        })\n        .catch((error) => {\n          console.error('Service Worker registration failed:', error);\n        });\n    }\n  }, []);\n\n  // Listen for install prompt\n  useEffect(() => {\n    // Only run on client side\n    if (typeof window === 'undefined') return;\n    \n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      setInstallPrompt(e as any);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    };\n  }, []);\n\n  // Install PWA\n  const install = useCallback(async () => {\n    if (!installPrompt) {\n      throw new Error('Install prompt not available');\n    }\n\n    try {\n      await installPrompt.prompt();\n      const choice = await installPrompt.userChoice;\n      \n      if (choice.outcome === 'accepted') {\n        console.log('PWA installation accepted');\n        setInstallPrompt(null);\n      } else {\n        console.log('PWA installation dismissed');\n      }\n    } catch (error) {\n      console.error('PWA installation failed:', error);\n      throw error;\n    }\n  }, [installPrompt]);\n\n  // Request notification permission\n  const requestNotificationPermission = useCallback(async (): Promise<NotificationPermission> => {\n    if (typeof window === 'undefined' || !('Notification' in window)) {\n      throw new Error('Notifications not supported');\n    }\n\n    if (Notification.permission === 'granted') {\n      return 'granted';\n    }\n\n    const permission = await Notification.requestPermission();\n    return permission;\n  }, []);\n\n  // Show notification\n  const showNotification = useCallback(async (title: string, options?: NotificationOptions) => {\n    const permission = await requestNotificationPermission();\n    \n    if (permission !== 'granted') {\n      throw new Error('Notification permission denied');\n    }\n\n    if (serviceWorkerRegistration) {\n      // Use service worker for better reliability\n      await serviceWorkerRegistration.showNotification(title, {\n        icon: '/icons/icon-192x192.png',\n        badge: '/icons/badge-72x72.png',\n        ...options,\n      });\n    } else {\n      // Fallback to regular notification\n      new Notification(title, {\n        icon: '/icons/icon-192x192.png',\n        ...options,\n      });\n    }\n  }, [serviceWorkerRegistration]);\n\n  // Register background sync\n  const registerBackgroundSync = useCallback(async (tag: string) => {\n    if (!serviceWorkerRegistration || !capabilities.hasBackgroundSync) {\n      throw new Error('Background sync not supported');\n    }\n\n    try {\n      // Type assertion for background sync API\n      const registration = serviceWorkerRegistration as any;\n      await registration.sync.register(tag);\n      console.log('Background sync registered:', tag);\n    } catch (error) {\n      console.error('Background sync registration failed:', error);\n      throw error;\n    }\n  }, [serviceWorkerRegistration, capabilities.hasBackgroundSync]);\n\n  // Clear all caches\n  const clearCache = useCallback(async () => {\n    if (typeof window === 'undefined') return;\n    \n    if ('caches' in window) {\n      const cacheNames = await caches.keys();\n      await Promise.all(cacheNames.map(name => caches.delete(name)));\n      console.log('All caches cleared');\n    }\n\n    // Also send message to service worker\n    if (serviceWorkerRegistration?.active) {\n      serviceWorkerRegistration.active.postMessage({ type: 'CLEAR_CACHE' });\n    }\n  }, [serviceWorkerRegistration]);\n\n  // Update app\n  const updateApp = useCallback(async () => {\n    if (typeof window === 'undefined' || !serviceWorkerRegistration) {\n      throw new Error('Service worker not registered or not in browser environment');\n    }\n\n    const newWorker = serviceWorkerRegistration.waiting || serviceWorkerRegistration.installing;\n    \n    if (newWorker) {\n      newWorker.postMessage({ type: 'SKIP_WAITING' });\n      \n      // Wait for the new service worker to take control\n      await new Promise<void>((resolve) => {\n        navigator.serviceWorker.addEventListener('controllerchange', () => {\n          resolve();\n        });\n      });\n\n      // Reload the page\n      window.location.reload();\n    }\n  }, [serviceWorkerRegistration]);\n\n  return {\n    capabilities,\n    installPrompt,\n    install,\n    requestNotificationPermission,\n    showNotification,\n    registerBackgroundSync,\n    clearCache,\n    updateAvailable,\n    updateApp,\n  };\n}\n\n// Utility functions for PWA features\n\nexport const checkPWASupport = (): boolean => {\n  if (typeof window === 'undefined') return false;\n  \n  return (\n    'serviceWorker' in navigator &&\n    'caches' in window &&\n    'indexedDB' in window\n  );\n};\n\nexport const isRunningStandalone = (): boolean => {\n  if (typeof window === 'undefined') return false;\n  \n  return (\n    window.matchMedia('(display-mode: standalone)').matches ||\n    (window.navigator as any).standalone === true\n  );\n};\n\nexport const getInstallPromptDelay = (): number => {\n  if (typeof window === 'undefined') return 0;\n  \n  // Show install prompt after user has been active for some time\n  const lastPromptTime = localStorage.getItem('pwa-last-prompt');\n  const minDelay = 7 * 24 * 60 * 60 * 1000; // 7 days\n  \n  if (lastPromptTime) {\n    const timeSinceLastPrompt = Date.now() - parseInt(lastPromptTime);\n    return Math.max(0, minDelay - timeSinceLastPrompt);\n  }\n  \n  return 0;\n};\n\nexport const shouldShowInstallPrompt = (): boolean => {\n  return (\n    !isRunningStandalone() &&\n    getInstallPromptDelay() === 0 &&\n    checkPWASupport()\n  );\n};","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { usePWA } from '../../hooks/usePWA';\nimport { useSiteName } from '@/hooks/useSiteName';\n\ninterface PWAInstallPromptProps {\n  className?: string;\n  showDelay?: number; // Delay in milliseconds before showing prompt\n  position?: 'top' | 'bottom' | 'center';\n}\n\nexport function PWAInstallPrompt({ \n  className = '', \n  showDelay = 5000,\n  position = 'bottom' \n}: PWAInstallPromptProps) {\n  const [showPrompt, setShowPrompt] = useState(false);\n  const [dismissed, setDismissed] = useState(false);\n  const [installing, setInstalling] = useState(false);\n  const { siteName } = useSiteName();\n  \n  const { \n    capabilities, \n    installPrompt, \n    install,\n    showNotification\n  } = usePWA();\n\n  // Check if we should show the install prompt\n  useEffect(() => {\n    if (!capabilities.canInstall || capabilities.isStandalone || dismissed) {\n      return;\n    }\n\n    // Check if user has dismissed recently\n    const lastDismissed = localStorage.getItem('pwa-install-dismissed');\n    if (lastDismissed) {\n      const dismissedTime = parseInt(lastDismissed);\n      const minDelay = 7 * 24 * 60 * 60 * 1000; // 7 days\n      \n      if (Date.now() - dismissedTime < minDelay) {\n        return;\n      }\n    }\n\n    // Show prompt after delay\n    const timer = setTimeout(() => {\n      setShowPrompt(true);\n    }, showDelay);\n\n    return () => clearTimeout(timer);\n  }, [capabilities.canInstall, capabilities.isStandalone, dismissed, showDelay]);\n\n  // Handle install\n  const handleInstall = async () => {\n    if (!installPrompt) return;\n\n    setInstalling(true);\n    try {\n      await install();\n      setShowPrompt(false);\n      \n      // Show success notification\n      if (capabilities.hasNotificationSupport) {\n        await showNotification('App Installed Successfully!', {\n          body: `${siteName} has been installed to your device. You can now access it from your home screen.`,\n          tag: 'pwa-install-success'\n        });\n      }\n    } catch (error) {\n      console.error('Install failed:', error);\n    } finally {\n      setInstalling(false);\n    }\n  };\n\n  // Handle dismiss\n  const handleDismiss = () => {\n    setDismissed(true);\n    setShowPrompt(false);\n    localStorage.setItem('pwa-install-dismissed', Date.now().toString());\n  };\n\n  // Handle \"Maybe Later\"\n  const handleMaybeLater = () => {\n    setShowPrompt(false);\n    localStorage.setItem('pwa-install-dismissed', Date.now().toString());\n    \n    // Show again after 3 days\n    setTimeout(() => {\n      setDismissed(false);\n    }, 3 * 24 * 60 * 60 * 1000);\n  };\n\n  if (!showPrompt || !capabilities.canInstall || capabilities.isStandalone) {\n    return null;\n  }\n\n  const positionClasses = {\n    top: 'top-4 left-1/2 transform -translate-x-1/2',\n    bottom: 'bottom-4 left-1/2 transform -translate-x-1/2',\n    center: 'top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2'\n  };\n\n  return (\n    <div className={`\n      fixed ${positionClasses[position]} z-50 max-w-sm mx-4\n      bg-white rounded-lg shadow-2xl border border-gray-200\n      animate-in slide-in-from-bottom-4 duration-300\n      ${className}\n    `}>\n      {/* Header */}\n      <div className=\"p-4 pb-2\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center\">\n                <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n                </svg>\n              </div>\n            </div>\n            \n            <div className=\"flex-1\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">\n                Install {siteName}\n              </h3>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                Add to your home screen for quick access\n              </p>\n            </div>\n          </div>\n          \n          <button\n            onClick={handleDismiss}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            aria-label=\"Dismiss install prompt\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n      </div>\n\n      {/* Features */}\n      <div className=\"px-4 pb-2\">\n        <ul className=\"space-y-1 text-sm text-gray-600\">\n          <li className=\"flex items-center space-x-2\">\n            <svg className=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n            </svg>\n            <span>Work offline</span>\n          </li>\n          <li className=\"flex items-center space-x-2\">\n            <svg className=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n            </svg>\n            <span>Faster loading</span>\n          </li>\n          <li className=\"flex items-center space-x-2\">\n            <svg className=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n            </svg>\n            <span>Push notifications</span>\n          </li>\n        </ul>\n      </div>\n\n      {/* Actions */}\n      <div className=\"p-4 pt-2 space-y-2\">\n        <button\n          onClick={handleInstall}\n          disabled={installing}\n          className=\"\n            w-full bg-blue-600 text-white py-2.5 px-4 rounded-lg font-medium\n            hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n            disabled:opacity-50 disabled:cursor-not-allowed\n            transition-colors duration-200\n          \"\n        >\n          {installing ? (\n            <div className=\"flex items-center justify-center space-x-2\">\n              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              <span>Installing...</span>\n            </div>\n          ) : (\n            'Add to Home Screen'\n          )}\n        </button>\n        \n        <button\n          onClick={handleMaybeLater}\n          className=\"\n            w-full text-gray-600 py-2 px-4 rounded-lg font-medium\n            hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-2\n            transition-colors duration-200\n          \"\n        >\n          Maybe Later\n        </button>\n      </div>\n    </div>\n  );\n}\n\n// Mini install button for header/toolbar\nexport function PWAInstallButton({ \n  variant = 'default',\n  size = 'medium',\n  className = '' \n}: {\n  variant?: 'default' | 'minimal' | 'icon';\n  size?: 'small' | 'medium' | 'large';\n  className?: string;\n}) {\n  const [installing, setInstalling] = useState(false);\n  const { capabilities, install } = usePWA();\n\n  const handleInstall = async () => {\n    setInstalling(true);\n    try {\n      await install();\n    } catch (error) {\n      console.error('Install failed:', error);\n    } finally {\n      setInstalling(false);\n    }\n  };\n\n  if (!capabilities.canInstall || capabilities.isStandalone) {\n    return null;\n  }\n\n  const sizeClasses = {\n    small: 'px-2 py-1 text-sm',\n    medium: 'px-3 py-2 text-sm',\n    large: 'px-4 py-2 text-base'\n  };\n\n  const variantClasses = {\n    default: 'bg-blue-600 text-white hover:bg-blue-700',\n    minimal: 'bg-gray-100 text-gray-700 hover:bg-gray-200',\n    icon: 'p-2 bg-gray-100 text-gray-700 hover:bg-gray-200 rounded-full'\n  };\n\n  if (variant === 'icon') {\n    return (\n      <button\n        onClick={handleInstall}\n        disabled={installing}\n        className={`\n          ${variantClasses[variant]} ${className}\n          focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n          disabled:opacity-50 disabled:cursor-not-allowed\n          transition-colors duration-200\n        `}\n        title=\"Install App\"\n        aria-label=\"Install App\"\n      >\n        {installing ? (\n          <div className=\"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin\" />\n        ) : (\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n          </svg>\n        )}\n      </button>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleInstall}\n      disabled={installing}\n      className={`\n        ${variantClasses[variant]} ${sizeClasses[size]} ${className}\n        font-medium rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n        disabled:opacity-50 disabled:cursor-not-allowed\n        transition-colors duration-200\n      `}\n    >\n      {installing ? (\n        <div className=\"flex items-center justify-center space-x-2\">\n          <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin\" />\n          <span>Installing...</span>\n        </div>\n      ) : (\n        <>\n          <svg className=\"w-4 h-4 inline mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n          </svg>\n          Install App\n        </>\n      )}\n    </button>\n  );\n}","'use client';\n\nimport { Task, TaskPriority, TaskStatus } from '../types/task';\n\nexport interface OfflineAction {\n  id?: string;\n  type: 'CREATE' | 'UPDATE' | 'DELETE';\n  entity: 'TASK' | 'USER' | 'PROJECT';\n  entityId: string;\n  data?: any;\n  timestamp: number;\n  retryCount: number;\n  maxRetries: number;\n}\n\nexport interface SyncResult {\n  success: boolean;\n  error?: string;\n  conflicts?: ConflictResolution[];\n}\n\nexport interface ConflictResolution {\n  entityId: string;\n  serverVersion: any;\n  localVersion: any;\n  resolution: 'server' | 'local' | 'merge';\n  mergedData?: any;\n}\n\nexport interface OfflineStorage {\n  tasks: Map<string, Task>;\n  actions: Map<string, OfflineAction>;\n  lastSync: number;\n}\n\nclass OfflineDataService {\n  private db: IDBDatabase | null = null;\n  private dbName = 'rausachcoreOfflineDB';\n  private dbVersion = 1;\n  private syncInProgress = false;\n\n  constructor() {\n    // Only initialize on client side\n    if (typeof window !== 'undefined' && 'indexedDB' in window) {\n      this.initDB();\n    }\n  }\n\n  // Initialize IndexedDB\n  private async initDB(): Promise<void> {\n    // Skip on server side\n    if (typeof window === 'undefined' || !('indexedDB' in window)) {\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, this.dbVersion);\n\n      request.onerror = () => reject(request.error);\n      request.onsuccess = () => {\n        this.db = request.result;\n        resolve();\n      };\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result;\n\n        // Tasks store\n        if (!db.objectStoreNames.contains('tasks')) {\n          const taskStore = db.createObjectStore('tasks', { keyPath: 'id' });\n          taskStore.createIndex('status', 'status', { unique: false });\n          taskStore.createIndex('priority', 'priority', { unique: false });\n          taskStore.createIndex('createdAt', 'createdAt', { unique: false });\n          taskStore.createIndex('updatedAt', 'updatedAt', { unique: false });\n        }\n\n        // Offline actions store\n        if (!db.objectStoreNames.contains('offlineActions')) {\n          const actionStore = db.createObjectStore('offlineActions', { keyPath: 'id', autoIncrement: true });\n          actionStore.createIndex('timestamp', 'timestamp', { unique: false });\n          actionStore.createIndex('type', 'type', { unique: false });\n        }\n\n        // Sync metadata store\n        if (!db.objectStoreNames.contains('syncMeta')) {\n          db.createObjectStore('syncMeta', { keyPath: 'key' });\n        }\n\n        // Cache store\n        if (!db.objectStoreNames.contains('cache')) {\n          db.createObjectStore('cache', { keyPath: 'key' });\n        }\n      };\n    });\n  }\n\n  // Get all tasks from offline storage\n  async getTasks(): Promise<Task[]> {\n    if (!this.db) {\n      if (typeof window === 'undefined' || !('indexedDB' in window)) {\n        return [];\n      }\n      await this.initDB();\n    }\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['tasks'], 'readonly');\n      const store = transaction.objectStore('tasks');\n      const request = store.getAll();\n\n      request.onsuccess = () => resolve(request.result || []);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Get single task from offline storage\n  async getTask(id: string): Promise<Task | null> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['tasks'], 'readonly');\n      const store = transaction.objectStore('tasks');\n      const request = store.get(id);\n\n      request.onsuccess = () => resolve(request.result || null);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Store task offline\n  async storeTask(task: Task): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['tasks'], 'readwrite');\n      const store = transaction.objectStore('tasks');\n      const request = store.put({\n        ...task,\n        lastModified: Date.now(),\n        offline: true\n      });\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Create task offline\n  async createTaskOffline(task: Omit<Task, 'id'>): Promise<Task> {\n    const newTask: Task = {\n      ...task,\n      id: `offline_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n    };\n\n    await this.storeTask(newTask);\n    await this.queueAction({\n      type: 'CREATE',\n      entity: 'TASK',\n      entityId: newTask.id,\n      data: newTask,\n      timestamp: Date.now(),\n      retryCount: 0,\n      maxRetries: 3\n    });\n\n    return newTask;\n  }\n\n  // Update task offline\n  async updateTaskOffline(id: string, updates: Partial<Task>): Promise<Task> {\n    const existingTask = await this.getTask(id);\n    \n    if (!existingTask) {\n      throw new Error('Task not found');\n    }\n\n    const updatedTask: Task = {\n      ...existingTask,\n      ...updates,\n      updatedAt: new Date().toISOString(),\n    };\n\n    await this.storeTask(updatedTask);\n    await this.queueAction({\n      type: 'UPDATE',\n      entity: 'TASK',\n      entityId: id,\n      data: updates,\n      timestamp: Date.now(),\n      retryCount: 0,\n      maxRetries: 3\n    });\n\n    return updatedTask;\n  }\n\n  // Delete task offline\n  async deleteTaskOffline(id: string): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['tasks'], 'readwrite');\n      const store = transaction.objectStore('tasks');\n      const request = store.delete(id);\n\n      request.onsuccess = () => {\n        this.queueAction({\n          type: 'DELETE',\n          entity: 'TASK',\n          entityId: id,\n          data: null,\n          timestamp: Date.now(),\n          retryCount: 0,\n          maxRetries: 3\n        });\n        resolve();\n      };\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Queue offline action\n  async queueAction(action: Omit<OfflineAction, 'id'>): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['offlineActions'], 'readwrite');\n      const store = transaction.objectStore('offlineActions');\n      const request = store.add(action);\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Get all pending actions\n  async getPendingActions(): Promise<OfflineAction[]> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['offlineActions'], 'readonly');\n      const store = transaction.objectStore('offlineActions');\n      const request = store.getAll();\n\n      request.onsuccess = () => resolve(request.result || []);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Remove completed action\n  async removeAction(actionId: string): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['offlineActions'], 'readwrite');\n      const store = transaction.objectStore('offlineActions');\n      const request = store.delete(actionId);\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Sync with server\n  async syncWithServer(): Promise<SyncResult> {\n    if (this.syncInProgress) {\n      return { success: false, error: 'Sync already in progress' };\n    }\n\n    this.syncInProgress = true;\n\n    try {\n      // Get pending actions\n      const actions = await this.getPendingActions();\n      const conflicts: ConflictResolution[] = [];\n\n      // Process each action\n      for (const action of actions) {\n        try {\n          await this.processAction(action);\n          await this.removeAction(action.id!);\n        } catch (error) {\n          console.error('Failed to sync action:', action, error);\n          \n          // Increment retry count\n          action.retryCount++;\n          \n          if (action.retryCount >= action.maxRetries) {\n            // Max retries reached, remove action\n            await this.removeAction(action.id!);\n          } else {\n            // Update retry count in storage\n            await this.updateAction(action);\n          }\n        }\n      }\n\n      // Update last sync timestamp\n      await this.updateSyncMeta('lastSync', Date.now());\n\n      return {\n        success: true,\n        conflicts: conflicts.length > 0 ? conflicts : undefined\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown sync error'\n      };\n    } finally {\n      this.syncInProgress = false;\n    }\n  }\n\n  // Process individual action\n  private async processAction(action: OfflineAction): Promise<void> {\n    const endpoint = this.getAPIEndpoint(action.entity, action.type, action.entityId);\n    \n    let response: Response;\n    \n    switch (action.type) {\n      case 'CREATE':\n        response = await fetch(endpoint, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(action.data)\n        });\n        break;\n        \n      case 'UPDATE':\n        response = await fetch(endpoint, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(action.data)\n        });\n        break;\n        \n      case 'DELETE':\n        response = await fetch(endpoint, {\n          method: 'DELETE'\n        });\n        break;\n        \n      default:\n        throw new Error(`Unknown action type: ${action.type}`);\n    }\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    // Handle successful response\n    if (action.type === 'CREATE' || action.type === 'UPDATE') {\n      const serverData = await response.json();\n      await this.handleServerResponse(action, serverData);\n    }\n  }\n\n  // Handle server response for conflict resolution\n  private async handleServerResponse(action: OfflineAction, serverData: any): Promise<void> {\n    if (action.entity === 'TASK') {\n      const localTask = await this.getTask(action.entityId);\n      \n      if (localTask && localTask.updatedAt !== serverData.updatedAt) {\n        // Conflict detected - server version is different\n        const resolution = await this.resolveConflict(localTask, serverData);\n        await this.storeTask(resolution);\n      } else {\n        // No conflict, update with server data\n        await this.storeTask(serverData);\n      }\n    }\n  }\n\n  // Conflict resolution strategy\n  private async resolveConflict(localData: any, serverData: any): Promise<any> {\n    // Simple last-write-wins strategy based on timestamp\n    const localTime = new Date(localData.updatedAt).getTime();\n    const serverTime = new Date(serverData.updatedAt).getTime();\n    \n    if (serverTime > localTime) {\n      // Server wins\n      return serverData;\n    } else {\n      // Local wins - need to sync local changes to server\n      return localData;\n    }\n  }\n\n  // Update action retry count\n  private async updateAction(action: OfflineAction): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['offlineActions'], 'readwrite');\n      const store = transaction.objectStore('offlineActions');\n      const request = store.put(action);\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Get API endpoint for entity and action\n  private getAPIEndpoint(entity: string, type: string, entityId?: string): string {\n    const baseUrl = process.env.NEXT_PUBLIC_API_URL || '/api';\n    \n    switch (entity) {\n      case 'TASK':\n        if (type === 'CREATE') return `${baseUrl}/tasks`;\n        return `${baseUrl}/tasks/${entityId}`;\n        \n      default:\n        throw new Error(`Unknown entity: ${entity}`);\n    }\n  }\n\n  // Update sync metadata\n  async updateSyncMeta(key: string, value: any): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['syncMeta'], 'readwrite');\n      const store = transaction.objectStore('syncMeta');\n      const request = store.put({ key, value });\n\n      request.onsuccess = () => resolve();\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Get sync metadata\n  async getSyncMeta(key: string): Promise<any> {\n    if (!this.db) await this.initDB();\n\n    return new Promise((resolve, reject) => {\n      const transaction = this.db!.transaction(['syncMeta'], 'readonly');\n      const store = transaction.objectStore('syncMeta');\n      const request = store.get(key);\n\n      request.onsuccess = () => resolve(request.result?.value);\n      request.onerror = () => reject(request.error);\n    });\n  }\n\n  // Get sync status\n  async getSyncStatus(): Promise<{\n    lastSync: number;\n    pendingActions: number;\n    isOnline: boolean;\n  }> {\n    const lastSync = (await this.getSyncMeta('lastSync')) || 0;\n    const actions = await this.getPendingActions();\n    \n    return {\n      lastSync,\n      pendingActions: actions.length,\n      isOnline: navigator.onLine\n    };\n  }\n\n  // Force full sync\n  async forceSyncAll(): Promise<SyncResult> {\n    try {\n      // First, sync pending actions\n      const result = await this.syncWithServer();\n      \n      // Then, fetch latest data from server\n      await this.fetchLatestData();\n      \n      return result;\n    } catch (error) {\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Full sync failed'\n      };\n    }\n  }\n\n  // Fetch latest data from server\n  private async fetchLatestData(): Promise<void> {\n    try {\n      const response = await fetch('/api/tasks');\n      if (response.ok) {\n        const tasks = await response.json();\n        \n        // Store all tasks\n        for (const task of tasks) {\n          await this.storeTask(task);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to fetch latest data:', error);\n    }\n  }\n\n  // Clear all offline data\n  async clearOfflineData(): Promise<void> {\n    if (!this.db) await this.initDB();\n\n    const stores = ['tasks', 'offlineActions', 'syncMeta', 'cache'];\n    \n    for (const storeName of stores) {\n      await new Promise<void>((resolve, reject) => {\n        const transaction = this.db!.transaction([storeName], 'readwrite');\n        const store = transaction.objectStore(storeName);\n        const request = store.clear();\n\n        request.onsuccess = () => resolve();\n        request.onerror = () => reject(request.error);\n      });\n    }\n  }\n}\n\n// Export singleton instance\n// Create and export service instance with proper SSR handling\nconst createOfflineDataService = () => {\n  if (typeof window === 'undefined') {\n    // Return a mock service for SSR\n    return {\n      getTasks: () => Promise.resolve([]),\n      getTask: () => Promise.resolve(null),\n      storeTask: () => Promise.resolve(),\n      createTaskOffline: () => Promise.resolve({} as Task),\n      updateTaskOffline: () => Promise.resolve({} as Task),\n      deleteTaskOffline: () => Promise.resolve(),\n      queueAction: () => Promise.resolve(),\n      getPendingActions: () => Promise.resolve([]),\n      clearPendingActions: () => Promise.resolve(),\n      processPendingActions: () => Promise.resolve({ success: 0, failed: 0 }),\n      syncWithServer: () => Promise.resolve({ success: true }),\n      resolveConflict: () => Promise.resolve({} as Task),\n      getSyncStatus: () => Promise.resolve({ \n        lastSync: 0, \n        pendingActions: 0, \n        isOnline: false \n      }),\n      cacheApiResponse: () => Promise.resolve(),\n      getCachedResponse: () => Promise.resolve(null),\n      clearExpiredCache: () => Promise.resolve()\n    } as any;\n  }\n  return new OfflineDataService();\n};\n\nexport const offlineDataService = createOfflineDataService();\n\n// Export types and service\nexport default OfflineDataService;","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { usePWA } from '../../hooks/usePWA';\nimport { offlineDataService } from '../../services/offlineDataService';\n\ninterface OfflineStatusProps {\n  className?: string;\n  position?: 'top' | 'bottom';\n  showSyncStatus?: boolean;\n}\n\nexport function OfflineStatus({ \n  className = '', \n  position = 'top',\n  showSyncStatus = true \n}: OfflineStatusProps) {\n  const [isOnline, setIsOnline] = useState(() => \n    typeof window !== 'undefined' ? navigator.onLine : true\n  );\n  const [pendingActions, setPendingActions] = useState(0);\n  const [isSyncing, setIsSyncing] = useState(false);\n  const [lastSyncTime, setLastSyncTime] = useState<Date | null>(null);\n  \n  const { capabilities } = usePWA();\n\n  // Monitor online status\n  useEffect(() => {\n    // Set initial online status on client mount\n    if (typeof window !== 'undefined') {\n      setIsOnline(navigator.onLine);\n    }\n\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Monitor pending actions and sync status\n  useEffect(() => {\n    const updateStatus = async () => {\n      try {\n        const actions = await offlineDataService.getPendingActions();\n        setPendingActions(actions.length);\n        \n        const syncStatus = await offlineDataService.getSyncStatus();\n        setIsSyncing(false); // We'll handle syncing state separately\n        if (syncStatus.lastSync > 0) {\n          setLastSyncTime(new Date(syncStatus.lastSync));\n        }\n      } catch (error) {\n        console.error('Failed to get offline status:', error);\n      }\n    };\n\n    updateStatus();\n\n    // Poll for status updates\n    const interval = setInterval(updateStatus, 2000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Auto-sync when coming back online\n  useEffect(() => {\n    if (isOnline && pendingActions > 0 && !isSyncing) {\n      // Trigger background sync through service worker\n      if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {\n        navigator.serviceWorker.ready.then(registration => {\n          return (registration as any).sync.register('background-sync');\n        }).catch(console.error);\n      }\n    }\n  }, [isOnline, pendingActions, isSyncing]);\n\n  const positionClasses = {\n    top: 'top-4',\n    bottom: 'bottom-4'\n  };\n\n  // Don't show anything if online and no pending actions\n  if (isOnline && pendingActions === 0 && !isSyncing) {\n    return null;\n  }\n\n  return (\n    <div className={`\n      fixed ${positionClasses[position]} right-4 z-40\n      ${className}\n    `}>\n      {/* Offline Indicator */}\n      {!isOnline && (\n        <div className=\"\n          bg-yellow-50 border border-yellow-200 rounded-lg px-4 py-3 mb-2\n          shadow-lg backdrop-blur-sm\n          animate-in slide-in-from-right-4 duration-300\n        \">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-4 h-4 text-yellow-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16c-.77.833.192 2.5 1.732 2.5z\" />\n                </svg>\n              </div>\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-yellow-800\">\n                You're offline\n              </p>\n              <p className=\"text-xs text-yellow-600 mt-1\">\n                Changes will sync when you're back online\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Sync Status */}\n      {showSyncStatus && (isSyncing || pendingActions > 0) && (\n        <div className=\"\n          bg-blue-50 border border-blue-200 rounded-lg px-4 py-3\n          shadow-lg backdrop-blur-sm\n          animate-in slide-in-from-right-4 duration-300\n        \">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex-shrink-0\">\n              {isSyncing ? (\n                <div className=\"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                  <div className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\" />\n                </div>\n              ) : (\n                <div className=\"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center\">\n                  <span className=\"text-xs font-bold text-orange-600\">\n                    {pendingActions}\n                  </span>\n                </div>\n              )}\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              {isSyncing ? (\n                <>\n                  <p className=\"text-sm font-medium text-blue-800\">\n                    Syncing changes...\n                  </p>\n                  <p className=\"text-xs text-blue-600 mt-1\">\n                    {pendingActions} action{pendingActions !== 1 ? 's' : ''} pending\n                  </p>\n                </>\n              ) : (\n                <>\n                  <p className=\"text-sm font-medium text-orange-800\">\n                    {pendingActions} change{pendingActions !== 1 ? 's' : ''} pending\n                  </p>\n                  <p className=\"text-xs text-orange-600 mt-1\">\n                    {isOnline ? 'Will sync automatically' : 'Waiting for connection'}\n                  </p>\n                </>\n              )}\n            </div>\n\n            {/* Manual sync button */}\n            {isOnline && pendingActions > 0 && !isSyncing && (\n              <button\n                onClick={() => {\n                  // Trigger manual sync through service worker\n                  if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {\n                    navigator.serviceWorker.ready.then(registration => {\n                      return (registration as any).sync.register('background-sync');\n                    }).catch(console.error);\n                  }\n                }}\n                className=\"\n                  text-blue-600 hover:text-blue-700 focus:outline-none\n                  transition-colors duration-200\n                \"\n                title=\"Sync now\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                </svg>\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Last sync time */}\n      {showSyncStatus && isOnline && lastSyncTime && pendingActions === 0 && (\n        <div className=\"\n          bg-green-50 border border-green-200 rounded-lg px-4 py-2 mt-2\n          shadow-lg backdrop-blur-sm\n          animate-in slide-in-from-right-4 duration-300\n        \">\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center\">\n                <svg className=\"w-3 h-3 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                </svg>\n              </div>\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-xs text-green-600\">\n                Last sync: {formatSyncTime(lastSyncTime)}\n              </p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Format sync time for display\nfunction formatSyncTime(date: Date): string {\n  const now = new Date();\n  const diff = now.getTime() - date.getTime();\n  \n  if (diff < 60000) { // Less than 1 minute\n    return 'Just now';\n  } else if (diff < 3600000) { // Less than 1 hour\n    const minutes = Math.floor(diff / 60000);\n    return `${minutes}m ago`;\n  } else if (diff < 86400000) { // Less than 1 day\n    const hours = Math.floor(diff / 3600000);\n    return `${hours}h ago`;\n  } else {\n    return date.toLocaleDateString();\n  }\n}\n\n// Compact offline indicator for mobile\nexport function CompactOfflineStatus({ className = '' }: { className?: string }) {\n  const [isOnline, setIsOnline] = useState(typeof window !== 'undefined' ? navigator.onLine : true);\n  const [pendingActions, setPendingActions] = useState(0);\n\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  useEffect(() => {\n    const updatePendingActions = async () => {\n      try {\n        const actions = await offlineDataService.getPendingActions();\n        setPendingActions(actions.length);\n      } catch (error) {\n        console.error('Failed to get pending actions:', error);\n      }\n    };\n\n    updatePendingActions();\n    const interval = setInterval(updatePendingActions, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  if (isOnline && pendingActions === 0) {\n    return null;\n  }\n\n  return (\n    <div className={`flex items-center space-x-2 ${className}`}>\n      {!isOnline && (\n        <div className=\"flex items-center space-x-1\">\n          <div className=\"w-2 h-2 bg-yellow-500 rounded-full animate-pulse\" />\n          <span className=\"text-xs text-yellow-600 font-medium\">Offline</span>\n        </div>\n      )}\n      \n      {pendingActions > 0 && (\n        <div className=\"flex items-center space-x-1\">\n          <div className=\"w-2 h-2 bg-orange-500 rounded-full\" />\n          <span className=\"text-xs text-orange-600 font-medium\">\n            {pendingActions} pending\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}","'use client';\n\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { PWAInstallPrompt } from './PWAInstallPrompt';\nimport { OfflineStatus } from './OfflineStatus';\nimport { usePWA } from '../../hooks/usePWA';\n\ninterface PWAContextType {\n  isOnline: boolean;\n  isInstalled: boolean;\n  canInstall: boolean;\n  pendingActions: number;\n  showInstallPrompt: () => void;\n  hideInstallPrompt: () => void;\n  requestNotificationPermission: () => Promise<NotificationPermission>;\n}\n\nconst PWAContext = createContext<PWAContextType | null>(null);\n\ninterface PWAProviderProps {\n  children: React.ReactNode;\n  enableAutoPrompt?: boolean;\n  enableOfflineStatus?: boolean;\n  installPromptDelay?: number;\n  offlineStatusPosition?: 'top' | 'bottom';\n  className?: string;\n}\n\nexport function PWAProvider({\n  children,\n  enableAutoPrompt = true,\n  enableOfflineStatus = true,\n  installPromptDelay = 10000,\n  offlineStatusPosition = 'top',\n  className = ''\n}: PWAProviderProps) {\n  // Fix SSR issue by checking if window is available\n  const [isOnline, setIsOnline] = useState(typeof window !== 'undefined' ? navigator.onLine : true);\n  const [pendingActions, setPendingActions] = useState(0);\n  const [showPrompt, setShowPrompt] = useState(false);\n\n  const { capabilities, install, showNotification } = usePWA();\n\n  // Monitor online status\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Monitor pending actions (simplified for context)\n  useEffect(() => {\n    // This would typically integrate with your offline service\n    // For now, we'll just simulate it\n    const updatePendingActions = () => {\n      // In a real implementation, this would check IndexedDB\n      setPendingActions(0);\n    };\n\n    updatePendingActions();\n    const interval = setInterval(updatePendingActions, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // PWA Installation prompt management\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    if (!capabilities.canInstall || capabilities.isStandalone) {\n      return;\n    }\n\n    // Check if user has dismissed the prompt recently\n    const lastDismissed = localStorage.getItem('pwa-install-dismissed');\n    if (lastDismissed) {\n      const dismissedTime = parseInt(lastDismissed);\n      const cooldownPeriod = 7 * 24 * 60 * 60 * 1000; // 7 days\n      \n      if (Date.now() - dismissedTime < cooldownPeriod) {\n        return;\n      }\n    }\n\n    if (enableAutoPrompt) {\n      const timer = setTimeout(() => {\n        setShowPrompt(true);\n      }, installPromptDelay);\n\n      return () => clearTimeout(timer);\n    }\n  }, [capabilities.canInstall, capabilities.isStandalone, enableAutoPrompt, installPromptDelay]);\n\n  // Register service worker and handle updates\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register('/sw.js')\n        .then(registration => {\n          // console.log('Service Worker registered successfully:', registration);\n          \n          // Listen for updates\n          registration.addEventListener('updatefound', () => {\n            const newWorker = registration.installing;\n            if (newWorker) {\n              newWorker.addEventListener('statechange', () => {\n                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                  // New version available\n                  showUpdateNotification();\n                }\n              });\n            }\n          });\n        })\n        .catch(error => {\n          console.error('Service Worker registration failed:', error);\n        });\n\n      // Listen for messages from service worker\n      navigator.serviceWorker.addEventListener('message', event => {\n        const { type, data } = event.data;\n        \n        switch (type) {\n          case 'SYNC_COMPLETE':\n            setPendingActions(data.remainingActions);\n            if (data.successCount > 0) {\n              showNotification('Sync Complete', {\n                body: `${data.successCount} item${data.successCount !== 1 ? 's' : ''} synced successfully`,\n                tag: 'sync-complete'\n              });\n            }\n            break;\n            \n          case 'SYNC_ERROR':\n            console.error('Sync error:', data.error);\n            break;\n            \n          case 'CACHE_UPDATED':\n            // Cache has been updated, potentially show refresh prompt\n            break;\n        }\n      });\n    }\n  }, [showNotification]);\n\n  const showUpdateNotification = async () => {\n    if (capabilities.hasNotificationSupport) {\n      await showNotification('Update Available', {\n        body: 'A new version of the app is available. Refresh to update.',\n        tag: 'app-update'\n      });\n    }\n  };\n\n  const contextValue: PWAContextType = {\n    isOnline,\n    isInstalled: capabilities.isStandalone,\n    canInstall: capabilities.canInstall,\n    pendingActions,\n    showInstallPrompt: () => setShowPrompt(true),\n    hideInstallPrompt: () => setShowPrompt(false),\n    requestNotificationPermission: async () => {\n      if (typeof window !== 'undefined' && 'Notification' in window) {\n        return await Notification.requestPermission();\n      }\n      return 'denied';\n    }\n  };\n\n  return (\n    <PWAContext.Provider value={contextValue}>\n      <div className={className}>\n        {children}\n        \n        {/* PWA Install Prompt */}\n        {enableAutoPrompt && showPrompt && (\n          <PWAInstallPrompt \n            showDelay={0} // Already handled by provider\n          />\n        )}\n        \n        {/* Offline Status Indicator */}\n        {enableOfflineStatus && (\n          <OfflineStatus \n            position={offlineStatusPosition}\n            showSyncStatus={true}\n          />\n        )}\n      </div>\n    </PWAContext.Provider>\n  );\n}\n\nexport function usePWAContext() {\n  const context = useContext(PWAContext);\n  if (!context) {\n    throw new Error('usePWAContext must be used within a PWAProvider');\n  }\n  return context;\n}\n\n// Higher-order component for PWA-aware components\nexport function withPWA<T extends object>(Component: React.ComponentType<T>) {\n  return function PWAWrappedComponent(props: T) {\n    const pwaContext = usePWAContext();\n    \n    return (\n      <Component \n        {...props} \n        pwa={pwaContext}\n      />\n    );\n  };\n}\n\n// PWA-aware hooks\nexport function usePWANetworkStatus() {\n  const { isOnline } = usePWAContext();\n  return { isOnline, isOffline: !isOnline };\n}\n\nexport function usePWAInstallation() {\n  const { \n    isInstalled, \n    canInstall, \n    showInstallPrompt \n  } = usePWAContext();\n  \n  return {\n    isInstalled,\n    canInstall,\n    showInstallPrompt,\n    installationStatus: isInstalled ? 'installed' : canInstall ? 'available' : 'unavailable'\n  };\n}\n\nexport function usePWASync() {\n  const { pendingActions, isOnline } = usePWAContext();\n  \n  const triggerSync = () => {\n    if (typeof window !== 'undefined' && 'serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {\n      navigator.serviceWorker.ready.then(registration => {\n        return (registration as any).sync.register('background-sync');\n      }).catch(console.error);\n    }\n  };\n\n  return {\n    pendingActions,\n    hasPendingActions: pendingActions > 0,\n    canSync: isOnline,\n    triggerSync\n  };\n}"],"names":[],"mappings":"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"}