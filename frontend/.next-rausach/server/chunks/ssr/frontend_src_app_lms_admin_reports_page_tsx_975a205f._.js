module.exports=[908506,a=>{"use strict";var b=a.i(321248),c=a.i(651332),d=a.i(235746),e=a.i(975780),f=a.i(202979),g=a.i(951369),h=a.i(57597),i=a.i(358054),j=a.i(26720),k=a.i(147678),l=a.i(653107),m=a.i(515678),n=a.i(891026),o=a.i(863039),o=o,p=a.i(623409),q=a.i(508335),r=a.i(411185),s=a.i(395992),t=a.i(327987),u=a.i(144932);function v(){let[a,v]=(0,c.useState)("30days"),{data:w,loading:x}=(0,d.useFindMany)("Enrollment",{select:{id:!0,status:!0,progress:!0,paymentAmount:!0,enrolledAt:!0,completedAt:!0},include:{course:{select:{id:!0,title:!0,price:!0}}}}),{data:y}=(0,d.useFindMany)("Course",{select:{id:!0,title:!0,status:!0,price:!0},include:{_count:{select:{enrollments:!0}}}}),{data:z}=(0,d.useFindMany)("Certificate",{select:{id:!0,issueDate:!0,grade:!0},include:{course:{select:{title:!0}}}}),{data:A}=(0,d.useFindMany)("QuizAttempt",{select:{id:!0,score:!0,passed:!0,completedAt:!0}}),B={totalEnrollments:w?.length||0,activeEnrollments:w?.filter(a=>"ACTIVE"===a.status).length||0,completedEnrollments:w?.filter(a=>"COMPLETED"===a.status).length||0,totalRevenue:w?.reduce((a,b)=>a+(b.paymentAmount||0),0)||0,totalCourses:y?.length||0,publishedCourses:y?.filter(a=>"PUBLISHED"===a.status).length||0,certificatesIssued:z?.length||0,avgQuizScore:A?.length?(A.reduce((a,b)=>a+(b.score||0),0)/A.length).toFixed(1):0,quizPassRate:A?.length?(A.filter(a=>a.passed).length/A.length*100).toFixed(1):0},C=y?[...y].sort((a,b)=>b._count.enrollments-a._count.enrollments).slice(0,5):[],D=w?[...w].sort((a,b)=>new Date(b.enrolledAt).getTime()-new Date(a.enrolledAt).getTime()).slice(0,10):[],E=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a);return(0,b.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Báo cáo & Thống kê"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Tổng quan hoạt động hệ thống LMS"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(u.Select,{value:a,onValueChange:a=>v(a),children:[(0,b.jsx)(u.SelectTrigger,{className:"w-[150px]",children:(0,b.jsx)(u.SelectValue,{})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"7days",children:"7 ngày qua"}),(0,b.jsx)(u.SelectItem,{value:"30days",children:"30 ngày qua"}),(0,b.jsx)(u.SelectItem,{value:"90days",children:"90 ngày qua"}),(0,b.jsx)(u.SelectItem,{value:"all",children:"Tất cả"})]})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(m.Download,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Xuất báo cáo"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(e.CardDescription,{className:"flex items-center gap-1",children:[(0,b.jsx)(i.Users,{className:"w-4 h-4"}),"Tổng ghi danh"]}),(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:B.totalEnrollments}),(0,b.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,b.jsx)(h.TrendingUp,{className:"w-3 h-3"}),B.activeEnrollments," đang học"]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(e.CardDescription,{className:"flex items-center gap-1",children:[(0,b.jsx)(l.DollarSign,{className:"w-4 h-4"}),"Doanh thu"]}),(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:E(B.totalRevenue)}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:["Từ ",B.totalEnrollments," ghi danh"]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(e.CardDescription,{className:"flex items-center gap-1",children:[(0,b.jsx)(k.Award,{className:"w-4 h-4"}),"Chứng chỉ"]}),(0,b.jsx)(e.CardTitle,{className:"text-2xl",children:B.certificatesIssued}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:[B.completedEnrollments," hoàn thành"]})]})}),(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardHeader,{className:"pb-3",children:[(0,b.jsxs)(e.CardDescription,{className:"flex items-center gap-1",children:[(0,b.jsx)(s.Target,{className:"w-4 h-4"}),"Tỷ lệ đạt"]}),(0,b.jsxs)(e.CardTitle,{className:"text-2xl",children:[B.quizPassRate,"%"]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:["Điểm TB: ",B.avgQuizScore]})]})})]}),(0,b.jsxs)(g.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,b.jsxs)(g.TabsList,{className:"grid w-full grid-cols-2 sm:grid-cols-4",children:[(0,b.jsx)(g.TabsTrigger,{value:"overview",children:"Tổng quan"}),(0,b.jsx)(g.TabsTrigger,{value:"courses",children:"Khóa học"}),(0,b.jsx)(g.TabsTrigger,{value:"students",children:"Học viên"}),(0,b.jsx)(g.TabsTrigger,{value:"revenue",children:"Doanh thu"})]}),(0,b.jsx)(g.TabsContent,{value:"overview",className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(o.default,{className:"w-5 h-5"}),"Trạng thái ghi danh"]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,b.jsx)("span",{className:"text-sm",children:"Đang học"})]}),(0,b.jsx)("span",{className:"font-semibold",children:B.activeEnrollments})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${B.activeEnrollments/B.totalEnrollments*100}%`}})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,b.jsx)("span",{className:"text-sm",children:"Hoàn thành"})]}),(0,b.jsx)("span",{className:"font-semibold",children:B.completedEnrollments})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${B.completedEnrollments/B.totalEnrollments*100}%`}})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-400"}),(0,b.jsx)("span",{className:"text-sm",children:"Đã bỏ"})]}),(0,b.jsx)("span",{className:"font-semibold",children:B.totalEnrollments-B.activeEnrollments-B.completedEnrollments})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:`${(B.totalEnrollments-B.activeEnrollments-B.completedEnrollments)/B.totalEnrollments*100}%`}})})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(j.BookOpen,{className:"w-5 h-5"}),"Thống kê khóa học"]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Tổng khóa học"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:B.totalCourses})]}),(0,b.jsx)(j.BookOpen,{className:"w-12 h-12 text-blue-600 opacity-20"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Đã xuất bản"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:B.publishedCourses})]}),(0,b.jsx)(q.CheckCircle,{className:"w-12 h-12 text-green-600 opacity-20"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Bản nháp"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:B.totalCourses-B.publishedCourses})]}),(0,b.jsx)(r.Clock,{className:"w-12 h-12 text-orange-600 opacity-20"})]})]})]})]})}),(0,b.jsx)(g.TabsContent,{value:"courses",className:"space-y-4",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(n.BarChart3,{className:"w-5 h-5"}),"Top 5 khóa học phổ biến"]}),(0,b.jsx)(e.CardDescription,{children:"Xếp hạng theo số lượng ghi danh"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:C.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 text-blue-600 font-bold text-sm",children:c+1}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 truncate",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,b.jsxs)("span",{className:"text-sm text-gray-600",children:[a._count.enrollments," học viên"]}),(0,b.jsx)("span",{className:"text-sm text-green-600 font-medium",children:E(a.price)})]})]}),(0,b.jsx)("div",{className:"w-24 h-2 bg-gray-200 rounded-full",children:(0,b.jsx)("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${a._count.enrollments/(C[0]?._count?.enrollments||1)*100}%`}})})]},a.id))})})]})}),(0,b.jsx)(g.TabsContent,{value:"students",className:"space-y-4",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(p.Activity,{className:"w-5 h-5"}),"Hoạt động ghi danh gần đây"]})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:D.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 truncate",children:a.course.title}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Ghi danh: ",new Date(a.enrolledAt).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["COMPLETED"===a.status?(0,b.jsx)(q.CheckCircle,{className:"w-5 h-5 text-green-600"}):"ACTIVE"===a.status?(0,b.jsx)(r.Clock,{className:"w-5 h-5 text-blue-600"}):(0,b.jsx)(t.AlertCircle,{className:"w-5 h-5 text-gray-600"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:[Math.round(a.progress),"%"]})]})]},a.id))})})]})}),(0,b.jsx)(g.TabsContent,{value:"revenue",className:"space-y-4",children:(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,b.jsx)(l.DollarSign,{className:"w-5 h-5"}),"Tổng quan doanh thu"]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Tổng doanh thu"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:E(B.totalRevenue)})]}),(0,b.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Doanh thu trung bình/khóa"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:E(B.totalEnrollments?B.totalRevenue/B.totalEnrollments:0)})]})]}),(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Doanh thu theo khóa học"}),(0,b.jsx)("div",{className:"space-y-3",children:C.map(a=>{let c=w?.filter(b=>b.course.id===a.id).reduce((a,b)=>a+(b.paymentAmount||0),0)||0;return(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-900 truncate flex-1",children:a.title}),(0,b.jsx)("span",{className:"font-semibold text-green-600",children:E(c)})]},a.id)})})]})]})]})})]})]})}a.s(["default",()=>v],908506)}];

//# sourceMappingURL=frontend_src_app_lms_admin_reports_page_tsx_975a205f._.js.map