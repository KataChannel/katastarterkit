# Test RBAC GraphQL Queries
# These queries can be used to test the complete RBAC system

# Query all permissions
query GetAllPermissions {
  permissions {
    id
    name
    description
    resource
    action
    conditions
    createdAt
    updatedAt
  }
}

# Query all roles
query GetAllRoles {
  roles {
    id
    name
    description
    level
    permissions {
      id
      name
      resource
      action
    }
    createdAt
    updatedAt
  }
}

# Get user roles and permissions
query GetUserRoles($userId: ID!) {
  userRoles(userId: $userId) {
    id
    userId
    roleId
    role {
      id
      name
      description
      level
    }
    assignedAt
    assignedBy
    expiresAt
  }
}

# Create a new permission
mutation CreatePermission($input: CreatePermissionInput!) {
  createPermission(input: $input) {
    id
    name
    description
    resource
    action
    conditions
  }
}

# Create a new role
mutation CreateRole($input: CreateRoleInput!) {
  createRole(input: $input) {
    id
    name
    description
    level
    permissions {
      id
      name
    }
  }
}

# Assign role to user
mutation AssignRoleToUser($input: AssignRoleToUserInput!) {
  assignRoleToUser(input: $input) {
    id
    userId
    roleId
    role {
      name
    }
    assignedAt
  }
}

# Variables examples:
# For GetUserRoles:
# {
#   "userId": "user-id-here"
# }

# For CreatePermission:
# {
#   "input": {
#     "name": "test:create",
#     "description": "Create test resources",
#     "resource": "test",
#     "action": "create"
#   }
# }

# For CreateRole:
# {
#   "input": {
#     "name": "test_role",
#     "description": "Test role for validation",
#     "level": 3,
#     "permissionIds": ["permission-id-1", "permission-id-2"]
#   }
# }

# For AssignRoleToUser:
# {
#   "input": {
#     "userId": "user-id-here",
#     "roleId": "role-id-here"
#   }
# }