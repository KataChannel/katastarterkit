# ğŸ“Š VTTECH Integration - Architecture & Flow Diagrams

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚     nhanvienvttech-pro.html (React UI)             â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Features:                                           â”‚         â”‚
â”‚   â”‚  â€¢ Dark mode theme                                  â”‚         â”‚
â”‚   â”‚  â€¢ 7 management tabs                                â”‚         â”‚
â”‚   â”‚  â€¢ localStorage persistence                         â”‚         â”‚
â”‚   â”‚  â€¢ JSON export                                      â”‚         â”‚
â”‚   â”‚  â€¢ Real-time data display                           â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Tabs:                                               â”‚         â”‚
â”‚   â”‚  1. Employees                                        â”‚         â”‚
â”‚   â”‚  2. Employee Groups                                  â”‚         â”‚
â”‚   â”‚  3. User Types                                       â”‚         â”‚
â”‚   â”‚  4. Users                                            â”‚         â”‚
â”‚   â”‚  5. Permission Menus                                 â”‚         â”‚
â”‚   â”‚  6. Permission Functions                             â”‚         â”‚
â”‚   â”‚  7. Menu Allow Group                                 â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                         â”‚
â”‚                    HTTP POST/GET                                   â”‚
â”‚                          â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API SERVER LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    (servervttech.js)                               â”‚
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚         Express.js Server (Port 3001)              â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Middleware Stack:                                  â”‚         â”‚
â”‚   â”‚  â”œâ”€ CORS Enabled                                    â”‚         â”‚
â”‚   â”‚  â”œâ”€ Body Parser (50MB)                              â”‚         â”‚
â”‚   â”‚  â”œâ”€ Static File Serving                             â”‚         â”‚
â”‚   â”‚  â””â”€ Error Handling                                  â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Routes (10 Endpoints):                             â”‚         â”‚
â”‚   â”‚  â”œâ”€ GET  /api/health                                â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/verify-credentials                    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/customers                             â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/employees           â† with decomp    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/employee-groups     â† with decomp    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/user-types          â† with decomp    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/users               â† with decomp    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/permissions-menu    â† with decomp    â”‚         â”‚
â”‚   â”‚  â”œâ”€ POST /api/permission-functions â† with decomp   â”‚         â”‚
â”‚   â”‚  â””â”€ POST /api/menu-allow-group    â† with decomp    â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â”‚                                         â”‚
â”‚                   HTTPS Proxy to VTTECH                            â”‚
â”‚                          â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VTTECH API LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚     https://tmtaza.vttechsolution.com               â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Authentication:                                     â”‚         â”‚
â”‚   â”‚  â€¢ Cookie-based sessions                            â”‚         â”‚
â”‚   â”‚  â€¢ Xsrf-Token validation                            â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Response Format:                                    â”‚         â”‚
â”‚   â”‚  1. JSON data                                        â”‚         â”‚
â”‚   â”‚  2. Gzip compressed                                  â”‚         â”‚
â”‚   â”‚  3. Base64 encoded                                   â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â”‚  Example:                                            â”‚         â”‚
â”‚   â”‚  "H4sIAA...base64...qh/zj+..."                      â”‚         â”‚
â”‚   â”‚                                                      â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER INTERACTION                            â”‚
â”‚                                                                â”‚
â”‚  1. Opens http://localhost:3001/nhanvienvttech-pro.html       â”‚
â”‚  2. Enters VTTECH credentials                                 â”‚
â”‚  3. Clicks "Verify"                                           â”‚
â”‚  4. Clicks tab (e.g., "Employees")                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FRONTEND â†’ API CALL                               â”‚
â”‚                                                                â”‚
â”‚  POST http://localhost:3001/api/employees                     â”‚
â”‚  {                                                             â”‚
â”‚    "cookie": "VTTECH_SESSION_ID=...",                        â”‚
â”‚    "xsrfToken": "token_value..."                              â”‚
â”‚  }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SERVER: RECEIVE REQUEST                               â”‚
â”‚                                                                â”‚
â”‚  app.post('/api/employees', async (req, res) => {             â”‚
â”‚    const { cookie, xsrfToken } = req.body;                   â”‚
â”‚    ...                                                         â”‚
â”‚  })                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       SERVER â†’ VTTECH API CALL                                â”‚
â”‚                                                                â”‚
â”‚  POST https://tmtaza.vttechsolution.com/Admin/User/...       â”‚
â”‚  Headers: {                                                    â”‚
â”‚    'Cookie': 'VTTECH_SESSION_ID=...',                        â”‚
â”‚    'Xsrf-Token': 'token_value...'                            â”‚
â”‚  }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         VTTECH: SEND COMPRESSED RESPONSE                      â”‚
â”‚                                                                â”‚
â”‚  Response: "H4sIAA...very long base64 string...qh/zj+..."    â”‚
â”‚                                                                â”‚
â”‚  This is:                                                      â”‚
â”‚  â€¢ JSON data                                                   â”‚
â”‚  â€¢ Gzip compressed                                             â”‚
â”‚  â€¢ Base64 encoded                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SERVER: DECOMPRESS DATA                                  â”‚
â”‚                                                                â”‚
â”‚  const decodedData = decompressVTTECHData(response.data);    â”‚
â”‚                                                                â”‚
â”‚  Process:                                                      â”‚
â”‚  1. Base64 â†’ Buffer                                            â”‚
â”‚  2. Gzip decompress â†’ String                                   â”‚
â”‚  3. JSON parse â†’ Object                                        â”‚
â”‚                                                                â”‚
â”‚  Result: { employees: [...], status: 200 }                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       SERVER â†’ SEND JSON RESPONSE                             â”‚
â”‚                                                                â”‚
â”‚  res.json({                                                    â”‚
â”‚    success: true,                                              â”‚
â”‚    data: [                                                     â”‚
â”‚      { id: 1, name: "Employee 1", ... },                      â”‚
â”‚      { id: 2, name: "Employee 2", ... },                      â”‚
â”‚      ...                                                       â”‚
â”‚    ],                                                          â”‚
â”‚    timestamp: "2025-10-25T07:34:36.787Z"                      â”‚
â”‚  })                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FRONTEND: RECEIVE & DISPLAY                           â”‚
â”‚                                                                â”‚
â”‚  1. Parse JSON response                                        â”‚
â”‚  2. Extract data array                                         â”‚
â”‚  3. Render in table                                            â”‚
â”‚  4. Store in localStorage                                      â”‚
â”‚  5. Display to user                                            â”‚
â”‚                                                                â”‚
â”‚  Table:                                                        â”‚
â”‚  ID | Name | Email | Status                                   â”‚
â”‚  1  | Emp1 | ...   | Active                                   â”‚
â”‚  2  | Emp2 | ...   | Active                                   â”‚
â”‚  ...                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Decompression Process

```
INPUT: "H4sIAA...qh/zj+..." (Base64 String)
   â”‚
   â†“ Step 1: Base64 Decode
   â”‚
   Buffer: [0x1F, 0x8B, 0x08, 0x00, ...] (Binary gzip data)
   â”‚
   â†“ Step 2: Gzip Decompress (zlib.gunzipSync)
   â”‚
   String: '{"employees":[{"id":1,"name":"John",...}]}'
   â”‚
   â†“ Step 3: JSON Parse
   â”‚
OUTPUT: { employees: [{id: 1, name: "John", ...}] } (JavaScript Object)
```

### Error Handling Flow

```
decompressVTTECHData(encodedData)
   â”‚
   â”œâ”€ Validate input
   â”‚
   â”œâ”€ Try Base64 decode
   â”‚  â”œâ”€ Success â†’ Continue to gzip
   â”‚  â””â”€ Failed â†’ Catch, try fallback
   â”‚
   â”œâ”€ Try Gzip decompress
   â”‚  â”œâ”€ Success â†’ Continue to JSON parse
   â”‚  â””â”€ Failed â†’ Catch, try fallback
   â”‚
   â”œâ”€ Try JSON parse (decompressed)
   â”‚  â”œâ”€ Success â†’ Return object âœ…
   â”‚  â””â”€ Failed â†’ Try fallback
   â”‚
   â”œâ”€ Fallback 1: Try JSON parse (raw)
   â”‚  â”œâ”€ Success â†’ Return object âœ…
   â”‚  â””â”€ Failed â†’ Try fallback 2
   â”‚
   â””â”€ Fallback 2: Return as-is
      â””â”€ Return encodedData as string âœ…
```

---

## ğŸ“‹ Request/Response Examples

### Request: Fetch Employees

```bash
curl -X POST http://localhost:3001/api/employees \
  -H "Content-Type: application/json" \
  -d '{
    "cookie": "VTTECH_SESSIONID=abc123; Path=/",
    "xsrfToken": "xsrf_token_abc123"
  }'
```

### Response: Success

```json
{
  "success": true,
  "data": [
    {
      "userId": 1,
      "userName": "john.doe",
      "email": "john@example.com",
      "department": "IT",
      "role": "Manager",
      "status": "Active",
      "createdDate": "2025-01-01T00:00:00Z"
    },
    {
      "userId": 2,
      "userName": "jane.smith",
      "email": "jane@example.com",
      "department": "HR",
      "role": "Officer",
      "status": "Active",
      "createdDate": "2025-01-01T00:00:00Z"
    }
  ],
  "timestamp": "2025-10-25T07:34:36.787Z"
}
```

### Response: Error (Invalid Credentials)

```json
{
  "success": false,
  "error": "Request failed with status code 401",
  "timestamp": "2025-10-25T07:34:36.787Z",
  "status": 401,
  "statusText": "Unauthorized"
}
```

### Response: Error (Missing Parameters)

```json
{
  "success": false,
  "error": "Cookie and Xsrf-Token are required",
  "timestamp": "2025-10-25T07:34:36.787Z"
}
```

---

## ğŸ¯ Processing Pipeline

```
Frontend Request
       â”‚
       â”œâ”€ Validate credentials in localStorage
       â”‚
       â”œâ”€ Send POST request with {cookie, xsrfToken}
       â”‚
       â†“
API Server (servervttech.js)
       â”‚
       â”œâ”€ Receive request
       â”‚
       â”œâ”€ Parse JSON body
       â”‚
       â”œâ”€ Validate parameters
       â”‚
       â”œâ”€ Build VTTECH request config
       â”‚
       â”œâ”€ Call VTTECH API with axios
       â”‚
       â†“
VTTECH API Response (Compressed)
       â”‚
       â”œâ”€ Receive: "H4sIAA...base64...qh/zj+..."
       â”‚
       â†“
Decompression Function
       â”‚
       â”œâ”€ Base64 decode
       â”‚
       â”œâ”€ Gzip decompress
       â”‚
       â”œâ”€ JSON parse
       â”‚
       â†“
Response Object
       â”‚
       â”œâ”€ success: true
       â”‚
       â”œâ”€ data: {...parsed JSON...}
       â”‚
       â”œâ”€ timestamp: ...
       â”‚
       â†“
Send to Frontend
       â”‚
       â”œâ”€ Frontend receives clean JSON
       â”‚
       â”œâ”€ Display in table
       â”‚
       â”œâ”€ Cache in localStorage
       â”‚
       â”œâ”€ Ready for export
       â”‚
       â†“
User Sees Data
```

---

## ğŸ”§ Configuration Options

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Server Configuration               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ PORT                  â†’ 3001 (default)  â”‚
â”‚ NODE_ENV              â†’ production      â”‚
â”‚ Request Timeout       â†’ 30 seconds      â”‚
â”‚ Max Body Size         â†’ 50MB            â”‚
â”‚ CORS Enabled          â†’ Yes             â”‚
â”‚ Static Files          â†’ ./external/     â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance Metrics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Performance Benchmarks              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚ Server Startup       â†’ < 1 second        â”‚
â”‚ Health Check         â†’ < 50ms            â”‚
â”‚ Base64 Decode        â†’ < 10ms            â”‚
â”‚ Gzip Decompress      â†’ < 50ms            â”‚
â”‚ JSON Parse           â†’ < 20ms            â”‚
â”‚ Total Decompression  â†’ < 100ms           â”‚
â”‚ API Response         â†’ 100-500ms         â”‚
â”‚ Full Cycle           â†’ 200-600ms         â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PRODUCTION SETUP                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  PM2 Process Manager                â”‚                  â”‚
â”‚  â”‚  (Auto-restart, Monitoring)          â”‚                  â”‚
â”‚  â”‚                                      â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Process: vttech-server          â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Status: Running                 â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Memory: 50-100MB                â”‚                  â”‚
â”‚  â”‚  â”œâ”€ CPU: Low (< 1%)                 â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Uptime: Auto-restarted          â”‚                  â”‚
â”‚  â”‚  â””â”€ Logs: Rotated daily             â”‚                  â”‚
â”‚  â”‚                                      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Reverse Proxy (Nginx/Apache)      â”‚                   â”‚
â”‚  â”‚                                    â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Domain: api.example.com       â”‚                   â”‚
â”‚  â”‚  â”œâ”€ SSL/TLS: Enabled               â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Load Balancing: Round-robin    â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Caching: Enabled               â”‚                   â”‚
â”‚  â”‚  â””â”€ Compression: Gzip              â”‚                   â”‚
â”‚  â”‚                                    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Docker Container                   â”‚                  â”‚
â”‚  â”‚                                     â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Image: node:20-alpine          â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Port: 3001 (exposed)           â”‚                  â”‚
â”‚  â”‚  â”œâ”€ Volume: /app/logs              â”‚                  â”‚
â”‚  â”‚  â””â”€ Restart: Always                â”‚                  â”‚
â”‚  â”‚                                     â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Monitoring & Logging              â”‚                   â”‚
â”‚  â”‚                                    â”‚                   â”‚
â”‚  â”‚  â”œâ”€ PM2 Plus                       â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Error Tracking                 â”‚                   â”‚
â”‚  â”‚  â”œâ”€ Performance Monitoring         â”‚                   â”‚
â”‚  â”‚  â””â”€ Alert System                   â”‚                   â”‚
â”‚  â”‚                                    â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Quick Reference

**Files**:
- Server: `servervttech.js`
- UI: `nhanvienvttech-pro.html`
- Config: `.env`
- Docs: `DECOMPRESSION-GUIDE.md`

**URLs**:
- Server: `http://localhost:3001`
- Health: `http://localhost:3001/api/health`
- UI: `http://localhost:3001/nhanvienvttech-pro.html`

**Commands**:
- Start: `node servervttech.js`
- Test: `./test-comprehensive.sh`
- Kill: `pkill -f "node servervttech"`

---

**Created**: 25/10/2025  
**Version**: 1.0.0  
**Status**: âœ… Production Ready
